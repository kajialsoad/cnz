var I=Object.defineProperty;var L=(s,e,a)=>e in s?I(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a;var f=(s,e,a)=>L(s,typeof e!="symbol"?e+"":e,a);import{j as t,B as c,C,b as y,aX as k,T as u,e as N,f as P,g as b,cu as _}from"./mui-vendor-BGNnUP5W.js";import{d as E,r as p}from"./react-vendor-D7yrL1sD.js";import{A as j,M as v,n as d}from"./index-BayLrfHP.js";import{a as T}from"./query-vendor-7qIgur5f.js";import"./chart-vendor-DaOx9iI7.js";class B{constructor(){f(this,"apiClient");this.apiClient=T.create({baseURL:j.BASE_URL,timeout:j.TIMEOUT,withCredentials:!0,headers:{"Content-Type":"application/json"}}),this.setupInterceptors()}setupInterceptors(){this.apiClient.interceptors.request.use(e=>{try{const a=localStorage.getItem("accessToken");a&&(e.headers.Authorization=`Bearer ${a}`)}catch(a){console.error("Error getting token:",a)}return e},e=>Promise.reject(e)),this.apiClient.interceptors.response.use(e=>e,e=>{var a;return((a=e.response)==null?void 0:a.status)===401&&window.location.pathname!=="/login"&&window.location.assign("/login"),Promise.reject(e)})}async getAllConfigs(){return(await this.apiClient.get("/api/admin/config")).data}async getConfig(e){return(await this.apiClient.get(`/api/admin/config/${e}`)).data}async updateConfig(e,a,r){return(await this.apiClient.put(`/api/admin/config/${e}`,{value:a,description:r})).data}}const m=new B,F=()=>{const s=E(),[e,a]=p.useState(!0),[r,g]=p.useState(!1),[n,h]=p.useState("20"),[o,x]=p.useState("10");p.useEffect(()=>{w()},[]);const w=async()=>{try{a(!0);const i=await m.getConfig("daily_complaint_limit");i.success&&i.data&&h(i.data.value);const l=await m.getConfig("ward_image_limit");l.success&&l.data&&x(l.data.value)}catch(i){console.error("Error fetching config:",i)}finally{a(!1)}},S=async()=>{let i=!1;if((!n||isNaN(Number(n))||Number(n)<1)&&(d.error("Daily Limit: Please enter a valid positive number"),i=!0),(!o||isNaN(Number(o))||Number(o)<1)&&(d.error("Image Limit: Please enter a valid positive number"),i=!0),!i)try{g(!0),await m.updateConfig("daily_complaint_limit",n,"Maximum number of complaints allowed per user per day"),await m.updateConfig("ward_image_limit",o,"Maximum number of images allowed per complaint for a ward"),d.success("Configurations updated successfully")}catch(l){console.error("Error updating config:",l),d.error("Failed to update configurations")}finally{g(!1)}};return e?t.jsx(v,{title:"System Control",children:t.jsx(c,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:t.jsx(C,{})})}):t.jsx(v,{title:"System Control",children:t.jsxs(c,{sx:{px:3,py:4,background:"#f8faf9",minHeight:"100vh"},children:[t.jsxs(c,{sx:{mb:3},children:[t.jsx(y,{startIcon:t.jsx(k,{}),onClick:()=>s("/settings"),sx:{mb:2,color:"#4a5565"},children:"Back to Settings"}),t.jsx(u,{variant:"h4",sx:{fontWeight:700,color:"#1e2939"},children:"সিস্টেম কন্ট্রোল (System Control)"}),t.jsx(u,{variant:"body1",sx:{color:"#4a5565",mt:1},children:"সিস্টেমের গুরুত্বপূর্ণ সেটিংস কনফিগার করুন"})]}),t.jsx(N,{sx:{maxWidth:600,borderRadius:"12px",boxShadow:"0px 1px 3px rgba(0,0,0,0.1)"},children:t.jsxs(P,{sx:{p:4},children:[t.jsx(u,{variant:"h6",sx:{mb:3,fontWeight:600},children:"অভিযোগের সীমা (Complaint Limits)"}),t.jsxs(c,{sx:{mb:4},children:[t.jsx(u,{variant:"subtitle2",sx:{mb:1,color:"#4a5565"},children:"দৈনিক অভিযোগের সীমা (Daily Complaint Limit)"}),t.jsx(b,{fullWidth:!0,type:"number",value:n,onChange:i=>h(i.target.value),helperText:"একজন ব্যবহারকারী প্রতিদিন কতগুলো অভিযোগ করতে পারবেন",InputProps:{inputProps:{min:1}}})]}),t.jsxs(c,{sx:{mb:4},children:[t.jsx(u,{variant:"subtitle2",sx:{mb:1,color:"#4a5565"},children:"ওয়ার্ডের ছবির সীমা (Ward Image Limit)"}),t.jsx(b,{fullWidth:!0,type:"number",value:o,onChange:i=>x(i.target.value),helperText:"প্রতি অভিযোগের জন্য ওয়ার্ডে সর্বোচ্চ কতগুলো ছবি আপলোড করা যাবে",InputProps:{inputProps:{min:1}}})]}),t.jsx(y,{variant:"contained",startIcon:r?t.jsx(C,{size:20,color:"inherit"}):t.jsx(_,{}),onClick:S,disabled:r,sx:{background:"#3fa564","&:hover":{background:"#2e804b"},py:1.5,px:4},children:r?"Saving...":"Save Changes"})]})})]})})};export{F as default};
