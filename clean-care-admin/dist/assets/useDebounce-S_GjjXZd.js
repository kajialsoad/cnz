import{e as d,j as e,r as c,F as r,aq as Z,T as a,aj as fe,Y as le,l as Fe,v as de,b7 as Ge,aD as Je,x as _,D as Ze,y as _e,z as I,A as Xe,C as Qe,E as qe,I as b,H as xe,J as Ke,K as he,L as me,aB as Ye,X as k,ax as es,az as ss,aA as os,P as $,b8 as ts,ay as ue,am as rs,b9 as as,Q as W}from"./index-D65jGImX.js";import{c as A,a as ge,H as ns,A as is,I as cs,b as be,d as je,M as ls,Z as ds}from"./categoryService-CaXOE78j.js";import{P as xs}from"./Person-BfSXJYBV.js";import{D as pe}from"./Download-DHMBwefg.js";const hs=d(e.jsx("path",{d:"M12 3v9.28c-.47-.17-.97-.28-1.5-.28C8.01 12 6 14.01 6 16.5S8.01 21 10.5 21c2.31 0 4.2-1.75 4.45-4H15V6h4V3z"})),ms=d(e.jsx("path",{d:"M21 5v6.59l-3-3.01-4 4.01-4-4-4 4-3-3.01V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2m-3 6.42 3 3.01V19c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2v-6.58l3 2.99 4-4 4 4z"})),us=d(e.jsx("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2M6 9h12v2H6zm8 5H6v-2h8zm4-6H6V6h12z"})),gs=d(e.jsx("path",{d:"M18 12.22V9l-5-2.5V5h2V3h-2V1h-2v2H9v2h2v1.5L6 9v3.22L2 14v8h8v-3c0-1.1.9-2 2-2s2 .9 2 2v3h8v-8zm-6 1.28c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5"})),bs=d(e.jsx("path",{d:"M17 12h-5v5h5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1zm3 18H5V8h14z"})),Vs=d(e.jsx("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"})),Ts=d(e.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"})),js=d(e.jsx("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"})),ps=d(e.jsx("path",{d:"m14 6-3.75 5 2.85 3.8-1.6 1.2C9.81 13.75 7 10 7 10l-6 8h22z"})),fs=d(e.jsx("path",{d:"M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4z"})),ys=d(e.jsx("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"})),Cs=d(e.jsx("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})),vs=d(e.jsx("path",{d:"M6 19h4V5H6zm8-14v14h4V5z"})),Ss=d(e.jsx("path",{d:"M8 5v14l11-7z"})),Is=d(e.jsx("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"})),ks=d(e.jsx("path",{d:"M21 10.12h-6.78l2.74-2.82c-2.73-2.7-7.15-2.8-9.88-.1-2.73 2.71-2.73 7.08 0 9.79s7.15 2.71 9.88 0C18.32 15.65 19 14.08 19 12.1h2c0 1.98-.88 4.55-2.64 6.29-3.51 3.48-9.21 3.48-12.72 0-3.5-3.47-3.53-9.11-.02-12.58s9.14-3.47 12.65 0L21 3zM12.5 8v4.25l3.5 2.08-.72 1.21L11 13V8z"})),Es=d(e.jsx("path",{d:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63m2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71M4.27 3 3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9zM12 4 9.91 6.09 12 8.18z"})),ws=d(e.jsx("path",{d:"M3 9v6h4l5 5V4L7 9zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02M14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77"})),zs=d(e.jsx("path",{d:"M20 6h-4V4c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2m-6 0h-4V4h4z"})),Ns=d(e.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14M7 9h5v1H7z"})),Ms=({categoryId:l,subcategoryId:g})=>{const[y,f]=c.useState(""),[C,v]=c.useState(""),[n,E]=c.useState(""),[V,T]=c.useState(""),[s,w]=c.useState("#808080"),[z,N]=c.useState(!0);c.useEffect(()=>{l&&g&&(async()=>{try{N(!0);const[R,L,j,D,P]=await Promise.all([A.getCategoryName(l,"en"),A.getCategoryName(l,"bn"),A.getSubcategoryName(l,g,"en"),A.getSubcategoryName(l,g,"bn"),A.getCategoryColor(l)]);f(R),v(L),E(j),T(D),w(P)}catch(R){console.error("Error fetching category info:",R),f("Unknown Category"),v("à¦…à¦œà¦¾à¦¨à¦¾ à¦¬à¦¿à¦­à¦¾à¦—"),E("Unknown Subcategory"),T("à¦…à¦œà¦¾à¦¨à¦¾ à¦‰à¦ªà¦¬à¦¿à¦­à¦¾à¦—")}finally{N(!1)}})()},[l,g]);const M=()=>{const m={sx:{fontSize:40,color:s}};switch(l){case"home":return e.jsx(js,{...m});case"road_environment":return e.jsx(ps,{...m});case"business":return e.jsx(le,{...m});case"office":return e.jsx(zs,{...m});case"education":return e.jsx(Is,{...m});case"hospital":return e.jsx(fs,{...m});case"religious":return e.jsx(gs,{...m});case"events":return e.jsx(bs,{...m});default:return e.jsx(le,{...m})}};return z?e.jsxs(r,{sx:{display:"flex",gap:2,alignItems:"center"},children:[e.jsx(Z,{variant:"circular",width:40,height:40}),e.jsxs(r,{sx:{flex:1},children:[e.jsx(Z,{variant:"text",width:"60%",height:24}),e.jsx(Z,{variant:"text",width:"80%",height:20})]})]}):e.jsxs(r,{sx:{display:"flex",gap:2,alignItems:"flex-start",p:2,backgroundColor:"#f8f9fa",borderRadius:2,border:`2px solid ${s}`},children:[e.jsx(r,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:60,height:60,borderRadius:2,backgroundColor:`${s}15`},children:M()}),e.jsxs(r,{sx:{flex:1},children:[e.jsxs(r,{sx:{mb:1},children:[e.jsx(a,{variant:"body1",sx:{fontWeight:600,color:s,mb:.5},children:y}),e.jsx(a,{variant:"body2",sx:{color:"text.secondary",fontStyle:"italic"},children:C})]}),e.jsxs(r,{children:[e.jsx(a,{variant:"body2",sx:{fontWeight:500,mb:.5},children:n}),e.jsx(a,{variant:"caption",sx:{color:"text.secondary",fontStyle:"italic"},children:V})]})]}),e.jsx(fe,{label:y,size:"small",sx:{backgroundColor:s,color:"#fff",fontWeight:500,fontSize:"0.75rem",height:24,boxShadow:"0 1px 3px rgba(0,0,0,0.12)"}})]})},Ls=({complaintId:l,open:g,onClose:y,onStatusUpdate:f,onChatOpen:C})=>{var te,re,ae,ne,ie,ce;const v=Fe(),n=de(v.breakpoints.down("sm")),E=de(v.breakpoints.down("md")),{canEditComplaints:V,canViewComplaints:T}=Ge(),[s,w]=c.useState(null),[z,N]=c.useState(!1),[M,m]=c.useState(null),[R,L]=c.useState(!1),[j,D]=c.useState(0),[P,S]=c.useState(1),[ye,Ce]=c.useState(new Set),[X,B]=c.useState({}),[ve,Q]=c.useState({}),[H,Se]=c.useState({}),[F,Ie]=c.useState({}),p=Je.useRef({}),[O,U]=c.useState(!1),[ke,G]=c.useState(!1);c.useEffect(()=>{g&&l&&q()},[g,l]);const q=async()=>{if(l)try{N(!0),m(null);const o=await ge.getComplaintById(l);console.log("ðŸ“‹ Complaint data received:",{id:o.id,resolutionImages:o.resolutionImages,resolutionNote:o.resolutionNote,status:o.status}),w(o)}catch(o){const t=_(o);m(t.userMessage)}finally{N(!1)}},J=()=>{w(null),m(null),y()},Ee=o=>{switch(o){case"PENDING":return{backgroundColor:"#fff3cd",color:"#856404",borderColor:"#ffeeba"};case"IN_PROGRESS":return{backgroundColor:"#d1ecf1",color:"#0c5460",borderColor:"#bee5eb"};case"RESOLVED":return{backgroundColor:"#d4edda",color:"#155724",borderColor:"#c3e6cb"};case"REJECTED":return{backgroundColor:"#f8d7da",color:"#721c24",borderColor:"#f5c6cb"};default:return{backgroundColor:"#f8f9fa",color:"#6c757d"}}},we=o=>{switch(o){case"PENDING":return"Pending";case"IN_PROGRESS":return"In Progress";case"RESOLVED":return"Solved";case"REJECTED":return"Rejected";default:return o}},K=o=>new Date(o).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),ze=o=>{D(o),S(1),L(!0)},Y=()=>{L(!1),S(1)},Ne=()=>{s&&s.imageUrls.length>0&&(D(o=>o===0?s.imageUrls.length-1:o-1),S(1))},Me=()=>{s&&s.imageUrls.length>0&&(D(o=>o===s.imageUrls.length-1?0:o+1),S(1))},Re=()=>{S(o=>Math.min(o+.25,3))},De=()=>{S(o=>Math.max(o-.25,.5))},Pe=()=>{if(s&&s.imageUrls[j]){const o=document.createElement("a");o.href=s.imageUrls[j],o.download=`complaint-${s.id}-image-${j+1}.jpg`,document.body.appendChild(o),o.click(),document.body.removeChild(o)}},Ae=o=>{Ce(t=>new Set(t).add(o))},Ve=o=>{const t=p.current[o];t&&(X[o]?(t.pause(),B(i=>({...i,[o]:!1}))):(t.play(),B(i=>({...i,[o]:!0}))))},Te=o=>{const t=p.current[o];if(!t)return;const i=t.currentTime/t.duration*100;Q(x=>({...x,[o]:i}))},Le=o=>{B(t=>({...t,[o]:!1})),Q(t=>({...t,[o]:0}))},ee=(o,t)=>{const i=p.current[o];i&&(i.volume=t,Se(x=>({...x,[o]:t})))},He=o=>{const t=p.current[o];if(!t)return;const i=[.5,1,1.5,2],x=F[o]||1,h=i.indexOf(x),u=i[(h+1)%i.length];t.playbackRate=u,Ie(Be=>({...Be,[o]:u}))},Oe=(o,t)=>{const i=p.current[o];if(!i)return;const x=t.currentTarget.getBoundingClientRect(),u=(t.clientX-x.left)/x.width;i.currentTime=u*i.duration},Ue=(o,t)=>{const i=document.createElement("a");i.href=o,i.download=`complaint-${s==null?void 0:s.id}-audio-${t+1}.mp3`,document.body.appendChild(i),i.click(),document.body.removeChild(i)},se=o=>{if(isNaN(o))return"0:00";const t=Math.floor(o/60),i=Math.floor(o%60);return`${t}:${i.toString().padStart(2,"0")}`},$e=async o=>{if(!(!s||!l)){if(o==="REJECTED"){G(!0);return}try{U(!0),f(l,o),w(t=>t?{...t,status:o}:null),W.success("Status updated successfully",{icon:"âœ…",duration:3e3})}catch(t){const i=_(t);W.error(i.userMessage,{duration:5e3,icon:"âŒ"})}finally{U(!1)}}},We=async(o,t,i,x)=>{if(!(!s||!l))try{U(!0),await ge.markComplaintAsOthers(l,{othersCategory:o,othersSubcategory:t,note:i,images:x}),f(l,"REJECTED"),W.success("Complaint marked as Others successfully",{icon:"âœ…",duration:3e3}),G(!1),q()}catch(h){const u=_(h);W.error(u.userMessage,{duration:5e3,icon:"âŒ"})}finally{U(!1)}},oe=o=>({PENDING:[{status:"IN_PROGRESS",label:"Mark In Progress",color:"#0c5460"},{status:"RESOLVED",label:"Mark Solved",color:"#155724"},{status:"REJECTED",label:"Mark Rejected",color:"#721c24"}],IN_PROGRESS:[{status:"PENDING",label:"Mark Pending",color:"#856404"},{status:"RESOLVED",label:"Mark Solved",color:"#155724"},{status:"REJECTED",label:"Mark Rejected",color:"#721c24"}],RESOLVED:[{status:"PENDING",label:"Mark Pending",color:"#856404"},{status:"IN_PROGRESS",label:"Mark In Progress",color:"#0c5460"},{status:"REJECTED",label:"Mark Rejected",color:"#721c24"}],REJECTED:[{status:"PENDING",label:"Mark Pending",color:"#856404"},{status:"IN_PROGRESS",label:"Mark In Progress",color:"#0c5460"},{status:"RESOLVED",label:"Mark Solved",color:"#155724"}],OTHERS:[{status:"PENDING",label:"Mark Pending",color:"#856404"},{status:"IN_PROGRESS",label:"Mark In Progress",color:"#0c5460"},{status:"RESOLVED",label:"Mark Solved",color:"#155724"},{status:"REJECTED",label:"Mark Rejected",color:"#721c24"}]})[o]||[];return e.jsxs(e.Fragment,{children:[e.jsxs(Ze,{open:g,onClose:J,maxWidth:"md",fullWidth:!0,fullScreen:n,slotProps:{paper:{sx:{borderRadius:n?0:2,maxHeight:n?"100vh":"90vh",animation:n?`${Xe} ${I.normal.duration} ${I.smooth.timing}`:`${Qe} ${I.normal.duration} ${I.smooth.timing}`,animationFillMode:"both"}},backdrop:{sx:{animation:`${_e} ${I.fast.duration} ${I.fast.timing}`}}},children:[e.jsxs(qe,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:2,borderBottom:"1px solid #e0e0e0"},children:[e.jsx(a,{component:"span",variant:"h6",sx:{fontWeight:600},children:"Complaint Details"}),e.jsx(b,{onClick:J,size:"small",sx:{color:"text.secondary","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"}},children:e.jsx(xe,{})})]}),e.jsxs(Ke,{sx:{pt:{xs:2,sm:3},pb:{xs:1.5,sm:2}},children:[z&&e.jsx(r,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:{xs:200,sm:300}},children:e.jsx(he,{})}),M&&!z&&e.jsx(me,{severity:"error",sx:{mb:2},children:M}),s&&!z&&!M&&e.jsxs(r,{children:[e.jsxs(r,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},mb:{xs:2,sm:3},gap:{xs:1,sm:2}},children:[e.jsx(a,{variant:n?"h6":"h5",sx:{fontWeight:600,color:"#4CAF50"},children:s.trackingNumber||`C${String(s.id).padStart(6,"0")}`}),e.jsx(fe,{label:we(s.status),sx:{...Ee(s.status),...Ye,fontWeight:500,fontSize:{xs:"0.75rem",sm:"0.875rem"},height:{xs:28,sm:32}}})]}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsx(a,{variant:n?"caption":"subtitle2",color:"text.secondary",sx:{mb:.5},children:"Complaint Title"}),e.jsx(a,{variant:n?"body2":"body1",sx:{fontWeight:500},children:s.title})]}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsx(a,{variant:n?"caption":"subtitle2",color:"text.secondary",sx:{mb:1},children:"Category"}),s.category&&s.subcategory?e.jsx(Ms,{categoryId:s.category,subcategoryId:s.subcategory}):e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1,p:1.5,backgroundColor:"#f5f5f5",border:"1px dashed #bdbdbd",borderRadius:1},children:[e.jsx(ns,{sx:{color:"#757575",fontSize:20}}),e.jsx(a,{variant:"body2",sx:{color:"#757575",fontStyle:"italic"},children:"This complaint has not been categorized yet. It was created before the category system was implemented."})]})]}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsx(a,{variant:n?"caption":"subtitle2",color:"text.secondary",sx:{mb:.5},children:"Description"}),e.jsx(a,{variant:n?"body2":"body1",sx:{whiteSpace:"pre-wrap"},children:s.description})]}),e.jsx(k,{sx:{my:{xs:2,sm:3}}}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:{xs:1,sm:1.5}},children:[e.jsx(es,{sx:{mr:1,color:"text.secondary",fontSize:{xs:18,sm:20}}}),e.jsx(a,{variant:n?"body1":"subtitle1",sx:{fontWeight:600},children:"Location Information"})]}),e.jsxs(r,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:{xs:1.5,sm:2}},children:[e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"District"}),e.jsx(a,{variant:n?"body2":"body1",children:((te=s.locationDetails)==null?void 0:te.district)||"N/A"})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Thana"}),e.jsx(a,{variant:n?"body2":"body1",children:((re=s.locationDetails)==null?void 0:re.thana)||"N/A"})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Ward"}),e.jsx(a,{variant:n?"body2":"body1",children:((ae=s.locationDetails)==null?void 0:ae.ward)||(s.user.ward?typeof s.user.ward=="object"?`Ward ${s.user.ward.wardNumber}`:`Ward ${s.user.ward}`:"N/A")})]}),e.jsxs(r,{sx:{gridColumn:{xs:"1",sm:"1 / -1"}},children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Full Address"}),e.jsx(a,{variant:n?"body2":"body1",children:((ne=s.locationDetails)==null?void 0:ne.address)||s.location})]})]})]}),e.jsx(k,{sx:{my:{xs:2,sm:3}}}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:{xs:1,sm:1.5}},children:[e.jsx(xs,{sx:{mr:1,color:"text.secondary",fontSize:{xs:18,sm:20}}}),e.jsx(a,{variant:n?"body1":"subtitle1",sx:{fontWeight:600},children:"Citizen Information"})]}),e.jsxs(r,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:{xs:1.5,sm:2}},children:[e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Citizen ID"}),e.jsxs(a,{variant:n?"body2":"body1",children:["U",String(s.user.id).padStart(6,"0")]})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Name"}),e.jsxs(a,{variant:n?"body2":"body1",children:[s.user.firstName," ",s.user.lastName]})]}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ss,{sx:{fontSize:{xs:16,sm:18},color:"text.secondary"}}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Phone"}),e.jsx(a,{variant:n?"body2":"body1",children:s.user.phone})]})]}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(os,{sx:{fontSize:{xs:16,sm:18},color:"text.secondary"}}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Email"}),e.jsx(a,{variant:n?"body2":"body1",sx:{wordBreak:"break-word",fontSize:{xs:"0.75rem",sm:"1rem"}},children:s.user.email||"Not provided"})]})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"City Corporation"}),e.jsx(a,{variant:n?"body2":"body1",children:((ie=s.user.cityCorporation)==null?void 0:ie.name)||"N/A"})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Zone"}),e.jsx(a,{variant:n?"body2":"body1",children:s.user.zone?`Zone ${s.user.zone}`:"N/A"})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Ward Number"}),e.jsx(a,{variant:n?"body2":"body1",children:s.user.ward?typeof s.user.ward=="object"?`Ward ${s.user.ward.wardNumber}`:`Ward ${s.user.ward}`:"N/A"})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Thana/Area"}),e.jsx(a,{variant:n?"body2":"body1",children:((ce=s.user.thana)==null?void 0:ce.name)||"N/A"})]}),s.user.address&&e.jsxs(r,{sx:{gridColumn:{xs:"1",sm:"1 / -1"}},children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Citizen Address"}),e.jsx(a,{variant:n?"body2":"body1",sx:{wordBreak:"break-word"},children:s.user.address})]})]})]}),e.jsx(k,{sx:{my:{xs:2,sm:3}}}),e.jsxs(r,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:{xs:1.5,sm:2}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(is,{sx:{fontSize:{xs:16,sm:18},color:"text.secondary"}}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Submitted"}),e.jsx(a,{variant:n?"body2":"body1",sx:{fontSize:{xs:"0.75rem",sm:"1rem"}},children:K(s.createdAt)})]})]}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ks,{sx:{fontSize:{xs:16,sm:18},color:"text.secondary"}}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Last Updated"}),e.jsx(a,{variant:n?"body2":"body1",sx:{fontSize:{xs:"0.75rem",sm:"1rem"}},children:K(s.updatedAt)})]})]})]}),s.imageUrls&&s.imageUrls.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(k,{sx:{my:{xs:2,sm:3}}}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:{xs:1,sm:1.5}},children:[e.jsx(cs,{sx:{mr:1,color:"text.secondary",fontSize:{xs:18,sm:20}}}),e.jsxs(a,{variant:n?"body1":"subtitle1",sx:{fontWeight:600},children:["Attached Images (",s.imageUrls.length,")"]})]}),e.jsx(be,{cols:n?2:E?3:4,gap:n?8:12,sx:{mt:{xs:1,sm:2}},children:s.imageUrls.map((o,t)=>e.jsx(je,{sx:{cursor:"pointer",borderRadius:1,overflow:"hidden",border:"1px solid #e0e0e0","&:hover":{opacity:.8,boxShadow:2}},onClick:()=>ze(t),children:ye.has(t)?e.jsxs(r,{sx:{width:"100%",height:150,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5"},children:[e.jsx(ms,{sx:{fontSize:40,color:"text.secondary",mb:1}}),e.jsx(a,{variant:"caption",color:"text.secondary",children:"Failed to load"})]}):e.jsx("img",{src:o,alt:`Complaint image ${t+1}`,loading:"lazy",style:{width:"100%",height:150,objectFit:"cover"},onError:()=>Ae(t)})},t))})]})]}),s.audioUrls&&s.audioUrls.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(k,{sx:{my:3}}),e.jsxs(r,{sx:{mb:3},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:1.5},children:[e.jsx(hs,{sx:{mr:1,color:"text.secondary"}}),e.jsxs(a,{variant:"subtitle1",sx:{fontWeight:600},children:["Voice Recordings (",s.audioUrls.length,")"]})]}),s.audioUrls.map((o,t)=>{var i,x;return e.jsxs(r,{sx:{border:"1px solid #e0e0e0",borderRadius:2,p:2,mb:2,backgroundColor:"#f8f9fa"},children:[e.jsx("audio",{ref:h=>{p.current[t]=h},src:o,onTimeUpdate:()=>Te(t),onEnded:()=>Le(t),onLoadedMetadata:h=>{const u=h.currentTarget;u.volume=H[t]||1,u.playbackRate=F[t]||1},style:{display:"none"}}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(b,{onClick:()=>Ve(t),sx:{backgroundColor:"#4CAF50",color:"white","&:hover":{backgroundColor:"#45a049"}},children:X[t]?e.jsx(vs,{}):e.jsx(Ss,{})}),e.jsxs(r,{sx:{flex:1},children:[e.jsx(r,{onClick:h=>Oe(t,h),sx:{height:6,backgroundColor:"#e0e0e0",borderRadius:3,cursor:"pointer",position:"relative","&:hover":{backgroundColor:"#d0d0d0"}},children:e.jsx(r,{sx:{height:"100%",width:`${ve[t]||0}%`,backgroundColor:"#4CAF50",borderRadius:3,transition:"width 0.1s linear"}})}),e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",mt:.5},children:[e.jsx(a,{variant:"caption",color:"text.secondary",children:se(((i=p.current[t])==null?void 0:i.currentTime)||0)}),e.jsx(a,{variant:"caption",color:"text.secondary",children:se(((x=p.current[t])==null?void 0:x.duration)||0)})]})]}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(b,{size:"small",onClick:()=>ee(t,H[t]>0?0:1),children:(H[t]||1)>0?e.jsx(ws,{}):e.jsx(Es,{})}),e.jsx(r,{sx:{width:60},children:e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:H[t]||1,onChange:h=>ee(t,parseFloat(h.target.value)),style:{width:"100%"}})})]}),e.jsxs($,{size:"small",variant:"outlined",startIcon:e.jsx(ts,{}),onClick:()=>He(t),sx:{minWidth:80,textTransform:"none"},children:[F[t]||1,"x"]}),e.jsx(b,{size:"small",onClick:()=>Ue(o,t),children:e.jsx(pe,{})})]}),e.jsxs(a,{variant:"caption",color:"text.secondary",children:["Recording ",t+1]})]},t)})]})]}),(s.resolutionNote||s.resolutionImages)&&e.jsxs(e.Fragment,{children:[e.jsx(k,{sx:{my:{xs:2,sm:3}}}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:{xs:1,sm:1.5}},children:[e.jsx(ue,{sx:{mr:1,color:"#4CAF50",fontSize:{xs:18,sm:20}}}),e.jsx(a,{variant:n?"body1":"subtitle1",sx:{fontWeight:600,color:"#4CAF50"},children:"Admin Resolution Report"})]}),s.resolutionNote&&e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",sx:{mb:.5},children:"Resolution Note"}),e.jsx(r,{sx:{p:{xs:1.5,sm:2},backgroundColor:"#f0f7f0",border:"1px solid #c3e6cb",borderRadius:1},children:e.jsx(a,{variant:n?"body2":"body1",sx:{whiteSpace:"pre-wrap"},children:s.resolutionNote})})]}),s.resolutionImages&&(()=>{const o=s.resolutionImages.split(",").filter(t=>t.trim());return o.length>0&&e.jsxs(r,{children:[e.jsxs(a,{variant:n?"caption":"body2",color:"text.secondary",sx:{mb:1},children:["Resolution Images (",o.length,")"]}),e.jsx(be,{cols:n?2:E?3:4,gap:n?8:12,children:o.map((t,i)=>e.jsx(je,{sx:{cursor:"pointer",borderRadius:1,overflow:"hidden",border:"2px solid #4CAF50","&:hover":{opacity:.8,boxShadow:2}},onClick:()=>{window.open(t.trim(),"_blank")},children:e.jsx("img",{src:t.trim(),alt:`Resolution image ${i+1}`,loading:"lazy",style:{width:"100%",height:150,objectFit:"cover"},onError:x=>{const h=x.target;h.style.display="none";const u=h.parentElement;u&&(u.innerHTML=`
                                                                                <div style="width: 100%; height: 150px; display: flex; flex-direction: column; align-items: center; justify-content: center; background-color: #f5f5f5;">
                                                                                    <svg style="width: 40px; height: 40px; color: #757575; margin-bottom: 8px;" fill="currentColor" viewBox="0 0 24 24">
                                                                                        <path d="M21 5v6.59l-3-3.01-4 4.01-4-4-4 4-3-3.01V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2zm-3 6.42l3 3.01V19c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2v-6.58l3 2.99 4-4 4 4 4-4z"/>
                                                                                    </svg>
                                                                                    <span style="font-size: 12px; color: #757575;">Failed to load</span>
                                                                                </div>
                                                                            `)}})},i))})]})})()]})]})]})]}),e.jsxs(rs,{sx:{px:{xs:2,sm:3},py:{xs:1.5,sm:2},borderTop:"1px solid #e0e0e0",gap:{xs:1,sm:1.5},justifyContent:"space-between",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"stretch",sm:"center"}},children:[s&&oe(s.status).length>0&&V()&&e.jsx(r,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:1,alignItems:{xs:"stretch",sm:"center"},width:{xs:"100%",sm:"auto"},flexWrap:"wrap"},children:oe(s.status).map(o=>e.jsx($,{variant:"contained",onClick:()=>$e(o.status),disabled:O,startIcon:O?e.jsx(he,{size:16}):e.jsx(ue,{}),sx:{backgroundColor:o.color,"&:hover":{backgroundColor:o.color,opacity:.9},textTransform:"none",minHeight:{xs:44,sm:"auto"},fontSize:{xs:"0.875rem",sm:"0.875rem"},px:{xs:2,sm:2}},children:O?"Updating...":o.label},o.status))}),s&&!V()&&T()&&e.jsx(me,{severity:"info",sx:{flex:1},children:e.jsx(a,{variant:"body2",children:"à¦­à¦¿à¦‰ à¦…à¦¨à¦²à¦¿ à¦®à§‹à¦¡ - à¦†à¦ªà¦¨à¦¿ à¦¶à§à¦§à§à¦®à¦¾à¦¤à§à¦° à¦•à¦®à¦ªà§à¦²à§‡à¦‡à¦¨ à¦¦à§‡à¦–à¦¤à§‡ à¦ªà¦¾à¦°à¦¬à§‡à¦¨, à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¬à§‡à¦¨ à¦¨à¦¾à¥¤"})}),e.jsxs(r,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:1,width:{xs:"100%",sm:"auto"}},children:[C&&s&&e.jsx($,{variant:"outlined",startIcon:!n&&e.jsx(us,{}),onClick:()=>C(s.id),sx:{textTransform:"none",minHeight:{xs:44,sm:"auto"}},children:"Open Chat"}),e.jsx($,{onClick:J,variant:"outlined",sx:{textTransform:"none",minHeight:{xs:44,sm:"auto"}},children:"Close"})]})]})]}),e.jsx(ls,{open:ke,onClose:()=>G(!1),onConfirm:We,loading:O}),s&&s.imageUrls&&s.imageUrls.length>0&&e.jsx(as,{open:R,onClick:Y,sx:{zIndex:v.zIndex.modal+1,backgroundColor:"rgba(0, 0, 0, 0.9)"},children:e.jsxs(r,{onClick:o=>o.stopPropagation(),sx:{position:"relative",maxWidth:"90vw",maxHeight:"90vh",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsxs(r,{sx:{position:"absolute",top:-60,right:0,display:"flex",gap:1,zIndex:1},children:[e.jsx(b,{onClick:De,disabled:P<=.5,sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:e.jsx(Ns,{})}),e.jsx(b,{onClick:Re,disabled:P>=3,sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:e.jsx(ds,{})}),e.jsx(b,{onClick:Pe,sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:e.jsx(pe,{})}),e.jsx(b,{onClick:Y,sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:e.jsx(xe,{})})]}),e.jsxs(r,{sx:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",overflow:"auto",maxWidth:"100%",maxHeight:"100%"},children:[s.imageUrls.length>1&&e.jsx(b,{onClick:Ne,sx:{position:"absolute",left:-60,color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:e.jsx(ys,{sx:{fontSize:40}})}),e.jsx("img",{src:s.imageUrls[j],alt:`Complaint image ${j+1}`,style:{maxWidth:"100%",maxHeight:"90vh",transform:`scale(${P})`,transition:"transform 0.2s ease-in-out"}}),s.imageUrls.length>1&&e.jsx(b,{onClick:Me,sx:{position:"absolute",right:-60,color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:e.jsx(Cs,{sx:{fontSize:40}})})]}),s.imageUrls.length>1&&e.jsx(r,{sx:{position:"absolute",bottom:-50,color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)",px:2,py:1,borderRadius:1},children:e.jsxs(a,{variant:"body2",children:[j+1," / ",s.imageUrls.length]})})]})})]})};function Hs(l,g=500){const[y,f]=c.useState(l);return c.useEffect(()=>{const C=setTimeout(()=>{f(l)},g);return()=>{clearTimeout(C)}},[l,g]),y}export{us as C,Vs as E,Ts as a,Ls as b,Hs as u};
