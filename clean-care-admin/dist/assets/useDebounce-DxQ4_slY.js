import{j as e,B as r,H as J,T as a,q as ye,N as le,br as Ve,bs as He,bt as Ge,bu as Je,bv as Ze,bw as _e,bx as Xe,u as Qe,p as ce,t as qe,v as Ke,i as g,w as de,x as Ye,C as xe,m as ue,aC as es,D as S,M as ss,az as os,K as ts,h as rs,aY as as,by as ns,aA as is,aT as me,aU as he,bz as ls,bA as cs,bB as ds,bC as xs,bD as us,bE as ms,b as B,ao as hs,aO as ge,z as be,y as gs,aQ as bs,bF as fs,bG as ys,aZ as js,bH as ps,bI as Cs}from"./mui-vendor-Dt-wTuK2.js";import{r as l,a as vs}from"./react-vendor-D7yrL1sD.js";import{t as Ss,h as Z,f as Is,a as I,s as ks,b as Es,j as ws,z as L}from"./index-CEqbPxQ7.js";import{c as A,a as fe,M as Ns}from"./categoryService-B3DaKUia.js";const Rs=({categoryId:c,subcategoryId:h})=>{const[j,y]=l.useState(""),[p,C]=l.useState(""),[n,k]=l.useState(""),[T,M]=l.useState(""),[s,E]=l.useState("#808080"),[w,N]=l.useState(!0);l.useEffect(()=>{c&&h&&(async()=>{try{N(!0);const[D,O,b,z,P]=await Promise.all([A.getCategoryName(c,"en"),A.getCategoryName(c,"bn"),A.getSubcategoryName(c,h,"en"),A.getSubcategoryName(c,h,"bn"),A.getCategoryColor(c)]);y(D),C(O),k(b),M(z),E(P)}catch(D){console.error("Error fetching category info:",D),y("Unknown Category"),C("à¦…à¦œà¦¾à¦¨à¦¾ à¦¬à¦¿à¦­à¦¾à¦—"),k("Unknown Subcategory"),M("à¦…à¦œà¦¾à¦¨à¦¾ à¦‰à¦ªà¦¬à¦¿à¦­à¦¾à¦—")}finally{N(!1)}})()},[c,h]);const R=()=>{const u={sx:{fontSize:40,color:s}};switch(c){case"home":return e.jsx(Xe,{...u});case"road_environment":return e.jsx(_e,{...u});case"business":return e.jsx(le,{...u});case"office":return e.jsx(Ze,{...u});case"education":return e.jsx(Je,{...u});case"hospital":return e.jsx(Ge,{...u});case"religious":return e.jsx(He,{...u});case"events":return e.jsx(Ve,{...u});default:return e.jsx(le,{...u})}};return w?e.jsxs(r,{sx:{display:"flex",gap:2,alignItems:"center"},children:[e.jsx(J,{variant:"circular",width:40,height:40}),e.jsxs(r,{sx:{flex:1},children:[e.jsx(J,{variant:"text",width:"60%",height:24}),e.jsx(J,{variant:"text",width:"80%",height:20})]})]}):e.jsxs(r,{sx:{display:"flex",gap:2,alignItems:"flex-start",p:2,backgroundColor:"#f8f9fa",borderRadius:2,border:`2px solid ${s}`},children:[e.jsx(r,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:60,height:60,borderRadius:2,backgroundColor:`${s}15`},children:R()}),e.jsxs(r,{sx:{flex:1},children:[e.jsxs(r,{sx:{mb:1},children:[e.jsx(a,{variant:"body1",sx:{fontWeight:600,color:s,mb:.5},children:j}),e.jsx(a,{variant:"body2",sx:{color:"text.secondary",fontStyle:"italic"},children:p})]}),e.jsxs(r,{children:[e.jsx(a,{variant:"body2",sx:{fontWeight:500,mb:.5},children:n}),e.jsx(a,{variant:"caption",sx:{color:"text.secondary",fontStyle:"italic"},children:T})]})]}),e.jsx(ye,{label:j,size:"small",sx:{backgroundColor:s,color:"#fff",fontWeight:500,fontSize:"0.75rem",height:24,boxShadow:"0 1px 3px rgba(0,0,0,0.12)"}})]})},Ts=({complaintId:c,open:h,onClose:j,onStatusUpdate:y,onChatOpen:p})=>{var oe,te,re,ae,ne,ie;const C=Qe(),n=ce(C.breakpoints.down("sm")),k=ce(C.breakpoints.down("md")),{canEditComplaints:T,canViewComplaints:M}=Ss(),[s,E]=l.useState(null),[w,N]=l.useState(!1),[R,u]=l.useState(null),[D,O]=l.useState(!1),[b,z]=l.useState(0),[P,v]=l.useState(1),[je,pe]=l.useState(new Set),[_,F]=l.useState({}),[Ce,X]=l.useState({}),[U,ve]=l.useState({}),[V,Se]=l.useState({}),f=vs.useRef({}),[$,W]=l.useState(!1),[Ie,H]=l.useState(!1);l.useEffect(()=>{h&&c&&Q()},[h,c]);const Q=async()=>{if(c)try{N(!0),u(null);const o=await fe.getComplaintById(c);console.log("ðŸ“‹ Complaint data received:",{id:o.id,resolutionImages:o.resolutionImages,resolutionNote:o.resolutionNote,status:o.status}),E(o)}catch(o){const t=Z(o);u(t.userMessage)}finally{N(!1)}},G=()=>{E(null),u(null),j()},ke=o=>{switch(o){case"PENDING":return{backgroundColor:"#fff3cd",color:"#856404",borderColor:"#ffeeba"};case"IN_PROGRESS":return{backgroundColor:"#d1ecf1",color:"#0c5460",borderColor:"#bee5eb"};case"RESOLVED":return{backgroundColor:"#d4edda",color:"#155724",borderColor:"#c3e6cb"};case"REJECTED":return{backgroundColor:"#f8d7da",color:"#721c24",borderColor:"#f5c6cb"};default:return{backgroundColor:"#f8f9fa",color:"#6c757d"}}},Ee=o=>{switch(o){case"PENDING":return"Pending";case"IN_PROGRESS":return"In Progress";case"RESOLVED":return"Solved";case"REJECTED":return"Rejected";default:return o}},q=o=>new Date(o).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),we=o=>{z(o),v(1),O(!0)},K=()=>{O(!1),v(1)},Ne=()=>{s&&s.imageUrls.length>0&&(z(o=>o===0?s.imageUrls.length-1:o-1),v(1))},Re=()=>{s&&s.imageUrls.length>0&&(z(o=>o===s.imageUrls.length-1?0:o+1),v(1))},De=()=>{v(o=>Math.min(o+.25,3))},ze=()=>{v(o=>Math.max(o-.25,.5))},Pe=()=>{if(s&&s.imageUrls[b]){const o=document.createElement("a");o.href=s.imageUrls[b],o.download=`complaint-${s.id}-image-${b+1}.jpg`,document.body.appendChild(o),o.click(),document.body.removeChild(o)}},Ae=o=>{pe(t=>new Set(t).add(o))},Te=o=>{const t=f.current[o];t&&(_[o]?(t.pause(),F(i=>({...i,[o]:!1}))):(t.play(),F(i=>({...i,[o]:!0}))))},Me=o=>{const t=f.current[o];if(!t)return;const i=t.currentTime/t.duration*100;X(d=>({...d,[o]:i}))},Oe=o=>{F(t=>({...t,[o]:!1})),X(t=>({...t,[o]:0}))},Y=(o,t)=>{const i=f.current[o];i&&(i.volume=t,ve(d=>({...d,[o]:t})))},Ue=o=>{const t=f.current[o];if(!t)return;const i=[.5,1,1.5,2],d=V[o]||1,x=i.indexOf(d),m=i[(x+1)%i.length];t.playbackRate=m,Se(Fe=>({...Fe,[o]:m}))},$e=(o,t)=>{const i=f.current[o];if(!i)return;const d=t.currentTarget.getBoundingClientRect(),m=(t.clientX-d.left)/d.width;i.currentTime=m*i.duration},We=(o,t)=>{const i=document.createElement("a");i.href=o,i.download=`complaint-${s==null?void 0:s.id}-audio-${t+1}.mp3`,document.body.appendChild(i),i.click(),document.body.removeChild(i)},ee=o=>{if(isNaN(o))return"0:00";const t=Math.floor(o/60),i=Math.floor(o%60);return`${t}:${i.toString().padStart(2,"0")}`},Be=async o=>{if(!(!s||!c)){if(o==="REJECTED"){H(!0);return}try{W(!0),y(c,o),E(t=>t?{...t,status:o}:null),L.success("Status updated successfully",{icon:"âœ…",duration:3e3})}catch(t){const i=Z(t);L.error(i.userMessage,{duration:5e3,icon:"âŒ"})}finally{W(!1)}}},Le=async(o,t,i,d)=>{if(!(!s||!c))try{W(!0),await fe.markComplaintAsOthers(c,{othersCategory:o,othersSubcategory:t,note:i,images:d}),y(c,"REJECTED"),L.success("Complaint marked as Others successfully",{icon:"âœ…",duration:3e3}),H(!1),Q()}catch(x){const m=Z(x);L.error(m.userMessage,{duration:5e3,icon:"âŒ"})}finally{W(!1)}},se=o=>({PENDING:[{status:"IN_PROGRESS",label:"Mark In Progress",color:"#0c5460"},{status:"RESOLVED",label:"Mark Solved",color:"#155724"},{status:"REJECTED",label:"Mark Rejected",color:"#721c24"}],IN_PROGRESS:[{status:"PENDING",label:"Mark Pending",color:"#856404"},{status:"RESOLVED",label:"Mark Solved",color:"#155724"},{status:"REJECTED",label:"Mark Rejected",color:"#721c24"}],RESOLVED:[{status:"PENDING",label:"Mark Pending",color:"#856404"},{status:"IN_PROGRESS",label:"Mark In Progress",color:"#0c5460"},{status:"REJECTED",label:"Mark Rejected",color:"#721c24"}],REJECTED:[{status:"PENDING",label:"Mark Pending",color:"#856404"},{status:"IN_PROGRESS",label:"Mark In Progress",color:"#0c5460"},{status:"RESOLVED",label:"Mark Solved",color:"#155724"}],OTHERS:[{status:"PENDING",label:"Mark Pending",color:"#856404"},{status:"IN_PROGRESS",label:"Mark In Progress",color:"#0c5460"},{status:"RESOLVED",label:"Mark Solved",color:"#155724"},{status:"REJECTED",label:"Mark Rejected",color:"#721c24"}]})[o]||[];return e.jsxs(e.Fragment,{children:[e.jsxs(qe,{open:h,onClose:G,maxWidth:"md",fullWidth:!0,fullScreen:n,slotProps:{paper:{sx:{borderRadius:n?0:2,maxHeight:n?"100vh":"90vh",animation:n?`${ks} ${I.normal.duration} ${I.smooth.timing}`:`${Es} ${I.normal.duration} ${I.smooth.timing}`,animationFillMode:"both"}},backdrop:{sx:{animation:`${Is} ${I.fast.duration} ${I.fast.timing}`}}},children:[e.jsxs(Ke,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:2,borderBottom:"1px solid #e0e0e0"},children:[e.jsx(a,{component:"span",variant:"h6",sx:{fontWeight:600},children:"Complaint Details"}),e.jsx(g,{onClick:G,size:"small",sx:{color:"text.secondary","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"}},children:e.jsx(de,{})})]}),e.jsxs(Ye,{sx:{pt:{xs:2,sm:3},pb:{xs:1.5,sm:2}},children:[w&&e.jsx(r,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:{xs:200,sm:300}},children:e.jsx(xe,{})}),R&&!w&&e.jsx(ue,{severity:"error",sx:{mb:2},children:R}),s&&!w&&!R&&e.jsxs(r,{children:[e.jsxs(r,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},mb:{xs:2,sm:3},gap:{xs:1,sm:2}},children:[e.jsx(a,{variant:n?"h6":"h5",sx:{fontWeight:600,color:"#4CAF50"},children:s.trackingNumber||`C${String(s.id).padStart(6,"0")}`}),e.jsx(ye,{label:Ee(s.status),sx:{...ke(s.status),...ws,fontWeight:500,fontSize:{xs:"0.75rem",sm:"0.875rem"},height:{xs:28,sm:32}}})]}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsx(a,{variant:n?"caption":"subtitle2",color:"text.secondary",sx:{mb:.5},children:"Complaint Title"}),e.jsx(a,{variant:n?"body2":"body1",sx:{fontWeight:500},children:s.title})]}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsx(a,{variant:n?"caption":"subtitle2",color:"text.secondary",sx:{mb:1},children:"Category"}),s.category&&s.subcategory?e.jsx(Rs,{categoryId:s.category,subcategoryId:s.subcategory}):e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1,p:1.5,backgroundColor:"#f5f5f5",border:"1px dashed #bdbdbd",borderRadius:1},children:[e.jsx(es,{sx:{color:"#757575",fontSize:20}}),e.jsx(a,{variant:"body2",sx:{color:"#757575",fontStyle:"italic"},children:"This complaint has not been categorized yet. It was created before the category system was implemented."})]})]}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsx(a,{variant:n?"caption":"subtitle2",color:"text.secondary",sx:{mb:.5},children:"Description"}),e.jsx(a,{variant:n?"body2":"body1",sx:{whiteSpace:"pre-wrap"},children:s.description})]}),e.jsx(S,{sx:{my:{xs:2,sm:3}}}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:{xs:1,sm:1.5}},children:[e.jsx(ss,{sx:{mr:1,color:"text.secondary",fontSize:{xs:18,sm:20}}}),e.jsx(a,{variant:n?"body1":"subtitle1",sx:{fontWeight:600},children:"Location Information"})]}),e.jsxs(r,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:{xs:1.5,sm:2}},children:[e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"District"}),e.jsx(a,{variant:n?"body2":"body1",children:((oe=s.locationDetails)==null?void 0:oe.district)||"N/A"})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Thana"}),e.jsx(a,{variant:n?"body2":"body1",children:((te=s.locationDetails)==null?void 0:te.thana)||"N/A"})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Ward"}),e.jsx(a,{variant:n?"body2":"body1",children:((re=s.locationDetails)==null?void 0:re.ward)||(s.user.ward?typeof s.user.ward=="object"?`Ward ${s.user.ward.wardNumber}`:`Ward ${s.user.ward}`:"N/A")})]}),e.jsxs(r,{sx:{gridColumn:{xs:"1",sm:"1 / -1"}},children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Full Address"}),e.jsx(a,{variant:n?"body2":"body1",children:((ae=s.locationDetails)==null?void 0:ae.address)||s.location})]})]})]}),e.jsx(S,{sx:{my:{xs:2,sm:3}}}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:{xs:1,sm:1.5}},children:[e.jsx(os,{sx:{mr:1,color:"text.secondary",fontSize:{xs:18,sm:20}}}),e.jsx(a,{variant:n?"body1":"subtitle1",sx:{fontWeight:600},children:"Citizen Information"})]}),e.jsxs(r,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:{xs:1.5,sm:2}},children:[e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Citizen ID"}),e.jsxs(a,{variant:n?"body2":"body1",children:["U",String(s.user.id).padStart(6,"0")]})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Name"}),e.jsxs(a,{variant:n?"body2":"body1",children:[s.user.firstName," ",s.user.lastName]})]}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ts,{sx:{fontSize:{xs:16,sm:18},color:"text.secondary"}}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Phone"}),e.jsx(a,{variant:n?"body2":"body1",children:s.user.phone})]})]}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(rs,{sx:{fontSize:{xs:16,sm:18},color:"text.secondary"}}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Email"}),e.jsx(a,{variant:n?"body2":"body1",sx:{wordBreak:"break-word",fontSize:{xs:"0.75rem",sm:"1rem"}},children:s.user.email||"Not provided"})]})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"City Corporation"}),e.jsx(a,{variant:n?"body2":"body1",children:((ne=s.user.cityCorporation)==null?void 0:ne.name)||"N/A"})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Zone"}),e.jsx(a,{variant:n?"body2":"body1",children:s.user.zone?`Zone ${s.user.zone}`:"N/A"})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Ward Number"}),e.jsx(a,{variant:n?"body2":"body1",children:s.user.ward?typeof s.user.ward=="object"?`Ward ${s.user.ward.wardNumber}`:`Ward ${s.user.ward}`:"N/A"})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Thana/Area"}),e.jsx(a,{variant:n?"body2":"body1",children:((ie=s.user.thana)==null?void 0:ie.name)||"N/A"})]}),s.user.address&&e.jsxs(r,{sx:{gridColumn:{xs:"1",sm:"1 / -1"}},children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Citizen Address"}),e.jsx(a,{variant:n?"body2":"body1",sx:{wordBreak:"break-word"},children:s.user.address})]})]})]}),e.jsx(S,{sx:{my:{xs:2,sm:3}}}),e.jsxs(r,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:{xs:1.5,sm:2}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(as,{sx:{fontSize:{xs:16,sm:18},color:"text.secondary"}}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Submitted"}),e.jsx(a,{variant:n?"body2":"body1",sx:{fontSize:{xs:"0.75rem",sm:"1rem"}},children:q(s.createdAt)})]})]}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ns,{sx:{fontSize:{xs:16,sm:18},color:"text.secondary"}}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Last Updated"}),e.jsx(a,{variant:n?"body2":"body1",sx:{fontSize:{xs:"0.75rem",sm:"1rem"}},children:q(s.updatedAt)})]})]})]}),s.imageUrls&&s.imageUrls.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(S,{sx:{my:{xs:2,sm:3}}}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:{xs:1,sm:1.5}},children:[e.jsx(is,{sx:{mr:1,color:"text.secondary",fontSize:{xs:18,sm:20}}}),e.jsxs(a,{variant:n?"body1":"subtitle1",sx:{fontWeight:600},children:["Attached Images (",s.imageUrls.length,")"]})]}),e.jsx(me,{cols:n?2:k?3:4,gap:n?8:12,sx:{mt:{xs:1,sm:2}},children:s.imageUrls.map((o,t)=>e.jsx(he,{sx:{cursor:"pointer",borderRadius:1,overflow:"hidden",border:"1px solid #e0e0e0","&:hover":{opacity:.8,boxShadow:2}},onClick:()=>we(t),children:je.has(t)?e.jsxs(r,{sx:{width:"100%",height:150,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5"},children:[e.jsx(ls,{sx:{fontSize:40,color:"text.secondary",mb:1}}),e.jsx(a,{variant:"caption",color:"text.secondary",children:"Failed to load"})]}):e.jsx("img",{src:o,alt:`Complaint image ${t+1}`,loading:"lazy",style:{width:"100%",height:150,objectFit:"cover"},onError:()=>Ae(t)})},t))})]})]}),s.audioUrls&&s.audioUrls.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(S,{sx:{my:3}}),e.jsxs(r,{sx:{mb:3},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:1.5},children:[e.jsx(cs,{sx:{mr:1,color:"text.secondary"}}),e.jsxs(a,{variant:"subtitle1",sx:{fontWeight:600},children:["Voice Recordings (",s.audioUrls.length,")"]})]}),s.audioUrls.map((o,t)=>{var i,d;return e.jsxs(r,{sx:{border:"1px solid #e0e0e0",borderRadius:2,p:2,mb:2,backgroundColor:"#f8f9fa"},children:[e.jsx("audio",{ref:x=>{f.current[t]=x},src:o,onTimeUpdate:()=>Me(t),onEnded:()=>Oe(t),onLoadedMetadata:x=>{const m=x.currentTarget;m.volume=U[t]||1,m.playbackRate=V[t]||1},style:{display:"none"}}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(g,{onClick:()=>Te(t),sx:{backgroundColor:"#4CAF50",color:"white","&:hover":{backgroundColor:"#45a049"}},children:_[t]?e.jsx(ds,{}):e.jsx(xs,{})}),e.jsxs(r,{sx:{flex:1},children:[e.jsx(r,{onClick:x=>$e(t,x),sx:{height:6,backgroundColor:"#e0e0e0",borderRadius:3,cursor:"pointer",position:"relative","&:hover":{backgroundColor:"#d0d0d0"}},children:e.jsx(r,{sx:{height:"100%",width:`${Ce[t]||0}%`,backgroundColor:"#4CAF50",borderRadius:3,transition:"width 0.1s linear"}})}),e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",mt:.5},children:[e.jsx(a,{variant:"caption",color:"text.secondary",children:ee(((i=f.current[t])==null?void 0:i.currentTime)||0)}),e.jsx(a,{variant:"caption",color:"text.secondary",children:ee(((d=f.current[t])==null?void 0:d.duration)||0)})]})]}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(g,{size:"small",onClick:()=>Y(t,U[t]>0?0:1),children:(U[t]||1)>0?e.jsx(us,{}):e.jsx(ms,{})}),e.jsx(r,{sx:{width:60},children:e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:U[t]||1,onChange:x=>Y(t,parseFloat(x.target.value)),style:{width:"100%"}})})]}),e.jsxs(B,{size:"small",variant:"outlined",startIcon:e.jsx(hs,{}),onClick:()=>Ue(t),sx:{minWidth:80,textTransform:"none"},children:[V[t]||1,"x"]}),e.jsx(g,{size:"small",onClick:()=>We(o,t),children:e.jsx(ge,{})})]}),e.jsxs(a,{variant:"caption",color:"text.secondary",children:["Recording ",t+1]})]},t)})]})]}),(s.resolutionNote||s.resolutionImages)&&e.jsxs(e.Fragment,{children:[e.jsx(S,{sx:{my:{xs:2,sm:3}}}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:{xs:1,sm:1.5}},children:[e.jsx(be,{sx:{mr:1,color:"#4CAF50",fontSize:{xs:18,sm:20}}}),e.jsx(a,{variant:n?"body1":"subtitle1",sx:{fontWeight:600,color:"#4CAF50"},children:"Admin Resolution Report"})]}),s.resolutionNote&&e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",sx:{mb:.5},children:"Resolution Note"}),e.jsx(r,{sx:{p:{xs:1.5,sm:2},backgroundColor:"#f0f7f0",border:"1px solid #c3e6cb",borderRadius:1},children:e.jsx(a,{variant:n?"body2":"body1",sx:{whiteSpace:"pre-wrap"},children:s.resolutionNote})})]}),s.resolutionImages&&(()=>{const o=s.resolutionImages.split(",").filter(t=>t.trim());return o.length>0&&e.jsxs(r,{children:[e.jsxs(a,{variant:n?"caption":"body2",color:"text.secondary",sx:{mb:1},children:["Resolution Images (",o.length,")"]}),e.jsx(me,{cols:n?2:k?3:4,gap:n?8:12,children:o.map((t,i)=>e.jsx(he,{sx:{cursor:"pointer",borderRadius:1,overflow:"hidden",border:"2px solid #4CAF50","&:hover":{opacity:.8,boxShadow:2}},onClick:()=>{window.open(t.trim(),"_blank")},children:e.jsx("img",{src:t.trim(),alt:`Resolution image ${i+1}`,loading:"lazy",style:{width:"100%",height:150,objectFit:"cover"},onError:d=>{const x=d.target;x.style.display="none";const m=x.parentElement;m&&(m.innerHTML=`
                                                                                <div style="width: 100%; height: 150px; display: flex; flex-direction: column; align-items: center; justify-content: center; background-color: #f5f5f5;">
                                                                                    <svg style="width: 40px; height: 40px; color: #757575; margin-bottom: 8px;" fill="currentColor" viewBox="0 0 24 24">
                                                                                        <path d="M21 5v6.59l-3-3.01-4 4.01-4-4-4 4-3-3.01V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2zm-3 6.42l3 3.01V19c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2v-6.58l3 2.99 4-4 4 4 4-4z"/>
                                                                                    </svg>
                                                                                    <span style="font-size: 12px; color: #757575;">Failed to load</span>
                                                                                </div>
                                                                            `)}})},i))})]})})()]})]})]})]}),e.jsxs(gs,{sx:{px:{xs:2,sm:3},py:{xs:1.5,sm:2},borderTop:"1px solid #e0e0e0",gap:{xs:1,sm:1.5},justifyContent:"space-between",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"stretch",sm:"center"}},children:[s&&se(s.status).length>0&&T()&&e.jsx(r,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:1,alignItems:{xs:"stretch",sm:"center"},width:{xs:"100%",sm:"auto"},flexWrap:"wrap"},children:se(s.status).map(o=>e.jsx(B,{variant:"contained",onClick:()=>Be(o.status),disabled:$,startIcon:$?e.jsx(xe,{size:16}):e.jsx(be,{}),sx:{backgroundColor:o.color,"&:hover":{backgroundColor:o.color,opacity:.9},textTransform:"none",minHeight:{xs:44,sm:"auto"},fontSize:{xs:"0.875rem",sm:"0.875rem"},px:{xs:2,sm:2}},children:$?"Updating...":o.label},o.status))}),s&&!T()&&M()&&e.jsx(ue,{severity:"info",sx:{flex:1},children:e.jsx(a,{variant:"body2",children:"à¦­à¦¿à¦‰ à¦…à¦¨à¦²à¦¿ à¦®à§‹à¦¡ - à¦†à¦ªà¦¨à¦¿ à¦¶à§à¦§à§à¦®à¦¾à¦¤à§à¦° à¦•à¦®à¦ªà§à¦²à§‡à¦‡à¦¨ à¦¦à§‡à¦–à¦¤à§‡ à¦ªà¦¾à¦°à¦¬à§‡à¦¨, à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¬à§‡à¦¨ à¦¨à¦¾à¥¤"})}),e.jsxs(r,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:1,width:{xs:"100%",sm:"auto"}},children:[p&&s&&e.jsx(B,{variant:"outlined",startIcon:!n&&e.jsx(bs,{}),onClick:()=>p(s.id),sx:{textTransform:"none",minHeight:{xs:44,sm:"auto"}},children:"Open Chat"}),e.jsx(B,{onClick:G,variant:"outlined",sx:{textTransform:"none",minHeight:{xs:44,sm:"auto"}},children:"Close"})]})]})]}),e.jsx(Ns,{open:Ie,onClose:()=>H(!1),onConfirm:Le,loading:$}),s&&s.imageUrls&&s.imageUrls.length>0&&e.jsx(fs,{open:D,onClick:K,sx:{zIndex:C.zIndex.modal+1,backgroundColor:"rgba(0, 0, 0, 0.9)"},children:e.jsxs(r,{onClick:o=>o.stopPropagation(),sx:{position:"relative",maxWidth:"90vw",maxHeight:"90vh",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsxs(r,{sx:{position:"absolute",top:-60,right:0,display:"flex",gap:1,zIndex:1},children:[e.jsx(g,{onClick:ze,disabled:P<=.5,sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:e.jsx(ys,{})}),e.jsx(g,{onClick:De,disabled:P>=3,sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:e.jsx(js,{})}),e.jsx(g,{onClick:Pe,sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:e.jsx(ge,{})}),e.jsx(g,{onClick:K,sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:e.jsx(de,{})})]}),e.jsxs(r,{sx:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",overflow:"auto",maxWidth:"100%",maxHeight:"100%"},children:[s.imageUrls.length>1&&e.jsx(g,{onClick:Ne,sx:{position:"absolute",left:-60,color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:e.jsx(ps,{sx:{fontSize:40}})}),e.jsx("img",{src:s.imageUrls[b],alt:`Complaint image ${b+1}`,style:{maxWidth:"100%",maxHeight:"90vh",transform:`scale(${P})`,transition:"transform 0.2s ease-in-out"}}),s.imageUrls.length>1&&e.jsx(g,{onClick:Re,sx:{position:"absolute",right:-60,color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:e.jsx(Cs,{sx:{fontSize:40}})})]}),s.imageUrls.length>1&&e.jsx(r,{sx:{position:"absolute",bottom:-50,color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)",px:2,py:1,borderRadius:1},children:e.jsxs(a,{variant:"body2",children:[b+1," / ",s.imageUrls.length]})})]})})]})};function Ms(c,h=500){const[j,y]=l.useState(c);return l.useEffect(()=>{const p=setTimeout(()=>{y(c)},h);return()=>{clearTimeout(p)}},[c,h]),j}export{Ts as C,Ms as u};
