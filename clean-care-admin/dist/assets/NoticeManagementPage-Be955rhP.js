import{j as e,B as o,C as R,A as ve,T as s,az as d,e as z,f as B,a4 as Ct,l as Ce,O as ke,aj as wt,aJ as Ve,ap as Ge,P as Ne,aq as Ze,ar as He,as as ge,at as p,au as Ke,p as W,s as de,t as ce,i as q,v as _e,w as xe,aF as Ae,D as J,b7 as It,cO as St,cT as Dt,cU as Nt,cV as At,x as he,b as N,bn as Ee,aO as zt,aP as Re,g as b,a1 as L,aX as Fe,bf as Se,y as qe,a$ as Ye,cG as Wt,V as $t}from"./mui-vendor-Brc-2iiC.js";import{r as u}from"./react-vendor-D7yrL1sD.js";import{a as Et,b as Te,D as Rt,c as Ft,S as Tt,v as Ut,d as Lt,s as Bt,K as Mt,P as Ot,u as Pt,C as kt}from"./sortable.esm-CBBmJpQ9.js";import{A as Ue,f as H,a as h,s as K,d as Vt,k as Gt,w as Zt,M as Ht,V as Le}from"./index-DBuvollO.js";import{a as Kt}from"./query-vendor-CZVuOxbJ.js";import{R as Be,P as _t,a as qt,C as Yt,T as Me,d as Oe,B as Xt,b as Jt,X as Qt,Y as ea,c as De}from"./chart-vendor-CrjdDA16.js";const v=Kt.create({baseURL:Ue.BASE_URL,timeout:Ue.TIMEOUT,withCredentials:!0,headers:{"Content-Type":"application/json"}});v.interceptors.request.use(l=>{const r=localStorage.getItem("accessToken");return r&&(l.headers.Authorization=`Bearer ${r}`),l});class ta{async getAllNotices(r={},a=1,f=20){const m=new URLSearchParams({page:a.toString(),limit:f.toString()});return r.categoryId&&m.append("categoryId",r.categoryId.toString()),r.type&&m.append("type",r.type),r.priority&&m.append("priority",r.priority),r.isActive!==void 0&&m.append("isActive",r.isActive.toString()),r.search&&m.append("search",r.search),(await v.get(`/api/notices?${m.toString()}`)).data}async getActiveNotices(r={},a=1,f=20){const m=new URLSearchParams({page:a.toString(),limit:f.toString()});return r.categoryId&&m.append("categoryId",r.categoryId.toString()),r.type&&m.append("type",r.type),(await v.get(`/api/notices/active?${m.toString()}`)).data}async getNoticeById(r){return(await v.get(`/api/notices/${r}`)).data}async createNotice(r){return(await v.post("/api/notices",r)).data}async updateNotice(r,a){return(await v.put(`/api/notices/${r}`,a)).data}async toggleNoticeStatus(r){return(await v.patch(`/api/notices/${r}/toggle`)).data}async deleteNotice(r){await v.delete(`/api/notices/${r}`)}async reorderNotices(r){await v.post("/api/notices/reorder",{orders:r})}async getAnalytics(){return(await v.get("/api/notices/analytics/stats")).data}async incrementViewCount(r){await v.post(`/api/notices/${r}/view`)}async markAsRead(r){await v.post(`/api/notices/${r}/read`)}async getAllCategories(){return(await v.get("/api/notice-categories")).data.data}async getCategoryTree(){return(await v.get("/api/notice-categories/tree")).data.data}async getCategoryById(r){return(await v.get(`/api/notice-categories/${r}`)).data.data}async createCategory(r){return(await v.post("/api/notice-categories",r)).data.data}async updateCategory(r,a){return(await v.put(`/api/notice-categories/${r}`,a)).data.data}async deleteCategory(r){await v.delete(`/api/notice-categories/${r}`)}async uploadImage(r){try{const a=new FormData;a.append("images",r);const f=await v.post("/api/uploads",a,{headers:{"Content-Type":"multipart/form-data"}});if(f.data.success&&f.data.data.fileUrls.length>0)return f.data.data.fileUrls[0];throw new Error("Failed to upload image")}catch(a){throw console.error("Error uploading image:",a),a}}}const F=new ta,aa=({categories:l})=>{const[r,a]=u.useState(null),[f,m]=u.useState(!0),[$,E]=u.useState(null);u.useEffect(()=>{_()},[]);const _=async()=>{try{m(!0),E(null);const c=await F.getAnalytics();a(c)}catch(c){E(c.message||"Failed to load analytics")}finally{m(!1)}};if(f)return e.jsx(o,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(R,{})});if($)return e.jsx(ve,{severity:"error",sx:{mb:2},children:$});if(!r)return e.jsx(ve,{severity:"info",children:"No analytics data available"});const w=r.categoryStats.map(c=>{const x=l.find(g=>g.id===c.categoryId);return{name:(x==null?void 0:x.name)||`Category ${c.categoryId}`,count:c._count,views:c._sum.viewCount||0,reads:c._sum.readCount||0,color:(x==null?void 0:x.color)||"#3FA564"}}),G=[{name:"Active",value:r.activeNotices,color:"#3FA564"},{name:"Expired",value:r.expiredNotices,color:"#FF6B6B"},{name:"Urgent",value:r.urgentNotices,color:"#FFE66D"}],T=r.totalViews>0?(r.totalReads/r.totalViews*100).toFixed(1):"0";return e.jsxs(o,{sx:{animation:`${H} ${h.normal.duration} ${h.smooth.timing}`,animationFillMode:"both"},children:[e.jsx(s,{variant:"h6",sx:{mb:3},fontWeight:"bold",children:"Notice Analytics Dashboard"}),e.jsxs(d,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(d,{size:{xs:12,sm:6,md:3},children:e.jsx(z,{sx:{color:"white",borderRadius:3,background:"linear-gradient(135deg, #16a34a 0%, #22c55e 100%)",boxShadow:"0 10px 24px rgba(34, 197, 94, 0.25)",transition:"transform 0.2s ease, box-shadow 0.2s ease","&:hover":{transform:"translateY(-3px)",boxShadow:"0 14px 30px rgba(34, 197, 94, 0.35)"},animation:`${K} ${h.normal.duration} ${h.smooth.timing}`,animationFillMode:"both",animationDelay:"50ms"},children:e.jsxs(B,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Ct,{sx:{mr:1}}),e.jsx(s,{variant:"subtitle2",children:"Total Notices"})]}),e.jsx(s,{variant:"h3",fontWeight:"bold",children:r.totalNotices}),e.jsxs(s,{variant:"caption",children:[r.activeNotices," active"]})]})})}),e.jsx(d,{size:{xs:12,sm:6,md:3},children:e.jsx(z,{sx:{color:"white",borderRadius:3,background:"linear-gradient(135deg, #0ea5e9 0%, #22d3ee 100%)",boxShadow:"0 10px 24px rgba(14, 165, 233, 0.25)",transition:"transform 0.2s ease, box-shadow 0.2s ease","&:hover":{transform:"translateY(-3px)",boxShadow:"0 14px 30px rgba(14, 165, 233, 0.35)"},animation:`${K} ${h.normal.duration} ${h.smooth.timing}`,animationFillMode:"both",animationDelay:"110ms"},children:e.jsxs(B,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Ce,{sx:{mr:1}}),e.jsx(s,{variant:"subtitle2",children:"Total Views"})]}),e.jsx(s,{variant:"h3",fontWeight:"bold",children:r.totalViews.toLocaleString()}),e.jsx(s,{variant:"caption",children:"Across all notices"})]})})}),e.jsx(d,{size:{xs:12,sm:6,md:3},children:e.jsx(z,{sx:{color:"#1f2937",borderRadius:3,background:"linear-gradient(135deg, #fde68a 0%, #fbbf24 100%)",boxShadow:"0 10px 24px rgba(251, 191, 36, 0.25)",transition:"transform 0.2s ease, box-shadow 0.2s ease","&:hover":{transform:"translateY(-3px)",boxShadow:"0 14px 30px rgba(251, 191, 36, 0.35)"},animation:`${K} ${h.normal.duration} ${h.smooth.timing}`,animationFillMode:"both",animationDelay:"170ms"},children:e.jsxs(B,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(ke,{sx:{mr:1}}),e.jsx(s,{variant:"subtitle2",children:"Total Reads"})]}),e.jsx(s,{variant:"h3",fontWeight:"bold",children:r.totalReads.toLocaleString()}),e.jsx(s,{variant:"caption",children:"Full content reads"})]})})}),e.jsx(d,{size:{xs:12,sm:6,md:3},children:e.jsx(z,{sx:{color:"white",borderRadius:3,background:"linear-gradient(135deg, #f97316 0%, #ef4444 100%)",boxShadow:"0 10px 24px rgba(239, 68, 68, 0.25)",transition:"transform 0.2s ease, box-shadow 0.2s ease","&:hover":{transform:"translateY(-3px)",boxShadow:"0 14px 30px rgba(239, 68, 68, 0.35)"},animation:`${K} ${h.normal.duration} ${h.smooth.timing}`,animationFillMode:"both",animationDelay:"230ms"},children:e.jsxs(B,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(wt,{sx:{mr:1}}),e.jsx(s,{variant:"subtitle2",children:"Engagement Rate"})]}),e.jsxs(s,{variant:"h3",fontWeight:"bold",children:[T,"%"]}),e.jsx(s,{variant:"caption",children:"Read/View ratio"})]})})})]}),e.jsxs(d,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(d,{size:{xs:12,md:6},children:e.jsx(z,{sx:{animation:`${H} ${h.normal.duration} ${h.smooth.timing}`,animationFillMode:"both",animationDelay:"80ms"},children:e.jsxs(B,{children:[e.jsx(s,{variant:"h6",fontWeight:"bold",sx:{mb:2},children:"Notice Status Distribution"}),e.jsx(Be,{width:"100%",height:300,children:e.jsxs(_t,{children:[e.jsx(qt,{data:G,cx:"50%",cy:"50%",labelLine:!1,label:({name:c,value:x})=>`${c}: ${x}`,outerRadius:100,fill:"#8884d8",dataKey:"value",animationDuration:1200,children:G.map((c,x)=>e.jsx(Yt,{fill:c.color},`cell-${x}`))}),e.jsx(Me,{}),e.jsx(Oe,{})]})})]})})}),e.jsx(d,{size:{xs:12,md:6},children:e.jsx(z,{sx:{animation:`${H} ${h.normal.duration} ${h.smooth.timing}`,animationFillMode:"both",animationDelay:"120ms"},children:e.jsxs(B,{children:[e.jsx(s,{variant:"h6",fontWeight:"bold",sx:{mb:2},children:"Category Performance"}),e.jsx(Be,{width:"100%",height:300,children:e.jsxs(Xt,{data:w,children:[e.jsx(Jt,{strokeDasharray:"3 3"}),e.jsx(Qt,{dataKey:"name"}),e.jsx(ea,{}),e.jsx(Me,{}),e.jsx(Oe,{}),e.jsx(De,{dataKey:"count",fill:"#3FA564",name:"Notices",animationDuration:1100}),e.jsx(De,{dataKey:"views",fill:"#4ECDC4",name:"Views",animationDuration:1300}),e.jsx(De,{dataKey:"reads",fill:"#FFE66D",name:"Reads",animationDuration:1500})]})})]})})})]}),e.jsx(z,{sx:{animation:`${H} ${h.normal.duration} ${h.smooth.timing}`,animationFillMode:"both",animationDelay:"140ms"},children:e.jsxs(B,{children:[e.jsxs(s,{variant:"h6",fontWeight:"bold",sx:{mb:2},children:[e.jsx(Ve,{sx:{mr:1,verticalAlign:"middle"}}),"Category-wise Statistics"]}),e.jsx(Ge,{component:Ne,variant:"outlined",children:e.jsxs(Ze,{children:[e.jsx(He,{children:e.jsxs(ge,{sx:{bgcolor:"#f5f5f5"},children:[e.jsx(p,{children:"Category"}),e.jsx(p,{align:"center",children:"Total Notices"}),e.jsx(p,{align:"center",children:"Total Views"}),e.jsx(p,{align:"center",children:"Total Reads"}),e.jsx(p,{align:"center",children:"Avg Views/Notice"}),e.jsx(p,{align:"center",children:"Engagement Rate"})]})}),e.jsxs(Ke,{children:[w.map((c,x)=>{const g=c.count>0?(c.views/c.count).toFixed(1):"0",Y=c.views>0?(c.reads/c.views*100).toFixed(1):"0";return e.jsxs(ge,{children:[e.jsx(p,{children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(o,{sx:{width:12,height:12,borderRadius:"50%",bgcolor:c.color}}),e.jsx(s,{fontWeight:"medium",children:c.name})]})}),e.jsx(p,{align:"center",children:e.jsx(W,{label:c.count,size:"small",color:"primary"})}),e.jsx(p,{align:"center",children:c.views.toLocaleString()}),e.jsx(p,{align:"center",children:c.reads.toLocaleString()}),e.jsx(p,{align:"center",children:g}),e.jsx(p,{align:"center",children:e.jsx(W,{label:`${Y}%`,size:"small",color:parseFloat(Y)>50?"success":"default"})})]},x)}),w.length===0&&e.jsx(ge,{children:e.jsx(p,{colSpan:6,align:"center",children:e.jsx(s,{color:"text.secondary",children:"No data available"})})})]})]})})]})}),e.jsx(z,{sx:{mt:3,bgcolor:"#f9f9f9",animation:`${H} ${h.normal.duration} ${h.smooth.timing}`,animationFillMode:"both",animationDelay:"180ms"},children:e.jsxs(B,{children:[e.jsx(s,{variant:"h6",fontWeight:"bold",sx:{mb:2},children:"Summary Insights"}),e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{size:{xs:12,md:4},children:e.jsxs(o,{sx:{p:2,bgcolor:"white",borderRadius:1},children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Most Active Category"}),e.jsx(s,{variant:"h6",fontWeight:"bold",children:w.length>0?w.reduce((c,x)=>c.count>x.count?c:x).name:"N/A"})]})}),e.jsx(d,{size:{xs:12,md:4},children:e.jsxs(o,{sx:{p:2,bgcolor:"white",borderRadius:1},children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Most Viewed Category"}),e.jsx(s,{variant:"h6",fontWeight:"bold",children:w.length>0?w.reduce((c,x)=>c.views>x.views?c:x).name:"N/A"})]})}),e.jsx(d,{size:{xs:12,md:4},children:e.jsxs(o,{sx:{p:2,bgcolor:"white",borderRadius:1},children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Urgent Notices"}),e.jsxs(s,{variant:"h6",fontWeight:"bold",color:"error",children:[r.urgentNotices," Active"]})]})})]})]})})]})};var M=(l=>(l.GENERAL="GENERAL",l.URGENT="URGENT",l.EVENT="EVENT",l.SCHEDULED="SCHEDULED",l))(M||{}),V=(l=>(l.LOW="LOW",l.NORMAL="NORMAL",l.HIGH="HIGH",l.URGENT="URGENT",l))(V||{});const sa=({open:l,onClose:r,notice:a})=>{var E,_,w,G,T,c,x;if(!a)return null;const f=g=>{switch(g){case V.URGENT:return"error";case V.HIGH:return"warning";case V.NORMAL:return"info";default:return"default"}},m=g=>{switch(g){case M.URGENT:return"error";case M.EVENT:return"success";case M.SCHEDULED:return"warning";default:return"primary"}},$=g=>new Date(g).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return e.jsxs(de,{open:l,onClose:r,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:3,maxHeight:"90vh",animation:`${K} ${h.normal.duration} ${h.smooth.timing}`,animationFillMode:"both"}},children:[e.jsxs(ce,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:2},children:[e.jsx(o,{component:"span",sx:{fontWeight:"bold",fontSize:"1.5rem"},children:"Notice Details"}),e.jsx(q,{onClick:r,size:"small",children:e.jsx(_e,{})})]}),e.jsx(xe,{dividers:!0,children:e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:3},children:[a.imageUrl&&e.jsx(z,{sx:{borderRadius:2,overflow:"hidden"},children:e.jsx(Ae,{component:"img",image:a.imageUrl,alt:a.title,sx:{width:"100%",maxHeight:400,objectFit:"cover"},onError:g=>{g.currentTarget.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Crect fill="%23f0f0f0" width="400" height="300"/%3E%3Ctext fill="%23999" x="50%25" y="50%25" text-anchor="middle" dy=".3em"%3EImage not available%3C/text%3E%3C/svg%3E'}})}),e.jsxs(o,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:[e.jsx(W,{label:a.type,color:m(a.type),size:"small"}),e.jsx(W,{label:a.priority,color:f(a.priority),size:"small"}),a.category&&e.jsx(W,{label:a.category.name,size:"small",sx:{bgcolor:a.category.color,color:"white"}}),e.jsx(W,{label:a.isActive?"Active":"Inactive",color:a.isActive?"success":"default",size:"small"})]}),e.jsxs(o,{children:[e.jsx(s,{variant:"h5",fontWeight:"bold",gutterBottom:!0,children:a.title}),a.titleBn&&e.jsx(s,{variant:"h6",color:"text.secondary",children:a.titleBn})]}),e.jsx(J,{}),e.jsxs(o,{children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Description"}),e.jsx(s,{variant:"body1",paragraph:!0,children:a.description}),a.descriptionBn&&e.jsx(s,{variant:"body1",color:"text.secondary",children:a.descriptionBn})]}),e.jsx(J,{}),e.jsxs(o,{children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Full Content"}),e.jsx(s,{variant:"body1",paragraph:!0,sx:{whiteSpace:"pre-wrap"},children:a.content}),a.contentBn&&e.jsx(s,{variant:"body1",color:"text.secondary",sx:{whiteSpace:"pre-wrap"},children:a.contentBn})]}),e.jsx(J,{}),e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{size:{xs:12,md:6},children:e.jsxs(o,{sx:{p:2,bgcolor:"success.50",borderRadius:2,border:"1px solid",borderColor:"success.200"},children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"Published Date"}),e.jsx(s,{variant:"body1",fontWeight:"600",children:$(a.publishDate)})]})}),a.expiryDate&&e.jsx(d,{size:{xs:12,md:6},children:e.jsxs(o,{sx:{p:2,bgcolor:"warning.50",borderRadius:2,border:"1px solid",borderColor:"warning.200"},children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"Expiry Date"}),e.jsx(s,{variant:"body1",fontWeight:"600",children:$(a.expiryDate)})]})})]}),e.jsx(J,{}),e.jsxs(o,{children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Engagement Statistics"}),e.jsxs(d,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(d,{size:{xs:6,md:3},children:e.jsxs(o,{sx:{p:2,bgcolor:"info.50",borderRadius:2,textAlign:"center"},children:[e.jsx(Ce,{color:"info",sx:{mb:1}}),e.jsx(s,{variant:"h6",fontWeight:"bold",children:a.viewCount}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"Views"})]})}),e.jsx(d,{size:{xs:6,md:3},children:e.jsxs(o,{sx:{p:2,bgcolor:"success.50",borderRadius:2,textAlign:"center"},children:[e.jsx(ke,{color:"success",sx:{mb:1}}),e.jsx(s,{variant:"h6",fontWeight:"bold",children:a.readCount}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"Reads"})]})}),e.jsx(d,{size:{xs:6,md:3},children:e.jsxs(o,{sx:{p:2,bgcolor:"primary.50",borderRadius:2,textAlign:"center"},children:[e.jsx(It,{color:"primary",sx:{mb:1}}),e.jsx(s,{variant:"h6",fontWeight:"bold",children:((_=(E=a.interactions)==null?void 0:E.counts)==null?void 0:_.LIKE)||0}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"Likes"})]})}),e.jsx(d,{size:{xs:6,md:3},children:e.jsxs(o,{sx:{p:2,bgcolor:"error.50",borderRadius:2,textAlign:"center"},children:[e.jsx(St,{color:"error",sx:{mb:1}}),e.jsx(s,{variant:"h6",fontWeight:"bold",children:((G=(w=a.interactions)==null?void 0:w.counts)==null?void 0:G.LOVE)||0}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"Loves"})]})})]})]}),(((T=a.targetCities)==null?void 0:T.length)>0||((c=a.targetZones)==null?void 0:c.length)>0||((x=a.targetWards)==null?void 0:x.length)>0)&&e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsxs(o,{children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Geographical Targeting"}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:1,mt:1},children:[a.targetCities&&a.targetCities.length>0&&e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Dt,{fontSize:"small",color:"action"}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Cities:"})," ",a.targetCities.length," selected"]})]}),a.targetZones&&a.targetZones.length>0&&e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Nt,{fontSize:"small",color:"action"}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Zones:"})," ",a.targetZones.length," selected"]})]}),a.targetWards&&a.targetWards.length>0&&e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(At,{fontSize:"small",color:"action"}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Wards:"})," ",a.targetWards.length," selected"]})]})]})]})]}),a.creator&&e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsxs(o,{children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Created By"}),e.jsxs(s,{variant:"body1",children:[a.creator.firstName," ",a.creator.lastName]}),e.jsx(s,{variant:"body2",color:"text.secondary",children:a.creator.email}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:["Created: ",$(a.createdAt)]})]})]})]})}),e.jsx(he,{sx:{p:2},children:e.jsx(N,{onClick:r,variant:"contained",children:"Close"})})]})};function Pe(l){const{children:r,value:a,index:f,...m}=l;return e.jsx("div",{role:"tabpanel",hidden:a!==f,...m,children:a===f&&e.jsx(o,{sx:{p:{xs:2,md:3},animation:`${H} ${h.normal.duration} ${h.smooth.timing}`,animationFillMode:"both"},children:r})})}const ra=({notice:l,index:r,onView:a,onEdit:f,onToggleStatus:m,onDelete:$,getTypeColor:E,getPriorityColor:_})=>{const{attributes:w,listeners:G,setNodeRef:T,transform:c,transition:x,isDragging:g}=Pt({id:l.id}),Y={transform:kt.Transform.toString(c),transition:x,zIndex:g?1:0,opacity:g?.5:1};return e.jsx(d,{size:{xs:12},ref:T,style:Y,children:e.jsx(z,{sx:{borderRadius:3,border:"1px solid",borderColor:"divider",boxShadow:g?"0 12px 26px rgba(15, 23, 42, 0.2)":"0 6px 18px rgba(15, 23, 42, 0.06)",transition:"transform 0.2s ease, box-shadow 0.2s ease",position:"relative",bgcolor:"background.paper"},children:e.jsx(B,{children:e.jsxs(o,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},justifyContent:"space-between",gap:2},children:[e.jsx(o,{sx:{display:"flex",alignItems:"center",mr:1,cursor:"grab",color:"text.secondary","&:hover":{color:"primary.main"}},...w,...G,children:e.jsx(Wt,{})}),e.jsxs(o,{sx:{flex:1,display:"flex",gap:2},children:[l.imageUrl&&e.jsx(o,{sx:{flexShrink:0},children:e.jsx(z,{sx:{width:120,height:120},children:e.jsx(Ae,{component:"img",height:"120",image:l.imageUrl,alt:l.title,sx:{objectFit:"cover"},onError:j=>{j.currentTarget.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="120" height="120"%3E%3Crect fill="%23f0f0f0" width="120" height="120"/%3E%3Ctext fill="%23999" x="50%25" y="50%25" text-anchor="middle" dy=".3em"%3ENo Image%3C/text%3E%3C/svg%3E'}})})}),e.jsxs(o,{sx:{flex:1},children:[e.jsxs(o,{sx:{display:"flex",flexWrap:"wrap",gap:1,mb:1},children:[e.jsx(W,{label:l.type,color:E(l.type),size:"small"}),e.jsx(W,{label:l.priority,color:_(l.priority),size:"small"}),l.category&&e.jsx(W,{label:l.category.name,size:"small",sx:{bgcolor:l.category.color,color:"white"}}),e.jsx(W,{label:l.isActive?"Active":"Inactive",color:l.isActive?"success":"default",size:"small"})]}),e.jsx(s,{variant:"h6",fontWeight:"bold",children:l.title}),l.titleBn&&e.jsx(s,{variant:"body2",color:"text.secondary",children:l.titleBn}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{mt:1},children:l.description}),e.jsxs(o,{sx:{display:"flex",flexWrap:"wrap",gap:1.5,mt:2},children:[e.jsx(W,{label:`Views: ${l.viewCount}`,size:"small",variant:"outlined"}),e.jsx(W,{label:`Reads: ${l.readCount}`,size:"small",variant:"outlined"}),e.jsx(W,{label:`Published: ${new Date(l.publishDate).toLocaleDateString()}`,size:"small",variant:"outlined"})]})]})]}),e.jsxs(o,{sx:{display:"flex",gap:1,justifyContent:{xs:"flex-start",md:"flex-end"},alignItems:"flex-start"},children:[e.jsx(q,{color:"info",onClick:()=>a(l),title:"View Details",children:e.jsx(Ce,{})}),e.jsx(q,{color:"primary",onClick:()=>f(l),title:"Edit",children:e.jsx(qe,{})}),e.jsx(q,{color:l.isActive?"warning":"success",onClick:()=>m(l),title:l.isActive?"Deactivate":"Activate",children:l.isActive?e.jsx($t,{}):e.jsx(Ce,{})}),e.jsx(q,{color:"error",onClick:()=>$(l),title:"Delete",children:e.jsx(Ye,{})})]})]})})})})},xa=()=>{const[l,r]=u.useState(0),[a,f]=u.useState([]),[m,$]=u.useState([]),[E,_]=u.useState([]),[w,G]=u.useState([]),[T,c]=u.useState([]),[x,g]=u.useState(!1),[Y,j]=u.useState(null),[ze,O]=u.useState(null),[P,ue]=u.useState({}),[Xe,Je]=u.useState(""),[Qe,Q]=u.useState(!1),[et,X]=u.useState(!1),[tt,me]=u.useState(!1),[at,pe]=u.useState(!1),[st,We]=u.useState(!1),[Z,ee]=u.useState(null),[D,ne]=u.useState(null),[je,$e]=u.useState(!1),[U,te]=u.useState(null),[ae,ye]=u.useState(null),[S,we]=u.useState(!1),rt=Et(Te(Ot),Te(Mt,{coordinateGetter:Bt})),it=async t=>{const{active:i,over:y}=t;if(!y||i.id===y.id)return;const A=a.findIndex(I=>I.id===i.id),ie=a.findIndex(I=>I.id===y.id);if(A===-1||ie===-1)return;const fe=Lt(a,A,ie);f(fe);try{const I=fe.map((le,vt)=>({id:le.id,displayOrder:vt}));await F.reorderNotices(I)}catch(I){console.error("Failed to reorder notices:",I),j("Failed to update notice order"),re()}},[k,se]=u.useState({name:"",nameBn:"",color:"#3FA564",icon:"ðŸ“¢"}),[n,C]=u.useState({title:"",titleBn:"",description:"",descriptionBn:"",content:"",contentBn:"",categoryId:"",type:M.GENERAL,priority:V.NORMAL,publishDate:new Date().toISOString().split("T")[0],expiryDate:"",imageUrl:"",targetCities:[],targetZones:[],targetWards:[]});u.useEffect(()=>{re(),be(),nt()},[P]);const nt=async()=>{try{we(!0);const i=(await Vt.getCityCorporations("ACTIVE")).cityCorporations||[];_(i);const A=(await Promise.all(i.map(I=>Gt.getZones({cityCorporationId:I.id,status:"ACTIVE"}).catch(le=>(console.error(`Error fetching zones for city ${I.id}:`,le),{zones:[]}))))).flatMap(I=>I.zones||[]);G(A);const fe=(await Promise.all(A.map(I=>Zt.getWards({zoneId:I.id,status:"ACTIVE"}).catch(le=>(console.error(`Error fetching wards for zone ${I.id}:`,le),{wards:[]}))))).flatMap(I=>I.wards||[]);c(fe),we(!1)}catch(t){console.error("Failed to load location data:",t),we(!1)}},re=async()=>{try{g(!0),j(null);const t=await F.getAllNotices(P);console.log("ðŸ”µ Loaded notices:",{count:t.notices.length,noticesWithImages:t.notices.filter(i=>i.imageUrl).length,sampleNotice:t.notices[0]?{id:t.notices[0].id,title:t.notices[0].title,imageUrl:t.notices[0].imageUrl||"NO IMAGE"}:"No notices"}),f(t.notices)}catch(t){console.error("âŒ Failed to load notices:",t),j(t.message||"Failed to load notices")}finally{g(!1)}},be=async()=>{try{const t=await F.getAllCategories();$(Array.isArray(t)?t:[])}catch(t){console.error("Failed to load categories:",t)}},ot=async()=>{try{g(!0),j(null),await F.createCategory(k),O("Category created successfully!"),X(!1),oe(),be()}catch(t){j(t.message||"Failed to create category")}finally{g(!1)}},lt=async()=>{if(D)try{g(!0),j(null),await F.updateCategory(D.id,k),O("Category updated successfully!"),X(!1),oe(),be()}catch(t){j(t.message||"Failed to update category")}finally{g(!1)}},dt=async()=>{if(D)try{g(!0),await F.deleteCategory(D.id),O("Category deleted successfully!"),pe(!1),ne(null),be()}catch(t){j(t.message||"Failed to delete category")}finally{g(!1)}},oe=()=>{se({name:"",nameBn:"",color:"#3FA564",icon:"ðŸ“¢"}),ne(null)},ct=t=>{ne(t),se({name:t.name,nameBn:t.nameBn||"",color:t.color||"#3FA564",icon:t.icon||"ðŸ“¢"}),X(!0)},xt=async()=>{try{if(g(!0),j(null),!n.categoryId){j("Please select a category");return}const t={...n,categoryId:Number(n.categoryId),publishDate:n.publishDate?new Date(n.publishDate).toISOString():new Date().toISOString(),expiryDate:n.expiryDate?new Date(n.expiryDate).toISOString():void 0,targetCities:Array.isArray(n.targetCities)?n.targetCities.map(i=>Number(i)):[],targetZones:Array.isArray(n.targetZones)?n.targetZones.map(i=>Number(i)):[],targetWards:Array.isArray(n.targetWards)?n.targetWards.map(i=>Number(i)):[]};console.log("ðŸ”µ Creating notice with data:",{...t,imageUrl:t.imageUrl||"NO IMAGE URL"}),await F.createNotice(t),console.log("âœ… Notice created successfully"),O("Notice created successfully!"),Q(!1),Ie(),re()}catch(t){console.error("âŒ Failed to create notice:",t),j(t.message||"Failed to create notice")}finally{g(!1)}},ht=async()=>{if(Z)try{if(g(!0),j(null),!n.categoryId){j("Please select a category");return}const t={...n,categoryId:Number(n.categoryId),publishDate:n.publishDate?new Date(n.publishDate).toISOString():new Date().toISOString(),expiryDate:n.expiryDate?new Date(n.expiryDate).toISOString():void 0,targetCities:Array.isArray(n.targetCities)?n.targetCities.map(i=>Number(i)):[],targetZones:Array.isArray(n.targetZones)?n.targetZones.map(i=>Number(i)):[],targetWards:Array.isArray(n.targetWards)?n.targetWards.map(i=>Number(i)):[]};console.log("ðŸ”µ Updating notice with data:",{noticeId:Z.id,...t,imageUrl:t.imageUrl||"NO IMAGE URL"}),await F.updateNotice(Z.id,t),console.log("âœ… Notice updated successfully"),O("Notice updated successfully!"),Q(!1),Ie(),re()}catch(t){console.error("âŒ Failed to update notice:",t),j(t.message||"Failed to update notice")}finally{g(!1)}},gt=async t=>{try{await F.toggleNoticeStatus(t.id),O(`Notice ${t.isActive?"deactivated":"activated"} successfully!`),re()}catch(i){j(i.message||"Failed to toggle notice status")}},ut=async()=>{if(Z)try{g(!0),await F.deleteNotice(Z.id),O("Notice deleted successfully!"),me(!1),ee(null),re()}catch(t){j(t.message||"Failed to delete notice")}finally{g(!1)}},Ie=()=>{C({title:"",titleBn:"",description:"",descriptionBn:"",content:"",contentBn:"",categoryId:"",type:M.GENERAL,priority:V.NORMAL,publishDate:new Date().toISOString().split("T")[0],expiryDate:"",imageUrl:"",targetCities:[],targetZones:[],targetWards:[]}),ee(null),ye(null),U&&!U.startsWith("http")&&URL.revokeObjectURL(U),te(null)},mt=t=>{var A;const i=(A=t.target.files)==null?void 0:A[0];if(!i)return;if(!i.type.startsWith("image/")){j("Please select a valid image file");return}if(i.size>5*1024*1024){j("Image size should be less than 5MB");return}ye(i),U&&!U.startsWith("http")&&URL.revokeObjectURL(U);const y=URL.createObjectURL(i);te(y)},pt=async()=>{if(ae)try{$e(!0),j(null),console.log("ðŸ”µ Starting image upload...",{fileName:ae.name,fileSize:ae.size,fileType:ae.type});const t=await F.uploadImage(ae);console.log("âœ… Image uploaded successfully:",t),C({...n,imageUrl:t}),console.log("âœ… Form updated with imageUrl:",t),te(t),ye(null),O("Image uploaded successfully!"),setTimeout(()=>O(null),3e3)}catch(t){console.error("âŒ Image upload failed:",t),j(t.message||"Failed to upload image"),te(null)}finally{$e(!1)}},jt=()=>{ye(null),U&&!U.startsWith("http")&&URL.revokeObjectURL(U),te(null),C({...n,imageUrl:""})},yt=t=>{ee(t),C({title:t.title,titleBn:t.titleBn||"",description:t.description,descriptionBn:t.descriptionBn||"",content:t.content,contentBn:t.contentBn||"",categoryId:t.categoryId,type:t.type,priority:t.priority,publishDate:t.publishDate.split("T")[0],expiryDate:t.expiryDate?t.expiryDate.split("T")[0]:"",imageUrl:t.imageUrl||"",targetCities:t.targetCities||[],targetZones:t.targetZones||[],targetWards:t.targetWards||[]}),te(t.imageUrl||null),Q(!0)},bt=t=>{switch(t){case V.URGENT:return"error";case V.HIGH:return"warning";case V.NORMAL:return"info";default:return"default"}},ft=t=>{switch(t){case M.URGENT:return"error";case M.EVENT:return"success";case M.SCHEDULED:return"warning";default:return"primary"}};return e.jsx(Ht,{title:"Notice Board Management",children:e.jsxs(o,{sx:{p:{xs:2,md:3}},children:[e.jsx(Ne,{sx:{p:{xs:2,md:3},mb:3,borderRadius:3,background:"linear-gradient(135deg, #0f766e 0%, #22c55e 100%)",color:"white",animation:`${H} ${h.normal.duration} ${h.smooth.timing}`,animationFillMode:"both"},children:e.jsxs(o,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},alignItems:{xs:"flex-start",md:"center"},justifyContent:"space-between",gap:2},children:[e.jsxs(o,{children:[e.jsx(s,{variant:"h4",fontWeight:"bold",sx:{mb:.5},children:"Notice Board Management"}),e.jsx(s,{variant:"body2",sx:{opacity:.9},children:"Create, manage, and analyze public notices with better clarity"})]}),e.jsxs(o,{sx:{display:"flex",gap:1.5,flexWrap:"wrap",width:{xs:"100%",md:"auto"}},children:[e.jsx(N,{variant:"outlined",startIcon:e.jsx(Ve,{}),onClick:()=>X(!0),sx:{borderColor:"rgba(255,255,255,0.7)",color:"white",width:{xs:"100%",sm:"auto"},"&:hover":{borderColor:"white",bgcolor:"rgba(255,255,255,0.1)"},...Le},children:"Manage Categories"}),e.jsx(N,{variant:"contained",startIcon:e.jsx(Ee,{}),onClick:()=>{Ie(),Q(!0)},sx:{bgcolor:"white",color:"#0f766e",width:{xs:"100%",sm:"auto"},"&:hover":{bgcolor:"#f0fdf4"},...Le},children:"Create Notice"})]})]})}),e.jsx(o,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:e.jsxs(zt,{value:l,onChange:(t,i)=>r(i),sx:{"& .MuiTab-root":{textTransform:"none",fontWeight:600},"& .MuiTabs-indicator":{height:3,borderRadius:2}},children:[e.jsx(Re,{label:"Notices"}),e.jsx(Re,{label:"Analytics"})]})}),e.jsxs(Pe,{value:l,index:0,children:[Y&&e.jsx(ve,{severity:"error",onClose:()=>j(null),sx:{mb:2},children:Y}),ze&&e.jsx(ve,{severity:"success",onClose:()=>O(null),sx:{mb:2},children:ze}),e.jsx(z,{sx:{mb:3,borderRadius:3,boxShadow:"0 4px 18px rgba(0,0,0,0.06)",border:"1px solid",borderColor:"divider",animation:`${H} ${h.normal.duration} ${h.smooth.timing}`,animationFillMode:"both",animationDelay:"40ms"},children:e.jsx(B,{children:e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{size:{xs:12,md:4},children:e.jsx(b,{fullWidth:!0,label:"Search",value:Xe,onChange:t=>{Je(t.target.value),ue({...P,search:t.target.value})},placeholder:"Search by title or description"})}),e.jsx(d,{size:{xs:12,md:3},children:e.jsxs(b,{fullWidth:!0,select:!0,label:"Category",value:P.categoryId||"",onChange:t=>ue({...P,categoryId:Number(t.target.value)||void 0}),children:[e.jsx(L,{value:"",children:"All Categories"}),m.map(t=>e.jsx(L,{value:t.id,children:t.name},t.id))]})}),e.jsx(d,{size:{xs:12,md:2},children:e.jsxs(b,{fullWidth:!0,select:!0,label:"Type",value:P.type||"",onChange:t=>ue({...P,type:t.target.value||void 0}),children:[e.jsx(L,{value:"",children:"All Types"}),Object.values(M).map(t=>e.jsx(L,{value:t,children:t},t))]})}),e.jsx(d,{size:{xs:12,md:3},children:e.jsxs(b,{fullWidth:!0,select:!0,label:"Status",value:P.isActive===void 0?"":P.isActive.toString(),onChange:t=>ue({...P,isActive:t.target.value===""?void 0:t.target.value==="true"}),children:[e.jsx(L,{value:"",children:"All Status"}),e.jsx(L,{value:"true",children:"Active"}),e.jsx(L,{value:"false",children:"Inactive"})]})})]})})}),x?e.jsx(o,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(R,{})}):e.jsx(Rt,{sensors:rt,collisionDetection:Ft,onDragEnd:it,children:e.jsx(Tt,{items:a.map(t=>t.id),strategy:Ut,children:e.jsxs(d,{container:!0,spacing:2,children:[a.map((t,i)=>e.jsx(ra,{notice:t,index:i,onView:y=>{ee(y),We(!0)},onEdit:yt,onToggleStatus:gt,onDelete:y=>{ee(y),me(!0)},getTypeColor:ft,getPriorityColor:bt},t.id)),!x&&a.length===0&&e.jsx(d,{size:{xs:12},children:e.jsx(z,{sx:{borderRadius:3,border:"1px dashed",borderColor:"divider",animation:`${H} ${h.normal.duration} ${h.smooth.timing}`,animationFillMode:"both"},children:e.jsx(B,{children:e.jsx(s,{color:"text.secondary",align:"center",children:"No notices found. Create a new notice to get started."})})})})]})})})]}),e.jsx(Pe,{value:l,index:1,children:e.jsx(aa,{categories:m})}),e.jsxs(de,{open:Qe,onClose:()=>Q(!1),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:3,animation:`${K} ${h.normal.duration} ${h.smooth.timing}`,animationFillMode:"both"}},children:[e.jsx(ce,{children:Z?"Edit Notice":"Create New Notice"}),e.jsx(xe,{children:e.jsxs(d,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(d,{size:{xs:12,md:6},children:e.jsx(b,{fullWidth:!0,label:"Title (English)",value:n.title,onChange:t=>C({...n,title:t.target.value}),required:!0})}),e.jsx(d,{size:{xs:12,md:6},children:e.jsx(b,{fullWidth:!0,label:"Title (Bangla)",value:n.titleBn,onChange:t=>C({...n,titleBn:t.target.value})})}),e.jsx(d,{size:{xs:12,md:6},children:e.jsx(b,{fullWidth:!0,label:"Description (English)",value:n.description,onChange:t=>C({...n,description:t.target.value}),multiline:!0,rows:2,required:!0})}),e.jsx(d,{size:{xs:12,md:6},children:e.jsx(b,{fullWidth:!0,label:"Description (Bangla)",value:n.descriptionBn,onChange:t=>C({...n,descriptionBn:t.target.value}),multiline:!0,rows:2})}),e.jsx(d,{size:{xs:12,md:6},children:e.jsx(b,{fullWidth:!0,label:"Content (English)",value:n.content,onChange:t=>C({...n,content:t.target.value}),multiline:!0,rows:4,required:!0})}),e.jsx(d,{size:{xs:12,md:6},children:e.jsx(b,{fullWidth:!0,label:"Content (Bangla)",value:n.contentBn,onChange:t=>C({...n,contentBn:t.target.value}),multiline:!0,rows:4})}),e.jsx(d,{size:{xs:12,md:4},children:e.jsxs(b,{fullWidth:!0,select:!0,label:"Category",value:n.categoryId||"",onChange:t=>C({...n,categoryId:Number(t.target.value)}),required:!0,children:[e.jsx(L,{value:"",children:"Select Category"}),m.map(t=>e.jsx(L,{value:t.id,children:t.name},t.id))]})}),e.jsx(d,{size:{xs:12,md:4},children:e.jsx(b,{fullWidth:!0,select:!0,label:"Type",value:n.type,onChange:t=>C({...n,type:t.target.value}),children:Object.values(M).map(t=>e.jsx(L,{value:t,children:t},t))})}),e.jsx(d,{size:{xs:12,md:4},children:e.jsx(b,{fullWidth:!0,select:!0,label:"Priority",value:n.priority,onChange:t=>C({...n,priority:t.target.value}),children:Object.values(V).map(t=>e.jsx(L,{value:t,children:t},t))})}),e.jsx(d,{size:{xs:12,md:6},children:e.jsx(b,{fullWidth:!0,type:"date",label:"Publish Date",value:n.publishDate,onChange:t=>C({...n,publishDate:t.target.value}),InputLabelProps:{shrink:!0}})}),e.jsx(d,{size:{xs:12,md:6},children:e.jsx(b,{fullWidth:!0,type:"date",label:"Expiry Date (Optional)",value:n.expiryDate,onChange:t=>C({...n,expiryDate:t.target.value}),InputLabelProps:{shrink:!0}})}),e.jsx(d,{size:{xs:12},children:e.jsxs(o,{children:[e.jsx(s,{variant:"subtitle2",sx:{mb:1},children:"Notice Image (Optional)"}),e.jsxs(o,{sx:{display:"flex",gap:2,alignItems:"flex-start",flexWrap:"wrap"},children:[e.jsxs(N,{variant:"outlined",component:"label",startIcon:e.jsx(Fe,{}),disabled:je,sx:{minWidth:150},children:["Select Image",e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:mt})]}),ae&&e.jsx(N,{variant:"contained",onClick:pt,disabled:je,startIcon:je?e.jsx(R,{size:20}):e.jsx(Fe,{}),sx:{minWidth:150},children:je?"Uploading...":"Upload"}),(U||n.imageUrl)&&e.jsx(o,{sx:{position:"relative",flex:1,minWidth:250},children:e.jsxs(z,{sx:{maxWidth:300},children:[e.jsx(Ae,{component:"img",height:"150",image:U||n.imageUrl,alt:"Notice preview",sx:{objectFit:"cover"}}),e.jsx(q,{size:"small",onClick:jt,sx:{position:"absolute",top:8,right:8,bgcolor:"rgba(0,0,0,0.6)",color:"white","&:hover":{bgcolor:"rgba(0,0,0,0.8)"}},children:e.jsx(_e,{fontSize:"small"})})]})})]}),e.jsx(s,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:"Supported formats: JPG, PNG, GIF (Max 5MB)"})]})}),e.jsxs(d,{size:{xs:12},children:[e.jsx(J,{sx:{my:2},children:e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Geographical Targeting (Optional)"})}),S&&e.jsxs(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",my:2},children:[e.jsx(R,{size:24}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{ml:2},children:"Loading locations..."})]})]}),e.jsx(d,{size:{xs:12,md:4},children:e.jsx(Se,{multiple:!0,options:E,loading:S,getOptionLabel:t=>t.name||t.code,value:E.filter(t=>n.targetCities.includes(t.id)),onChange:(t,i)=>C({...n,targetCities:i.map(y=>y.id)}),disabled:S,renderInput:t=>e.jsx(b,{...t,label:"Target Cities",placeholder:S?"Loading cities...":E.length===0?"No cities available":"Select Cities",helperText:S?"Loading...":`${E.length} cities available`,InputProps:{...t.InputProps,endAdornment:e.jsxs(e.Fragment,{children:[S?e.jsx(R,{size:20}):null,t.InputProps.endAdornment]})}}),renderOption:(t,i)=>{const{key:y,...A}=t;return e.jsx("li",{...A,children:e.jsxs(o,{children:[e.jsx(s,{variant:"body2",children:i.name}),e.jsx(s,{variant:"caption",color:"text.secondary",children:i.code})]})},`city-${i.id}`)}})}),e.jsx(d,{size:{xs:12,md:4},children:e.jsx(Se,{multiple:!0,options:w,loading:S,getOptionLabel:t=>{var i;return`${(i=t.cityCorporation)!=null&&i.name?`${t.cityCorporation.name} - `:""}Zone ${t.zoneNumber??t.number??""}`},value:w.filter(t=>n.targetZones.includes(t.id)),onChange:(t,i)=>C({...n,targetZones:i.map(y=>y.id)}),disabled:S,renderInput:t=>e.jsx(b,{...t,label:"Target Zones",placeholder:S?"Loading zones...":w.length===0?"No zones available":"Select Zones",helperText:S?"Loading...":`${w.length} zones available`,InputProps:{...t.InputProps,endAdornment:e.jsxs(e.Fragment,{children:[S?e.jsx(R,{size:20}):null,t.InputProps.endAdornment]})}}),renderOption:(t,i)=>{const{key:y,...A}=t;return e.jsx("li",{...A,children:e.jsxs(o,{children:[e.jsxs(s,{variant:"body2",children:["Zone ",i.zoneNumber??i.number]}),i.cityCorporation&&e.jsx(s,{variant:"caption",color:"text.secondary",children:i.cityCorporation.name})]})},`zone-${i.id}`)}})}),e.jsx(d,{size:{xs:12,md:4},children:e.jsx(Se,{multiple:!0,options:T,loading:S,getOptionLabel:t=>{var i,y;return`${(y=(i=t.zone)==null?void 0:i.cityCorporation)!=null&&y.name?`${t.zone.cityCorporation.name} - `:""}Ward ${t.wardNumber??t.number??""}`},value:T.filter(t=>n.targetWards.includes(t.id)),onChange:(t,i)=>C({...n,targetWards:i.map(y=>y.id)}),disabled:S,renderInput:t=>e.jsx(b,{...t,label:"Target Wards",placeholder:S?"Loading wards...":T.length===0?"No wards available":"Select Wards",helperText:S?"Loading...":`${T.length} wards available`,InputProps:{...t.InputProps,endAdornment:e.jsxs(e.Fragment,{children:[S?e.jsx(R,{size:20}):null,t.InputProps.endAdornment]})}}),renderOption:(t,i)=>{var ie;const{key:y,...A}=t;return e.jsx("li",{...A,children:e.jsxs(o,{children:[e.jsxs(s,{variant:"body2",children:["Ward ",i.wardNumber??i.number]}),((ie=i.zone)==null?void 0:ie.cityCorporation)&&e.jsxs(s,{variant:"caption",color:"text.secondary",children:[i.zone.cityCorporation.name," - Zone ",i.zone.zoneNumber]})]})},`ward-${i.id}`)}})})]})}),e.jsxs(he,{children:[e.jsx(N,{onClick:()=>Q(!1),children:"Cancel"}),e.jsx(N,{variant:"contained",onClick:Z?ht:xt,disabled:x,children:x?e.jsx(R,{size:24}):Z?"Update":"Create"})]})]}),e.jsxs(de,{open:tt,onClose:()=>me(!1),PaperProps:{sx:{borderRadius:3,animation:`${K} ${h.normal.duration} ${h.smooth.timing}`,animationFillMode:"both"}},children:[e.jsx(ce,{children:"Confirm Delete"}),e.jsx(xe,{children:e.jsx(s,{children:"Are you sure you want to delete this notice? This action cannot be undone."})}),e.jsxs(he,{children:[e.jsx(N,{onClick:()=>me(!1),children:"Cancel"}),e.jsx(N,{variant:"contained",color:"error",onClick:ut,disabled:x,children:x?e.jsx(R,{size:24}):"Delete"})]})]}),e.jsxs(de,{open:et,onClose:()=>{X(!1),oe()},maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:3,animation:`${K} ${h.normal.duration} ${h.smooth.timing}`,animationFillMode:"both"}},children:[e.jsx(ce,{children:D&&D.id?"Edit Category":"Manage Categories"}),e.jsx(xe,{children:!D||!D.id?e.jsxs(e.Fragment,{children:[e.jsx(o,{sx:{mb:3,mt:2,display:"flex",justifyContent:"flex-end"},children:e.jsx(N,{variant:"contained",startIcon:e.jsx(Ee,{}),onClick:()=>{oe(),ne({id:0})},children:"Add Category"})}),e.jsx(Ge,{component:Ne,children:e.jsxs(Ze,{children:[e.jsx(He,{children:e.jsxs(ge,{children:[e.jsx(p,{children:"Icon"}),e.jsx(p,{children:"Name"}),e.jsx(p,{children:"Name (Bangla)"}),e.jsx(p,{children:"Description"}),e.jsx(p,{children:"Color"}),e.jsx(p,{align:"right",children:"Actions"})]})}),e.jsx(Ke,{children:m.map(t=>e.jsxs(ge,{children:[e.jsx(p,{children:t.icon}),e.jsx(p,{children:t.name}),e.jsx(p,{children:t.nameBn}),e.jsx(p,{children:e.jsx(o,{sx:{width:30,height:30,bgcolor:t.color,borderRadius:1}})}),e.jsxs(p,{align:"right",children:[e.jsx(q,{color:"primary",onClick:()=>ct(t),size:"small",children:e.jsx(qe,{})}),e.jsx(q,{color:"error",onClick:()=>{ne(t),pe(!0),X(!1)},size:"small",children:e.jsx(Ye,{})})]})]},t.id))})]})})]}):e.jsxs(d,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(d,{size:{xs:12,md:6},children:e.jsx(b,{fullWidth:!0,label:"Name (English)",value:k.name,onChange:t=>se({...k,name:t.target.value}),required:!0})}),e.jsx(d,{size:{xs:12,md:6},children:e.jsx(b,{fullWidth:!0,label:"Name (Bangla)",value:k.nameBn,onChange:t=>se({...k,nameBn:t.target.value})})}),e.jsx(d,{size:{xs:12,md:6},children:e.jsx(b,{fullWidth:!0,label:"Color",type:"color",value:k.color,onChange:t=>se({...k,color:t.target.value})})}),e.jsx(d,{size:{xs:12,md:6},children:e.jsx(b,{fullWidth:!0,label:"Icon (Emoji)",value:k.icon,onChange:t=>se({...k,icon:t.target.value}),placeholder:"ðŸ“¢"})})]})}),e.jsxs(he,{children:[e.jsx(N,{onClick:()=>{X(!1),oe()},children:D&&D.id?"Cancel":"Close"}),D&&D.id!==void 0&&D.id>0&&e.jsx(N,{variant:"contained",onClick:lt,disabled:x,children:x?e.jsx(R,{size:24}):"Update"}),D&&D.id===0&&e.jsx(N,{variant:"contained",onClick:ot,disabled:x,children:x?e.jsx(R,{size:24}):"Create"})]})]}),e.jsxs(de,{open:at,onClose:()=>pe(!1),PaperProps:{sx:{borderRadius:3,animation:`${K} ${h.normal.duration} ${h.smooth.timing}`,animationFillMode:"both"}},children:[e.jsx(ce,{children:"Confirm Delete"}),e.jsx(xe,{children:e.jsx(s,{children:"Are you sure you want to delete this category? This action cannot be undone."})}),e.jsxs(he,{children:[e.jsx(N,{onClick:()=>pe(!1),children:"Cancel"}),e.jsx(N,{variant:"contained",color:"error",onClick:dt,disabled:x,children:x?e.jsx(R,{size:24}):"Delete"})]})]}),e.jsx(sa,{open:st,onClose:()=>{We(!1),ee(null)},notice:Z})]})})};export{xa as default};
