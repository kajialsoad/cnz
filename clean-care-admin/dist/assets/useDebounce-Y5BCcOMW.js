import{e as l,j as e,r as c,F as r,ai as F,T as a,ag as me,Y as ae,l as Te,v as ne,b5 as Ue,ax as He,x as ie,D as $e,y as We,z as I,A as Oe,C as Be,E as Fe,I as g,H as ce,J as Ge,K as le,L as de,av as Ze,X as R,as as Je,at as _e,au as Xe,P as H,b6 as Qe,ak as Ke,aA as Ye,b7 as qe,Q as xe}from"./index-obvkHq0E.js";import{c as P,a as es,H as ss,A as ts,I as os,b as rs,d as as,Z as ns}from"./categoryService-CWluqlj-.js";import{P as is}from"./Person-B5nnbIPf.js";import{D as he}from"./Download-D581y-XL.js";const cs=l(e.jsx("path",{d:"M12 3v9.28c-.47-.17-.97-.28-1.5-.28C8.01 12 6 14.01 6 16.5S8.01 21 10.5 21c2.31 0 4.2-1.75 4.45-4H15V6h4V3z"})),ls=l(e.jsx("path",{d:"M21 5v6.59l-3-3.01-4 4.01-4-4-4 4-3-3.01V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2m-3 6.42 3 3.01V19c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2v-6.58l3 2.99 4-4 4 4z"})),ds=l(e.jsx("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2M6 9h12v2H6zm8 5H6v-2h8zm4-6H6V6h12z"})),xs=l(e.jsx("path",{d:"M18 12.22V9l-5-2.5V5h2V3h-2V1h-2v2H9v2h2v1.5L6 9v3.22L2 14v8h8v-3c0-1.1.9-2 2-2s2 .9 2 2v3h8v-8zm-6 1.28c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5"})),hs=l(e.jsx("path",{d:"M17 12h-5v5h5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1zm3 18H5V8h14z"})),Ds=l(e.jsx("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"})),Rs=l(e.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"})),ms=l(e.jsx("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"})),us=l(e.jsx("path",{d:"m14 6-3.75 5 2.85 3.8-1.6 1.2C9.81 13.75 7 10 7 10l-6 8h22z"})),gs=l(e.jsx("path",{d:"M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4z"})),bs=l(e.jsx("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"})),js=l(e.jsx("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})),ps=l(e.jsx("path",{d:"M6 19h4V5H6zm8-14v14h4V5z"})),fs=l(e.jsx("path",{d:"M8 5v14l11-7z"})),ys=l(e.jsx("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"})),vs=l(e.jsx("path",{d:"M21 10.12h-6.78l2.74-2.82c-2.73-2.7-7.15-2.8-9.88-.1-2.73 2.71-2.73 7.08 0 9.79s7.15 2.71 9.88 0C18.32 15.65 19 14.08 19 12.1h2c0 1.98-.88 4.55-2.64 6.29-3.51 3.48-9.21 3.48-12.72 0-3.5-3.47-3.53-9.11-.02-12.58s9.14-3.47 12.65 0L21 3zM12.5 8v4.25l3.5 2.08-.72 1.21L11 13V8z"})),Cs=l(e.jsx("path",{d:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63m2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71M4.27 3 3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9zM12 4 9.91 6.09 12 8.18z"})),Ss=l(e.jsx("path",{d:"M3 9v6h4l5 5V4L7 9zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02M14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77"})),Is=l(e.jsx("path",{d:"M20 6h-4V4c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2m-6 0h-4V4h4z"})),ks=l(e.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14M7 9h5v1H7z"})),Es=({categoryId:d,subcategoryId:h})=>{const[f,y]=c.useState(""),[v,C]=c.useState(""),[n,V]=c.useState(""),[A,L]=c.useState(""),[s,k]=c.useState("#808080"),[E,w]=c.useState(!0);c.useEffect(()=>{d&&h&&(async()=>{try{w(!0);const[N,T,b,M,D]=await Promise.all([P.getCategoryName(d,"en"),P.getCategoryName(d,"bn"),P.getSubcategoryName(d,h,"en"),P.getSubcategoryName(d,h,"bn"),P.getCategoryColor(d)]);y(N),C(T),V(b),L(M),k(D)}catch(N){console.error("Error fetching category info:",N),y("Unknown Category"),C("অজানা বিভাগ"),V("Unknown Subcategory"),L("অজানা উপবিভাগ")}finally{w(!1)}})()},[d,h]);const z=()=>{const x={sx:{fontSize:40,color:s}};switch(d){case"home":return e.jsx(ms,{...x});case"road_environment":return e.jsx(us,{...x});case"business":return e.jsx(ae,{...x});case"office":return e.jsx(Is,{...x});case"education":return e.jsx(ys,{...x});case"hospital":return e.jsx(gs,{...x});case"religious":return e.jsx(xs,{...x});case"events":return e.jsx(hs,{...x});default:return e.jsx(ae,{...x})}};return E?e.jsxs(r,{sx:{display:"flex",gap:2,alignItems:"center"},children:[e.jsx(F,{variant:"circular",width:40,height:40}),e.jsxs(r,{sx:{flex:1},children:[e.jsx(F,{variant:"text",width:"60%",height:24}),e.jsx(F,{variant:"text",width:"80%",height:20})]})]}):e.jsxs(r,{sx:{display:"flex",gap:2,alignItems:"flex-start",p:2,backgroundColor:"#f8f9fa",borderRadius:2,border:`2px solid ${s}`},children:[e.jsx(r,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:60,height:60,borderRadius:2,backgroundColor:`${s}15`},children:z()}),e.jsxs(r,{sx:{flex:1},children:[e.jsxs(r,{sx:{mb:1},children:[e.jsx(a,{variant:"body1",sx:{fontWeight:600,color:s,mb:.5},children:f}),e.jsx(a,{variant:"body2",sx:{color:"text.secondary",fontStyle:"italic"},children:v})]}),e.jsxs(r,{children:[e.jsx(a,{variant:"body2",sx:{fontWeight:500,mb:.5},children:n}),e.jsx(a,{variant:"caption",sx:{color:"text.secondary",fontStyle:"italic"},children:A})]})]}),e.jsx(me,{label:f,size:"small",sx:{backgroundColor:s,color:"#fff",fontWeight:500,fontSize:"0.75rem",height:24,boxShadow:"0 1px 3px rgba(0,0,0,0.12)"}})]})},Ps=({complaintId:d,open:h,onClose:f,onStatusUpdate:y,onChatOpen:v})=>{var q,ee,se,te,oe,re;const C=Te(),n=ne(C.breakpoints.down("sm")),V=ne(C.breakpoints.down("md")),{canEditComplaints:A,canViewComplaints:L}=Ue(),[s,k]=c.useState(null),[E,w]=c.useState(!1),[z,x]=c.useState(null),[N,T]=c.useState(!1),[b,M]=c.useState(0),[D,S]=c.useState(1),[ue,ge]=c.useState(new Set),[G,$]=c.useState({}),[be,Z]=c.useState({}),[U,je]=c.useState({}),[W,pe]=c.useState({}),j=He.useRef({}),[O,J]=c.useState(!1);c.useEffect(()=>{h&&d&&fe()},[h,d]);const fe=async()=>{if(d)try{w(!0),x(null);const t=await es.getComplaintById(d);k(t)}catch(t){const o=ie(t);x(o.userMessage)}finally{w(!1)}},B=()=>{k(null),x(null),f()},ye=t=>{switch(t){case"PENDING":return{backgroundColor:"#fff3cd",color:"#856404",borderColor:"#ffeeba"};case"IN_PROGRESS":return{backgroundColor:"#d1ecf1",color:"#0c5460",borderColor:"#bee5eb"};case"RESOLVED":return{backgroundColor:"#d4edda",color:"#155724",borderColor:"#c3e6cb"};case"REJECTED":return{backgroundColor:"#f8d7da",color:"#721c24",borderColor:"#f5c6cb"};default:return{backgroundColor:"#f8f9fa",color:"#6c757d"}}},ve=t=>{switch(t){case"PENDING":return"Pending";case"IN_PROGRESS":return"In Progress";case"RESOLVED":return"Solved";case"REJECTED":return"Rejected";default:return t}},_=t=>new Date(t).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),Ce=t=>{M(t),S(1),T(!0)},X=()=>{T(!1),S(1)},Se=()=>{s&&s.imageUrls.length>0&&(M(t=>t===0?s.imageUrls.length-1:t-1),S(1))},Ie=()=>{s&&s.imageUrls.length>0&&(M(t=>t===s.imageUrls.length-1?0:t+1),S(1))},ke=()=>{S(t=>Math.min(t+.25,3))},Ee=()=>{S(t=>Math.max(t-.25,.5))},we=()=>{if(s&&s.imageUrls[b]){const t=document.createElement("a");t.href=s.imageUrls[b],t.download=`complaint-${s.id}-image-${b+1}.jpg`,document.body.appendChild(t),t.click(),document.body.removeChild(t)}},ze=t=>{ge(o=>new Set(o).add(t))},Ne=t=>{const o=j.current[t];o&&(G[t]?(o.pause(),$(i=>({...i,[t]:!1}))):(o.play(),$(i=>({...i,[t]:!0}))))},Me=t=>{const o=j.current[t];if(!o)return;const i=o.currentTime/o.duration*100;Z(m=>({...m,[t]:i}))},De=t=>{$(o=>({...o,[t]:!1})),Z(o=>({...o,[t]:0}))},Q=(t,o)=>{const i=j.current[t];i&&(i.volume=o,je(m=>({...m,[t]:o})))},Re=t=>{const o=j.current[t];if(!o)return;const i=[.5,1,1.5,2],m=W[t]||1,u=i.indexOf(m),p=i[(u+1)%i.length];o.playbackRate=p,pe(Le=>({...Le,[t]:p}))},Pe=(t,o)=>{const i=j.current[t];if(!i)return;const m=o.currentTarget.getBoundingClientRect(),p=(o.clientX-m.left)/m.width;i.currentTime=p*i.duration},Ve=(t,o)=>{const i=document.createElement("a");i.href=t,i.download=`complaint-${s==null?void 0:s.id}-audio-${o+1}.mp3`,document.body.appendChild(i),i.click(),document.body.removeChild(i)},K=t=>{if(isNaN(t))return"0:00";const o=Math.floor(t/60),i=Math.floor(t%60);return`${o}:${i.toString().padStart(2,"0")}`},Ae=async t=>{if(!(!s||!d))try{J(!0),y(d,t),k(o=>o?{...o,status:t}:null),xe.success("Status updated successfully",{icon:"✅",duration:3e3})}catch(o){const i=ie(o);xe.error(i.userMessage,{duration:5e3,icon:"❌"})}finally{J(!1)}},Y=t=>({PENDING:[{status:"IN_PROGRESS",label:"Mark In Progress",color:"#0c5460"},{status:"RESOLVED",label:"Mark Solved",color:"#155724"},{status:"REJECTED",label:"Mark Rejected",color:"#721c24"}],IN_PROGRESS:[{status:"PENDING",label:"Mark Pending",color:"#856404"},{status:"RESOLVED",label:"Mark Solved",color:"#155724"},{status:"REJECTED",label:"Mark Rejected",color:"#721c24"}],RESOLVED:[{status:"PENDING",label:"Mark Pending",color:"#856404"},{status:"IN_PROGRESS",label:"Mark In Progress",color:"#0c5460"},{status:"REJECTED",label:"Mark Rejected",color:"#721c24"}],REJECTED:[{status:"PENDING",label:"Mark Pending",color:"#856404"},{status:"IN_PROGRESS",label:"Mark In Progress",color:"#0c5460"},{status:"RESOLVED",label:"Mark Solved",color:"#155724"}]})[t]||[];return e.jsxs(e.Fragment,{children:[e.jsxs($e,{open:h,onClose:B,maxWidth:"md",fullWidth:!0,fullScreen:n,slotProps:{paper:{sx:{borderRadius:n?0:2,maxHeight:n?"100vh":"90vh",animation:n?`${Oe} ${I.normal.duration} ${I.smooth.timing}`:`${Be} ${I.normal.duration} ${I.smooth.timing}`,animationFillMode:"both"}},backdrop:{sx:{animation:`${We} ${I.fast.duration} ${I.fast.timing}`}}},children:[e.jsxs(Fe,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:2,borderBottom:"1px solid #e0e0e0"},children:[e.jsx(a,{variant:"h6",sx:{fontWeight:600},children:"Complaint Details"}),e.jsx(g,{onClick:B,size:"small",sx:{color:"text.secondary","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"}},children:e.jsx(ce,{})})]}),e.jsxs(Ge,{sx:{pt:{xs:2,sm:3},pb:{xs:1.5,sm:2}},children:[E&&e.jsx(r,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:{xs:200,sm:300}},children:e.jsx(le,{})}),z&&!E&&e.jsx(de,{severity:"error",sx:{mb:2},children:z}),s&&!E&&!z&&e.jsxs(r,{children:[e.jsxs(r,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},mb:{xs:2,sm:3},gap:{xs:1,sm:2}},children:[e.jsx(a,{variant:n?"h6":"h5",sx:{fontWeight:600,color:"#4CAF50"},children:s.trackingNumber||`C${String(s.id).padStart(6,"0")}`}),e.jsx(me,{label:ve(s.status),sx:{...ye(s.status),...Ze,fontWeight:500,fontSize:{xs:"0.75rem",sm:"0.875rem"},height:{xs:28,sm:32}}})]}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsx(a,{variant:n?"caption":"subtitle2",color:"text.secondary",sx:{mb:.5},children:"Complaint Title"}),e.jsx(a,{variant:n?"body2":"body1",sx:{fontWeight:500},children:s.title})]}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsx(a,{variant:n?"caption":"subtitle2",color:"text.secondary",sx:{mb:1},children:"Category"}),s.category&&s.subcategory?e.jsx(Es,{categoryId:s.category,subcategoryId:s.subcategory}):e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1,p:1.5,backgroundColor:"#f5f5f5",border:"1px dashed #bdbdbd",borderRadius:1},children:[e.jsx(ss,{sx:{color:"#757575",fontSize:20}}),e.jsx(a,{variant:"body2",sx:{color:"#757575",fontStyle:"italic"},children:"This complaint has not been categorized yet. It was created before the category system was implemented."})]})]}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsx(a,{variant:n?"caption":"subtitle2",color:"text.secondary",sx:{mb:.5},children:"Description"}),e.jsx(a,{variant:n?"body2":"body1",sx:{whiteSpace:"pre-wrap"},children:s.description})]}),e.jsx(R,{sx:{my:{xs:2,sm:3}}}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:{xs:1,sm:1.5}},children:[e.jsx(Je,{sx:{mr:1,color:"text.secondary",fontSize:{xs:18,sm:20}}}),e.jsx(a,{variant:n?"body1":"subtitle1",sx:{fontWeight:600},children:"Location Information"})]}),e.jsxs(r,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:{xs:1.5,sm:2}},children:[e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"District"}),e.jsx(a,{variant:n?"body2":"body1",children:((q=s.locationDetails)==null?void 0:q.district)||"N/A"})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Thana"}),e.jsx(a,{variant:n?"body2":"body1",children:((ee=s.locationDetails)==null?void 0:ee.thana)||"N/A"})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Ward"}),e.jsx(a,{variant:n?"body2":"body1",children:((se=s.locationDetails)==null?void 0:se.ward)||s.user.ward||"N/A"})]}),e.jsxs(r,{sx:{gridColumn:{xs:"1",sm:"1 / -1"}},children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Full Address"}),e.jsx(a,{variant:n?"body2":"body1",children:((te=s.locationDetails)==null?void 0:te.address)||s.location})]})]})]}),e.jsx(R,{sx:{my:{xs:2,sm:3}}}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:{xs:1,sm:1.5}},children:[e.jsx(is,{sx:{mr:1,color:"text.secondary",fontSize:{xs:18,sm:20}}}),e.jsx(a,{variant:n?"body1":"subtitle1",sx:{fontWeight:600},children:"Citizen Information"})]}),e.jsxs(r,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:{xs:1.5,sm:2}},children:[e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Citizen ID"}),e.jsxs(a,{variant:n?"body2":"body1",children:["U",String(s.user.id).padStart(6,"0")]})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Name"}),e.jsxs(a,{variant:n?"body2":"body1",children:[s.user.firstName," ",s.user.lastName]})]}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(_e,{sx:{fontSize:{xs:16,sm:18},color:"text.secondary"}}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Phone"}),e.jsx(a,{variant:n?"body2":"body1",children:s.user.phone})]})]}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Xe,{sx:{fontSize:{xs:16,sm:18},color:"text.secondary"}}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Email"}),e.jsx(a,{variant:n?"body2":"body1",sx:{wordBreak:"break-word",fontSize:{xs:"0.75rem",sm:"1rem"}},children:s.user.email||"Not provided"})]})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"City Corporation"}),e.jsx(a,{variant:n?"body2":"body1",children:((oe=s.user.cityCorporation)==null?void 0:oe.name)||"N/A"})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Zone"}),e.jsx(a,{variant:n?"body2":"body1",children:s.user.zone?`Zone ${s.user.zone}`:"N/A"})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Ward Number"}),e.jsx(a,{variant:n?"body2":"body1",children:s.user.ward?`Ward ${s.user.ward}`:"N/A"})]}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Thana/Area"}),e.jsx(a,{variant:n?"body2":"body1",children:((re=s.user.thana)==null?void 0:re.name)||"N/A"})]}),s.user.address&&e.jsxs(r,{sx:{gridColumn:{xs:"1",sm:"1 / -1"}},children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Citizen Address"}),e.jsx(a,{variant:n?"body2":"body1",sx:{wordBreak:"break-word"},children:s.user.address})]})]})]}),e.jsx(R,{sx:{my:{xs:2,sm:3}}}),e.jsxs(r,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:{xs:1.5,sm:2}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ts,{sx:{fontSize:{xs:16,sm:18},color:"text.secondary"}}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Submitted"}),e.jsx(a,{variant:n?"body2":"body1",sx:{fontSize:{xs:"0.75rem",sm:"1rem"}},children:_(s.createdAt)})]})]}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(vs,{sx:{fontSize:{xs:16,sm:18},color:"text.secondary"}}),e.jsxs(r,{children:[e.jsx(a,{variant:n?"caption":"body2",color:"text.secondary",children:"Last Updated"}),e.jsx(a,{variant:n?"body2":"body1",sx:{fontSize:{xs:"0.75rem",sm:"1rem"}},children:_(s.updatedAt)})]})]})]}),s.imageUrls&&s.imageUrls.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(R,{sx:{my:{xs:2,sm:3}}}),e.jsxs(r,{sx:{mb:{xs:2,sm:3}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:{xs:1,sm:1.5}},children:[e.jsx(os,{sx:{mr:1,color:"text.secondary",fontSize:{xs:18,sm:20}}}),e.jsxs(a,{variant:n?"body1":"subtitle1",sx:{fontWeight:600},children:["Attached Images (",s.imageUrls.length,")"]})]}),e.jsx(rs,{cols:n?2:V?3:4,gap:n?8:12,sx:{mt:{xs:1,sm:2}},children:s.imageUrls.map((t,o)=>e.jsx(as,{sx:{cursor:"pointer",borderRadius:1,overflow:"hidden",border:"1px solid #e0e0e0","&:hover":{opacity:.8,boxShadow:2}},onClick:()=>Ce(o),children:ue.has(o)?e.jsxs(r,{sx:{width:"100%",height:150,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5"},children:[e.jsx(ls,{sx:{fontSize:40,color:"text.secondary",mb:1}}),e.jsx(a,{variant:"caption",color:"text.secondary",children:"Failed to load"})]}):e.jsx("img",{src:t,alt:`Complaint image ${o+1}`,loading:"lazy",style:{width:"100%",height:150,objectFit:"cover"},onError:()=>ze(o)})},o))})]})]}),s.audioUrls&&s.audioUrls.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(R,{sx:{my:3}}),e.jsxs(r,{sx:{mb:3},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:1.5},children:[e.jsx(cs,{sx:{mr:1,color:"text.secondary"}}),e.jsxs(a,{variant:"subtitle1",sx:{fontWeight:600},children:["Voice Recordings (",s.audioUrls.length,")"]})]}),s.audioUrls.map((t,o)=>{var i,m;return e.jsxs(r,{sx:{border:"1px solid #e0e0e0",borderRadius:2,p:2,mb:2,backgroundColor:"#f8f9fa"},children:[e.jsx("audio",{ref:u=>{j.current[o]=u},src:t,onTimeUpdate:()=>Me(o),onEnded:()=>De(o),onLoadedMetadata:u=>{const p=u.currentTarget;p.volume=U[o]||1,p.playbackRate=W[o]||1},style:{display:"none"}}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(g,{onClick:()=>Ne(o),sx:{backgroundColor:"#4CAF50",color:"white","&:hover":{backgroundColor:"#45a049"}},children:G[o]?e.jsx(ps,{}):e.jsx(fs,{})}),e.jsxs(r,{sx:{flex:1},children:[e.jsx(r,{onClick:u=>Pe(o,u),sx:{height:6,backgroundColor:"#e0e0e0",borderRadius:3,cursor:"pointer",position:"relative","&:hover":{backgroundColor:"#d0d0d0"}},children:e.jsx(r,{sx:{height:"100%",width:`${be[o]||0}%`,backgroundColor:"#4CAF50",borderRadius:3,transition:"width 0.1s linear"}})}),e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",mt:.5},children:[e.jsx(a,{variant:"caption",color:"text.secondary",children:K(((i=j.current[o])==null?void 0:i.currentTime)||0)}),e.jsx(a,{variant:"caption",color:"text.secondary",children:K(((m=j.current[o])==null?void 0:m.duration)||0)})]})]}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(g,{size:"small",onClick:()=>Q(o,U[o]>0?0:1),children:(U[o]||1)>0?e.jsx(Ss,{}):e.jsx(Cs,{})}),e.jsx(r,{sx:{width:60},children:e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:U[o]||1,onChange:u=>Q(o,parseFloat(u.target.value)),style:{width:"100%"}})})]}),e.jsxs(H,{size:"small",variant:"outlined",startIcon:e.jsx(Qe,{}),onClick:()=>Re(o),sx:{minWidth:80,textTransform:"none"},children:[W[o]||1,"x"]}),e.jsx(g,{size:"small",onClick:()=>Ve(t,o),children:e.jsx(he,{})})]}),e.jsxs(a,{variant:"caption",color:"text.secondary",children:["Recording ",o+1]})]},o)})]})]})]})]}),e.jsxs(Ke,{sx:{px:{xs:2,sm:3},py:{xs:1.5,sm:2},borderTop:"1px solid #e0e0e0",gap:{xs:1,sm:1.5},justifyContent:"space-between",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"stretch",sm:"center"}},children:[s&&Y(s.status).length>0&&A()&&e.jsx(r,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:1,alignItems:{xs:"stretch",sm:"center"},width:{xs:"100%",sm:"auto"},flexWrap:"wrap"},children:Y(s.status).map(t=>e.jsx(H,{variant:"contained",onClick:()=>Ae(t.status),disabled:O,startIcon:O?e.jsx(le,{size:16}):e.jsx(Ye,{}),sx:{backgroundColor:t.color,"&:hover":{backgroundColor:t.color,opacity:.9},textTransform:"none",minHeight:{xs:44,sm:"auto"},fontSize:{xs:"0.875rem",sm:"0.875rem"},px:{xs:2,sm:2}},children:O?"Updating...":t.label},t.status))}),s&&!A()&&L()&&e.jsx(de,{severity:"info",sx:{flex:1},children:e.jsx(a,{variant:"body2",children:"ভিউ অনলি মোড - আপনি শুধুমাত্র কমপ্লেইন দেখতে পারবেন, পরিবর্তন করতে পারবেন না।"})}),e.jsxs(r,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:1,width:{xs:"100%",sm:"auto"}},children:[v&&s&&e.jsx(H,{variant:"outlined",startIcon:!n&&e.jsx(ds,{}),onClick:()=>v(s.id),sx:{textTransform:"none",minHeight:{xs:44,sm:"auto"}},children:"Open Chat"}),e.jsx(H,{onClick:B,variant:"outlined",sx:{textTransform:"none",minHeight:{xs:44,sm:"auto"}},children:"Close"})]})]})]}),s&&s.imageUrls&&s.imageUrls.length>0&&e.jsx(qe,{open:N,onClick:X,sx:{zIndex:C.zIndex.modal+1,backgroundColor:"rgba(0, 0, 0, 0.9)"},children:e.jsxs(r,{onClick:t=>t.stopPropagation(),sx:{position:"relative",maxWidth:"90vw",maxHeight:"90vh",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsxs(r,{sx:{position:"absolute",top:-60,right:0,display:"flex",gap:1,zIndex:1},children:[e.jsx(g,{onClick:Ee,disabled:D<=.5,sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:e.jsx(ks,{})}),e.jsx(g,{onClick:ke,disabled:D>=3,sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:e.jsx(ns,{})}),e.jsx(g,{onClick:we,sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:e.jsx(he,{})}),e.jsx(g,{onClick:X,sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:e.jsx(ce,{})})]}),e.jsxs(r,{sx:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",overflow:"auto",maxWidth:"100%",maxHeight:"100%"},children:[s.imageUrls.length>1&&e.jsx(g,{onClick:Se,sx:{position:"absolute",left:-60,color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:e.jsx(bs,{sx:{fontSize:40}})}),e.jsx("img",{src:s.imageUrls[b],alt:`Complaint image ${b+1}`,style:{maxWidth:"100%",maxHeight:"90vh",transform:`scale(${D})`,transition:"transform 0.2s ease-in-out"}}),s.imageUrls.length>1&&e.jsx(g,{onClick:Ie,sx:{position:"absolute",right:-60,color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:e.jsx(js,{sx:{fontSize:40}})})]}),s.imageUrls.length>1&&e.jsx(r,{sx:{position:"absolute",bottom:-50,color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)",px:2,py:1,borderRadius:1},children:e.jsxs(a,{variant:"body2",children:[b+1," / ",s.imageUrls.length]})})]})})]})};function Vs(d,h=500){const[f,y]=c.useState(d);return c.useEffect(()=>{const v=setTimeout(()=>{y(d)},h);return()=>{clearTimeout(v)}},[d,h]),f}export{ds as C,Ds as E,Rs as a,Ps as b,Vs as u};
