import{j as e,s as Ee,t as De,T as s,i as U,v as Te,w as Ne,A as Se,az as a,B as g,H as Me,aT as He,y as Qe,g as b,a1 as z,bc as Ye,p as se,I as Oe,V as Ke,l as es,bd as ss,x as Pe,b as te,C as Re,be as A,D as me,bf as ns,bg as as,bh as Xe,bi as Ue,bj as is,e as Ie,f as We,_ as Ze,av as _e,$ as $e,Z as os,bk as ls,aA as Be,m as qe,G as ts,ap as cs,aq as ds,au as hs,as as xs,at as be,ba as ps,bl as fs,bm as us,aS as gs}from"./mui-vendor-Y6GvQTLC.js";import{r as l,a as js}from"./react-vendor-D7yrL1sD.js";import{d as Ve,k as rs,w as ze,u as Le,U as Ce,e as ms,M as Je,Z as ys,n as ve}from"./index-B_PiLh6w.js";import{u as pe}from"./userManagementService-CLlXA1yC.js";import"./query-vendor-D4yC0Jq7.js";import"./chart-vendor-BgnY-Lfo.js";const Ge={zones:[],wards:[],categories:[],features:{canViewComplaints:!0,canApproveComplaints:!1,canRejectComplaints:!1,canMarkComplaintsPending:!1,canEditComplaints:!1,canDeleteComplaints:!1,canViewUsers:!0,canEditUsers:!1,canDeleteUsers:!1,canAddUsers:!1,canViewAdmins:!1,canEditAdmins:!1,canDeleteAdmins:!1,canAddAdmins:!1,canViewMessages:!0,canSendMessagesToUsers:!1,canSendMessagesToAdmins:!1,canViewAnalytics:!1,canExportData:!1,canDownloadReports:!1,viewOnlyMode:!1,canViewComplainantProfile:!1,canViewAreaStats:!1,canViewOwnPerformance:!1,canShowReviews:!1}},ws=({open:i,onClose:D,onSuccess:C})=>{const[d,m]=l.useState({firstName:"",lastName:".",designation:"",email:"",phone:"",whatsapp:"",joiningDate:new Date().toISOString().split("T")[0],address:"",password:"",confirmPassword:"",cityCorporationCode:"",zoneId:"",wardId:"",role:"ADMIN",permissions:JSON.parse(JSON.stringify(Ge))}),[o,E]=l.useState([]),[Z,_]=l.useState([]),[$,B]=l.useState([]),[f,q]=l.useState([]),[J,G]=l.useState(!1),[fe,Y]=l.useState(!1),[V,v]=l.useState(!1),[re,ne]=l.useState(!1),[R,ae]=l.useState({}),[he,xe]=l.useState(!1),[ie,H]=l.useState(null);l.useEffect(()=>{i&&(oe(),m({firstName:"",lastName:".",designation:"",email:"",phone:"",whatsapp:"",joiningDate:new Date().toISOString().split("T")[0],address:"",password:"",confirmPassword:"",cityCorporationCode:"",zoneId:"",wardId:"",role:"ADMIN",permissions:JSON.parse(JSON.stringify(Ge))}),ae({}),H(null))},[i]);const oe=async()=>{try{G(!0);const n=await Ve.getCityCorporations("ACTIVE");E(n.cityCorporations||[])}catch(n){console.error("Error fetching city corporations:",n)}finally{G(!1)}},P=async n=>{try{Y(!0);const u=await rs.getZones({cityCorporationCode:n,status:"ACTIVE"});_(u.zones||[])}catch(u){console.error("Error fetching zones:",u)}finally{Y(!1)}},le=async n=>{try{v(!0);const u=await ze.getWards({zoneId:n,status:"ACTIVE"});B(u.wards||[])}catch(u){console.error("Error fetching wards:",u)}finally{v(!1)}},k=async n=>{try{const u=await ze.getWards({cityCorporationCode:n,status:"ACTIVE"});q(u.wards||[])}catch(u){console.error("Error fetching all wards:",u)}},I=n=>u=>{const c=u.target.value;m(j=>({...j,[n]:c})),n==="cityCorporationCode"?(m(j=>({...j,cityCorporationCode:c,zoneId:"",wardId:"",permissions:{...j.permissions,wards:[]}})),P(c),k(c)):n==="zoneId"&&(m(j=>({...j,zoneId:c,wardId:""})),le(parseInt(c))),R[n]&&ae(j=>({...j,[n]:void 0}))},S=(n,u)=>{const c=u.map(j=>j.id);m(j=>({...j,permissions:{...j.permissions,wards:c}}))},Q=n=>{m(u=>{const c={...u.permissions.features};if(n==="viewOnlyMode"){const j=!c.viewOnlyMode;j&&Object.keys(c).forEach(T=>{T!=="viewOnlyMode"&&(c[T]=!1)}),c.viewOnlyMode=j}else if(n==="actionApproval"){const T=!c.canApproveComplaints;c.canApproveComplaints=T,c.canRejectComplaints=T,c.canMarkComplaintsPending=T,c.canEditComplaints=T,c.canEditUsers=T,c.canDeleteUsers=T,T&&(c.viewOnlyMode=!1)}else if(n==="reportDownload"){const j=!c.canDownloadReports;c.canDownloadReports=j,c.canExportData=j,c.canViewAnalytics=j,j&&(c.viewOnlyMode=!1)}else c[n]=!c[n],c[n]&&(c.viewOnlyMode=!1);return{...u,permissions:{...u.permissions,features:c}}})},ce=()=>{const n={};return d.firstName.trim()||(n.firstName="Name is required"),d.phone.trim()||(n.phone="Phone is required"),d.password||(n.password="Password is required"),d.cityCorporationCode||(n.cityCorporationCode="City Corporation is required"),d.zoneId||(n.zoneId="Zone is required"),ae(n),Object.keys(n).length===0},ue=async()=>{var n,u,c;if(ce()){xe(!0),H(null);try{const j={firstName:d.firstName,lastName:d.lastName,designation:d.designation,email:d.email,phone:d.phone,whatsapp:d.whatsapp,joiningDate:d.joiningDate,address:d.address,password:d.password,role:d.role,cityCorporationCode:d.cityCorporationCode,zoneId:parseInt(d.zoneId),wardId:d.wardId?parseInt(d.wardId):void 0,permissions:d.permissions};await pe.createUser(j),C(),D()}catch(j){console.error("Error creating admin:",j),H(((c=(u=(n=j.response)==null?void 0:n.data)==null?void 0:u.error)==null?void 0:c.message)||"Failed to create admin")}finally{xe(!1)}}};return e.jsxs(Ee,{open:i,onClose:D,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[e.jsxs(De,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[e.jsx(s,{variant:"h6",fontWeight:"bold",children:"‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®"}),e.jsx(U,{onClick:D,size:"small",children:e.jsx(Te,{})})]}),e.jsxs(Ne,{dividers:!0,sx:{p:3},children:[ie&&e.jsx(Se,{severity:"error",sx:{mb:2},children:ie}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsxs(a,{size:{xs:12,md:3},display:"flex",flexDirection:"column",alignItems:"center",children:[e.jsxs(g,{sx:{position:"relative",mb:2},children:[e.jsx(Me,{sx:{width:120,height:120,bgcolor:"#f0f0f0"},children:e.jsx(He,{sx:{fontSize:50,color:"#bdbdbd"}})}),e.jsx(U,{sx:{position:"absolute",bottom:0,right:0,bgcolor:"#4caf50",color:"white","&:hover":{bgcolor:"#45a049"},padding:"4px"},size:"small",children:e.jsx(Qe,{fontSize:"small"})})]}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶õ‡¶¨‡¶ø"})]}),e.jsx(a,{size:{xs:12,md:9},children:e.jsxs(a,{container:!0,spacing:2,children:[e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶®‡¶æ‡¶Æ"}),e.jsx(b,{fullWidth:!0,placeholder:"‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®...",value:d.firstName,onChange:I("firstName"),error:!!R.firstName,size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶™‡¶¶‡¶¨‡ßÄ"}),e.jsx(b,{fullWidth:!0,placeholder:"‡¶™‡¶¶‡¶¨‡ßÄ...",value:d.designation,onChange:I("designation"),size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶´‡ßã‡¶®"}),e.jsx(b,{fullWidth:!0,placeholder:"01XXXXXXXXX",value:d.phone,onChange:I("phone"),error:!!R.phone,size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶π‡ßã‡ßü‡¶æ‡¶ü‡¶∏‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™"}),e.jsx(b,{fullWidth:!0,placeholder:"01XXXXXXXXX",value:d.whatsapp,onChange:I("whatsapp"),size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶á‡¶Æ‡ßá‡¶á‡¶≤"}),e.jsx(b,{fullWidth:!0,placeholder:"example@email.com",value:d.email,onChange:I("email"),size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶ú‡ßü‡ßá‡¶®‡¶ø‡¶Ç ‡¶°‡ßá‡¶ü"}),e.jsx(b,{fullWidth:!0,type:"date",value:d.joiningDate,onChange:I("joiningDate"),size:"small",InputLabelProps:{shrink:!0}})]}),e.jsxs(a,{size:12,children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ"}),e.jsx(b,{fullWidth:!0,placeholder:"‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ...",value:d.address,onChange:I("address"),size:"small",multiline:!0,rows:2})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®"}),e.jsxs(b,{select:!0,fullWidth:!0,value:d.cityCorporationCode,onChange:I("cityCorporationCode"),error:!!R.cityCorporationCode,size:"small",SelectProps:{displayEmpty:!0},children:[e.jsx(z,{value:"",disabled:!0,children:"‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶® ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."}),o.map(n=>e.jsx(z,{value:n.code,children:n.name},n.code))]})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶ú‡ßã‡¶®"}),e.jsxs(b,{select:!0,fullWidth:!0,value:d.zoneId,onChange:I("zoneId"),error:!!R.zoneId,disabled:!d.cityCorporationCode,size:"small",SelectProps:{displayEmpty:!0},children:[e.jsx(z,{value:"",disabled:!0,children:"‡¶ú‡ßã‡¶® ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."}),Z.map(n=>e.jsx(z,{value:n.id.toString(),children:n.name||`Zone ${n.zoneNumber}`},n.id))]})]}),e.jsxs(a,{size:12,children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶è‡¶∞‡¶ø‡ßü‡¶æ (‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°)"}),e.jsx(Ye,{multiple:!0,options:f,getOptionLabel:n=>`Ward ${n.wardNumber}${n.zone?` (Zone ${n.zone.zoneNumber})`:""}`,value:f.filter(n=>d.permissions.wards.includes(n.id)),onChange:S,disabled:!d.cityCorporationCode,size:"small",renderTags:(n,u)=>n.map((c,j)=>e.jsx(se,{label:`Ward ${c.wardNumber}`,size:"small",...u({index:j})})),renderInput:n=>e.jsx(b,{...n,placeholder:d.permissions.wards.length>0?"":"‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."})}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶®‡ßã‡¶ü: ‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞‡¶ø ‡¶ú‡ßã‡¶®‡ßá‡¶∞ ‡¶¨‡¶æ‡¶á‡¶∞‡ßá‡¶∞ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¨‡¶æ ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§"})]}),e.jsxs(a,{size:12,children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°"}),e.jsx(b,{fullWidth:!0,type:re?"text":"password",value:d.password,onChange:I("password"),error:!!R.password,size:"small",InputProps:{endAdornment:e.jsx(Oe,{position:"end",children:e.jsx(U,{onClick:()=>ne(!re),edge:"end",size:"small",children:re?e.jsx(Ke,{}):e.jsx(es,{})})})}})]})]})}),e.jsx(a,{size:12,children:e.jsxs(g,{sx:{bgcolor:"#f5f5f5",p:2,borderRadius:2,mt:2},children:[e.jsx(s,{variant:"subtitle2",fontWeight:"bold",mb:2,children:"‡¶™‡¶æ‡¶∞‡¶Æ‡¶ø‡¶∂‡¶® ‡¶ì ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤"}),e.jsx(a,{container:!0,spacing:2,children:[{label:"‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶ü‡ßÅ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞",key:"canSendMessagesToUsers"},{label:"‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶ü‡ßÅ ‡¶∏‡ßÅ‡¶™‡¶æ‡¶∞ ‡¶è‡¶°‡¶Æ‡¶ø‡¶®",key:"canSendMessagesToAdmins"},{label:"‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤",key:"canViewComplainantProfile"},{label:"‡¶è‡¶∞‡¶ø‡ßü‡¶æ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏",key:"canViewAreaStats"},{label:"‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶™‡¶æ‡¶∞‡¶´‡¶∞‡¶Æ‡ßá‡¶®‡ßç‡¶∏",key:"canViewOwnPerformance"},{label:"‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â",key:"canShowReviews"},{label:"‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°",key:"reportDownload"},{label:"‡¶è‡¶ï‡¶∂‡¶® ‡¶è‡¶™‡ßç‡¶∞‡ßÅ‡¶≠‡¶æ‡¶≤",key:"actionApproval"},{label:"‡¶≠‡¶ø‡¶â ‡¶Ö‡¶®‡¶≤‡¶ø",key:"viewOnlyMode"}].map(n=>{let u=!1;n.key==="actionApproval"?u=d.permissions.features.canApproveComplaints:n.key==="reportDownload"?u=d.permissions.features.canDownloadReports:u=!!d.permissions.features[n.key];const c=d.permissions.features.viewOnlyMode&&n.key!=="viewOnlyMode";return e.jsx(a,{size:{xs:12,sm:6,md:4},children:e.jsxs(g,{display:"flex",justifyContent:"space-between",alignItems:"center",p:1,bgcolor:"white",borderRadius:1,border:"1px solid #eee",children:[e.jsx(s,{variant:"body2",color:c?"text.disabled":"text.primary",children:n.label}),e.jsx(ss,{checked:u,onChange:()=>Q(n.key),color:"success",size:"small",disabled:c})]})},n.key)})})]})})]})]}),e.jsxs(Pe,{sx:{p:2,display:"flex",gap:1},children:[e.jsx(te,{onClick:D,variant:"outlined",color:"inherit",fullWidth:!0,sx:{borderColor:"#ddd",color:"#666"},children:"‡¶¨‡¶æ‡¶§‡¶ø‡¶≤"}),e.jsx(te,{onClick:ue,variant:"contained",color:"success",fullWidth:!0,disabled:he,sx:{bgcolor:"#4caf50","&:hover":{bgcolor:"#45a049"}},children:he?e.jsx(Re,{size:24,color:"inherit"}):"‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®"})]})]})},ge={zones:[],wards:[],categories:[],features:{canViewComplaints:!0,canApproveComplaints:!1,canRejectComplaints:!1,canMarkComplaintsPending:!1,canEditComplaints:!1,canDeleteComplaints:!1,canViewUsers:!0,canEditUsers:!1,canDeleteUsers:!1,canAddUsers:!1,canViewAdmins:!1,canEditAdmins:!1,canDeleteAdmins:!1,canAddAdmins:!1,canViewMessages:!0,canSendMessagesToUsers:!1,canSendMessagesToAdmins:!1,canViewAnalytics:!1,canExportData:!1,canDownloadReports:!1,viewOnlyMode:!1,canViewComplainantProfile:!1,canViewAreaStats:!1,canViewOwnPerformance:!1,canShowReviews:!1}},bs=({admin:i,open:D,onClose:C,onSuccess:d})=>{var we,K,ee;const{user:m}=Le(),[o,E]=l.useState({firstName:"",lastName:"",designation:"",email:"",phone:"",whatsapp:"",joiningDate:"",address:"",cityCorporationCode:"",zoneId:"",wardId:"",role:"ADMIN",status:"ACTIVE",newPassword:"",confirmPassword:"",permissions:JSON.parse(JSON.stringify(ge))}),[Z,_]=l.useState([]),[$,B]=l.useState([]),[f,q]=l.useState([]),[J,G]=l.useState([]),[fe,Y]=l.useState(!1),[V,v]=l.useState(!1),[re,ne]=l.useState(!1),[R,ae]=l.useState(null),[he,xe]=l.useState(null),ie=js.useRef(null),[H,oe]=l.useState(!1),[P,le]=l.useState({}),[k,I]=l.useState(!1),[S,Q]=l.useState(null);l.useEffect(()=>{var t,x,h,y,M,r,p,w,Ae;if(D&&i){let L=JSON.parse(JSON.stringify(ge));if(i.permissions)if(typeof i.permissions=="string")try{const W=JSON.parse(i.permissions);L={...ge,...W,features:{...ge.features,...W.features}}}catch(W){console.error("Failed to parse permissions string",W)}else L={...ge,...i.permissions,features:{...ge.features,...i.permissions.features}};E({firstName:i.firstName||"",lastName:i.lastName||"",designation:i.designation||"",email:i.email||"",phone:i.phone||"",whatsapp:i.whatsapp||"",joiningDate:i.joiningDate?new Date(i.joiningDate).toISOString().split("T")[0]:"",address:i.address||"",cityCorporationCode:((t=i.cityCorporation)==null?void 0:t.code)||i.cityCorporationCode||"",zoneId:((h=(x=i.zone)==null?void 0:x.id)==null?void 0:h.toString())||((y=i.zoneId)==null?void 0:y.toString())||"",wardId:((r=(M=i.ward)==null?void 0:M.id)==null?void 0:r.toString())||((p=i.wardId)==null?void 0:p.toString())||"",role:i.role,status:i.status,newPassword:"",confirmPassword:"",permissions:L}),ce();const O=((w=i.cityCorporation)==null?void 0:w.code)||i.cityCorporationCode;if(O){ue(O),u(O);const W=((Ae=i.zone)==null?void 0:Ae.id)||i.zoneId;W&&n(W)}le({}),Q(null),ae(null),xe(i.avatar||null)}},[D,i]);const ce=async()=>{try{Y(!0);const t=await Ve.getCityCorporations("ACTIVE");_(t.cityCorporations||[])}catch(t){console.error("Error fetching city corporations:",t)}finally{Y(!1)}},ue=async t=>{try{v(!0);const x=await rs.getZones({cityCorporationCode:t,status:"ACTIVE"});B(x.zones||[])}catch(x){console.error("Error fetching zones:",x)}finally{v(!1)}},n=async t=>{try{ne(!0);const x=await ze.getWards({zoneId:t,status:"ACTIVE"});q(x.wards||[])}catch(x){console.error("Error fetching wards:",x)}finally{ne(!1)}},u=async t=>{try{const x=await ze.getWards({cityCorporationCode:t,status:"ACTIVE"});G(x.wards||[])}catch(x){console.error("Error fetching all wards:",x)}},c=t=>x=>{const h=x.target.value;E(y=>({...y,[t]:h})),t==="cityCorporationCode"?(E(y=>({...y,cityCorporationCode:h,zoneId:"",wardId:"",permissions:{...y.permissions,wards:[]}})),ue(h),u(h)):t==="zoneId"&&(E(y=>({...y,zoneId:h,wardId:""})),n(parseInt(h))),P[t]&&le(y=>({...y,[t]:void 0}))},j=(t,x)=>{const h=x.map(y=>y.id);E(y=>({...y,permissions:{...y.permissions,wards:h}}))},T=t=>{var h;const x=(h=t.target.files)==null?void 0:h[0];x&&(ae(x),xe(URL.createObjectURL(x)))},ye=()=>{var t;(t=ie.current)==null||t.click()},de=t=>{E(x=>{const h={...x.permissions.features};if(t==="viewOnlyMode"){const y=!h.viewOnlyMode;y&&Object.keys(h).forEach(M=>{M!=="viewOnlyMode"&&(h[M]=!1)}),h.viewOnlyMode=y}else if(t==="actionApproval"){const M=!h.canApproveComplaints;h.canApproveComplaints=M,h.canRejectComplaints=M,h.canMarkComplaintsPending=M,h.canEditComplaints=M,h.canEditUsers=M,h.canDeleteUsers=M,M&&(h.viewOnlyMode=!1)}else if(t==="reportDownload"){const y=!h.canDownloadReports;h.canDownloadReports=y,h.canExportData=y,h.canViewAnalytics=y,y&&(h.viewOnlyMode=!1)}else h[t]=!h[t],h[t]&&(h.viewOnlyMode=!1);return{...x,permissions:{...x.permissions,features:h}}})},ke=()=>{const t={};return o.firstName.trim()||(t.firstName="First Name is required"),o.lastName.trim()||(t.lastName="Last Name is required"),o.phone.trim()||(t.phone="Phone is required"),o.cityCorporationCode||(t.cityCorporationCode="City Corporation is required"),o.zoneId||(t.zoneId="Zone is required"),o.newPassword&&o.newPassword.length<8&&(t.newPassword="Password must be at least 8 characters"),o.newPassword!==o.confirmPassword&&(t.confirmPassword="Passwords do not match"),le(t),Object.keys(t).length===0},N=async()=>{if(!(!ke()||!i)){I(!0),Q(null);try{let t=i.avatar;if(R)try{t=await pe.uploadAvatar(R)}catch(h){throw console.error("Error uploading avatar:",h),new Error("Failed to upload profile picture")}const x={firstName:o.firstName,lastName:o.lastName,designation:o.designation,email:o.email,phone:o.phone,whatsapp:o.whatsapp,joiningDate:o.joiningDate,address:o.address,role:o.role,status:o.status,cityCorporationCode:o.cityCorporationCode,zoneId:parseInt(o.zoneId),wardId:o.wardId?parseInt(o.wardId):void 0,permissions:o.permissions,avatar:t||void 0};o.newPassword&&(x.password=o.newPassword),await pe.updateUser(i.id,x),d(),C()}catch(t){console.error("Error updating admin:",t),Q(t.message||"Failed to update admin")}finally{I(!1)}}};return e.jsxs(Ee,{open:D,onClose:C,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[e.jsxs(De,{component:"div",sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[e.jsx(s,{variant:"h6",fontWeight:"bold",children:"‡¶è‡¶°‡¶ø‡¶ü ‡¶è‡¶°‡¶Æ‡¶ø‡¶®"}),e.jsx(U,{onClick:C,size:"small",children:e.jsx(Te,{})})]}),e.jsxs(Ne,{dividers:!0,sx:{p:3},children:[S&&e.jsx(Se,{severity:"error",sx:{mb:2},children:S}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsxs(a,{size:{xs:12,md:3},display:"flex",flexDirection:"column",alignItems:"center",children:[e.jsxs(g,{sx:{position:"relative",mb:2},children:[e.jsx("input",{type:"file",ref:ie,style:{display:"none"},accept:"image/*",onChange:T}),e.jsx(Me,{src:he||void 0,sx:{width:120,height:120,bgcolor:"#f0f0f0"},children:e.jsx(He,{sx:{fontSize:50,color:"#bdbdbd"}})}),e.jsx(U,{onClick:ye,sx:{position:"absolute",bottom:0,right:0,bgcolor:"#4caf50",color:"white","&:hover":{bgcolor:"#45a049"},padding:"4px"},size:"small",children:e.jsx(Qe,{fontSize:"small"})})]}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶õ‡¶¨‡¶ø"})]}),e.jsx(a,{size:{xs:12,md:9},children:e.jsxs(a,{container:!0,spacing:2,children:[e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶Ö‡¶Ç‡¶∂"}),e.jsx(b,{fullWidth:!0,placeholder:"‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶Ö‡¶Ç‡¶∂...",value:o.firstName,onChange:c("firstName"),error:!!P.firstName,size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶∂‡ßá‡¶∑ ‡¶Ö‡¶Ç‡¶∂"}),e.jsx(b,{fullWidth:!0,placeholder:"‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶∂‡ßá‡¶∑ ‡¶Ö‡¶Ç‡¶∂...",value:o.lastName,onChange:c("lastName"),error:!!P.lastName,size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶™‡¶¶‡¶¨‡ßÄ"}),e.jsx(b,{fullWidth:!0,placeholder:"‡¶™‡¶¶‡¶¨‡ßÄ...",value:o.designation,onChange:c("designation"),size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶´‡ßã‡¶®"}),e.jsx(b,{fullWidth:!0,placeholder:"01XXXXXXXXX",value:o.phone,onChange:c("phone"),error:!!P.phone,size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶π‡ßã‡ßü‡¶æ‡¶ü‡¶∏‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™"}),e.jsx(b,{fullWidth:!0,placeholder:"01XXXXXXXXX",value:o.whatsapp,onChange:c("whatsapp"),size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶á‡¶Æ‡ßá‡¶á‡¶≤"}),e.jsx(b,{fullWidth:!0,placeholder:"example@email.com",value:o.email,onChange:c("email"),size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶ú‡ßü‡ßá‡¶®‡¶ø‡¶Ç ‡¶°‡ßá‡¶ü"}),e.jsx(b,{fullWidth:!0,type:"date",value:o.joiningDate,onChange:c("joiningDate"),size:"small",InputLabelProps:{shrink:!0}})]}),e.jsxs(a,{size:12,children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ"}),e.jsx(b,{fullWidth:!0,placeholder:"‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ...",value:o.address,onChange:c("address"),size:"small",multiline:!0,rows:2})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®"}),e.jsxs(b,{select:!0,fullWidth:!0,value:o.cityCorporationCode,onChange:c("cityCorporationCode"),error:!!P.cityCorporationCode,disabled:(m==null?void 0:m.role)!=="MASTER_ADMIN",size:"small",SelectProps:{displayEmpty:!0},children:[e.jsx(z,{value:"",disabled:!0,children:"‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶® ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."}),o.cityCorporationCode&&!Z.find(t=>t.code===o.cityCorporationCode)&&e.jsx(z,{value:o.cityCorporationCode,sx:{display:"none"},children:((we=i==null?void 0:i.cityCorporation)==null?void 0:we.name)||o.cityCorporationCode}),Z.map(t=>e.jsx(z,{value:t.code,children:t.name},t.code))]})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶ú‡ßã‡¶®"}),e.jsxs(b,{select:!0,fullWidth:!0,value:o.zoneId,onChange:c("zoneId"),error:!!P.zoneId,disabled:(m==null?void 0:m.role)!=="MASTER_ADMIN"||!o.cityCorporationCode,size:"small",SelectProps:{displayEmpty:!0},children:[e.jsx(z,{value:"",disabled:!0,children:"‡¶ú‡ßã‡¶® ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."}),o.zoneId&&!$.find(t=>t.id.toString()===o.zoneId)&&e.jsx(z,{value:o.zoneId,sx:{display:"none"},children:((K=i==null?void 0:i.zone)==null?void 0:K.name)||`Zone ${(ee=i==null?void 0:i.zone)==null?void 0:ee.zoneNumber}`||o.zoneId}),$.map(t=>e.jsx(z,{value:t.id.toString(),children:t.name||`Zone ${t.zoneNumber}`},t.id))]})]}),e.jsxs(a,{size:12,children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶è‡¶∞‡¶ø‡ßü‡¶æ (‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°)"}),e.jsx(Ye,{multiple:!0,options:J,getOptionLabel:t=>`Ward ${t.wardNumber}${t.zone?` (Zone ${t.zone.zoneNumber})`:""}`,value:J.filter(t=>o.permissions.wards.includes(t.id)),onChange:j,disabled:(m==null?void 0:m.role)!=="MASTER_ADMIN"||!o.cityCorporationCode,size:"small",renderTags:(t,x)=>t.map((h,y)=>{const{key:M,...r}=x({index:y});return e.jsx(se,{label:`Ward ${h.wardNumber}`,size:"small",...r,disabled:(m==null?void 0:m.role)!=="MASTER_ADMIN"},M)}),renderInput:t=>e.jsx(b,{...t,placeholder:o.permissions.wards.length>0?"":"‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."})}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶®‡ßã‡¶ü: ‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞‡¶ø ‡¶ú‡ßã‡¶®‡ßá‡¶∞ ‡¶¨‡¶æ‡¶á‡¶∞‡ßá‡¶∞ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¨‡¶æ ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏"}),e.jsxs(b,{select:!0,fullWidth:!0,value:o.status,onChange:c("status"),size:"small",children:[e.jsx(z,{value:"ACTIVE",children:"Active"}),e.jsx(z,{value:"INACTIVE",children:"Inactive"}),e.jsx(z,{value:"SUSPENDED",children:"Suspended"}),e.jsx(z,{value:"PENDING",children:"Pending"})]})]}),e.jsx(a,{size:12,children:(m==null?void 0:m.role)==="MASTER_ADMIN"&&e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° (‡¶Ö‡¶™‡¶∂‡¶®‡¶æ‡¶≤)"}),e.jsx(b,{fullWidth:!0,type:H?"text":"password",value:o.newPassword,onChange:c("newPassword"),error:!!P.newPassword,helperText:P.newPassword,size:"small",InputProps:{endAdornment:e.jsx(Oe,{position:"end",children:e.jsx(U,{onClick:()=>oe(!H),edge:"end",size:"small",children:H?e.jsx(Ke,{}):e.jsx(es,{})})})}}),e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,mt:2,children:"‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®"}),e.jsx(b,{fullWidth:!0,type:H?"text":"password",value:o.confirmPassword,onChange:c("confirmPassword"),error:!!P.confirmPassword,helperText:P.confirmPassword,size:"small",placeholder:"‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶Ø‡¶º ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®"})]})})]})}),e.jsx(a,{size:12,children:e.jsxs(g,{sx:{bgcolor:"#f5f5f5",p:2,borderRadius:2,mt:2},children:[e.jsx(s,{variant:"subtitle2",fontWeight:"bold",mb:2,children:"‡¶™‡¶æ‡¶∞‡¶Æ‡¶ø‡¶∂‡¶® ‡¶ì ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤"}),e.jsx(a,{container:!0,spacing:2,children:[{label:"‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶ü‡ßÅ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞",key:"canSendMessagesToUsers"},{label:"‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶ü‡ßÅ ‡¶∏‡ßÅ‡¶™‡¶æ‡¶∞ ‡¶è‡¶°‡¶Æ‡¶ø‡¶®",key:"canSendMessagesToAdmins"},{label:"‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤",key:"canViewComplainantProfile"},{label:"‡¶è‡¶∞‡¶ø‡ßü‡¶æ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏",key:"canViewAreaStats"},{label:"‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶™‡¶æ‡¶∞‡¶´‡¶∞‡¶Æ‡ßá‡¶®‡ßç‡¶∏",key:"canViewOwnPerformance"},{label:"‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â",key:"canShowReviews"},{label:"‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°",key:"reportDownload"},{label:"‡¶è‡¶ï‡¶∂‡¶® ‡¶è‡¶™‡ßç‡¶∞‡ßÅ‡¶≠‡¶æ‡¶≤",key:"actionApproval"},{label:"‡¶≠‡¶ø‡¶â ‡¶Ö‡¶®‡¶≤‡¶ø",key:"viewOnlyMode"}].map(t=>{let x=!1;t.key==="actionApproval"?x=o.permissions.features.canApproveComplaints:t.key==="reportDownload"?x=o.permissions.features.canDownloadReports:x=!!o.permissions.features[t.key];const h=o.permissions.features.viewOnlyMode&&t.key!=="viewOnlyMode";return e.jsx(a,{size:{xs:12,sm:6,md:4},children:e.jsxs(g,{display:"flex",justifyContent:"space-between",alignItems:"center",p:1,bgcolor:"white",borderRadius:1,border:"1px solid #eee",children:[e.jsx(s,{variant:"body2",color:h?"text.disabled":"text.primary",children:t.label}),e.jsx(ss,{checked:x,onChange:()=>de(t.key),color:"success",size:"small",disabled:h})]})},t.key)})})]})})]})]}),e.jsxs(Pe,{sx:{p:2,display:"flex",gap:1},children:[e.jsx(te,{onClick:C,variant:"outlined",color:"inherit",fullWidth:!0,sx:{borderColor:"#ddd",color:"#666"},children:"‡¶¨‡¶æ‡¶§‡¶ø‡¶≤"}),e.jsx(te,{onClick:N,variant:"contained",color:"success",fullWidth:!0,disabled:k,sx:{bgcolor:"#4caf50","&:hover":{bgcolor:"#45a049"}},children:k?e.jsx(Re,{size:24,color:"inherit"}):"‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®"})]})]})},Cs=({open:i,onClose:D,admin:C})=>{var J,G,fe,Y;const{user:d}=Le(),[m,o]=l.useState(null),[E,Z]=l.useState(!1),[_,$]=l.useState(null);l.useEffect(()=>{i&&(C!=null&&C.id)?B(C.id):(o(null),$(null))},[i,C]);const B=async V=>{try{Z(!0),$(null);const v=await pe.getUserById(V);o(v.user)}catch(v){console.error("Error fetching admin details:",v),$("Failed to load latest details")}finally{Z(!1)}};if(!C)return null;const f=m||C,q=V=>V?new Date(V).toLocaleDateString("bn-BD",{year:"numeric",month:"long",day:"numeric"}):"N/A";return e.jsxs(Ee,{open:i,onClose:D,maxWidth:"md",fullWidth:!0,children:[e.jsxs(De,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(s,{sx:{fontWeight:700},children:"‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§"}),e.jsx(U,{onClick:D,children:e.jsx(Te,{})})]}),e.jsxs(Ne,{dividers:!0,children:[E&&e.jsx(g,{sx:{display:"flex",justifyContent:"center",p:2},children:e.jsx(Re,{size:24})}),_&&e.jsxs(Se,{severity:"warning",sx:{mb:2},children:[_," - Showing cached data"]}),e.jsxs(A,{spacing:3,sx:{opacity:E?.6:1,transition:"opacity 0.2s"},children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(Me,{sx:{width:80,height:80,bgcolor:"#2b7fff",fontSize:32,fontWeight:700},children:(J=f.firstName)==null?void 0:J.charAt(0)}),e.jsxs(g,{sx:{flex:1},children:[e.jsxs(s,{variant:"h5",sx:{fontWeight:700,mb:.5},children:[f.firstName," ",f.lastName]}),e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(se,{label:f.role,size:"small",sx:{bgcolor:"#eff6ff",color:"#155dfc"}}),e.jsx(se,{label:f.status==="ACTIVE"?"‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º":"‡¶®‡¶ø‡¶∑‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º",size:"small",sx:{bgcolor:f.status==="ACTIVE"?"#dcfce7":"#fee2e2",color:f.status==="ACTIVE"?"#008236":"#dc2626"}})]})]})]}),e.jsx(me,{}),e.jsxs(g,{children:[e.jsx(s,{variant:"h6",sx:{fontWeight:700,mb:2},children:"‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø"}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{size:{xs:12,sm:6},children:e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(ns,{sx:{color:"#4a5565"}}),e.jsxs(g,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:f.phone})]})]})}),f.email&&e.jsx(a,{size:{xs:12,sm:6},children:e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(as,{sx:{color:"#4a5565"}}),e.jsxs(g,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶á‡¶Æ‡ßá‡¶á‡¶≤"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:f.email})]})]})}),f.address&&e.jsx(a,{size:{xs:12},children:e.jsxs(A,{direction:"row",spacing:1,alignItems:"flex-start",children:[e.jsx(Xe,{sx:{color:"#4a5565",mt:.5}}),e.jsxs(g,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:f.address})]})]})})]})]}),e.jsx(me,{}),e.jsxs(g,{children:[e.jsx(s,{variant:"h6",sx:{fontWeight:700,mb:2},children:"‡¶è‡¶≤‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø"}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{size:{xs:12,sm:4},children:e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Xe,{sx:{color:"#4a5565"}}),e.jsxs(g,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:((G=f.cityCorporation)==null?void 0:G.name)||"N/A"})]})]})}),e.jsx(a,{size:{xs:12,sm:4},children:e.jsxs(g,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶ú‡ßã‡¶®"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:((fe=f.zone)==null?void 0:fe.name)||"‡¶™‡ßç‡¶∞‡¶Ø‡ßã‡¶ú‡ßç‡¶Ø ‡¶®‡ßü"})]})}),f.ward&&e.jsx(a,{size:{xs:12,sm:4},children:e.jsxs(g,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:`‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ${f.ward.wardNumber}`})]})})]}),f.extraWards&&f.extraWards.length>0&&e.jsxs(g,{sx:{mt:2},children:[e.jsx(s,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:.5},children:f.ward?"‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°":"‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶ø‡¶§ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡¶Æ‡ßÇ‡¶π"}),e.jsx(A,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:f.extraWards.map(V=>e.jsx(se,{label:`‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ${V.wardNumber}`,size:"small",variant:"outlined",sx:{mb:.5}},V.id))})]})]}),e.jsx(me,{}),f.statistics&&e.jsxs(g,{children:[e.jsx(s,{variant:"h6",sx:{fontWeight:700,mb:2},children:"‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶®"}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{size:{xs:6,sm:3},children:e.jsxs(g,{sx:{textAlign:"center",p:2,bgcolor:"#f9fafb",borderRadius:2},children:[e.jsx(s,{variant:"h4",sx:{fontWeight:700,color:"#155dfc"},children:f.statistics.totalComplaints||0}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶Æ‡ßã‡¶ü ‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó"})]})}),e.jsx(a,{size:{xs:6,sm:3},children:e.jsxs(g,{sx:{textAlign:"center",p:2,bgcolor:"#f0fdf4",borderRadius:2},children:[e.jsx(s,{variant:"h4",sx:{fontWeight:700,color:"#00a63e"},children:f.statistics.resolvedComplaints||0}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶® ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá"})]})}),e.jsx(a,{size:{xs:6,sm:3},children:e.jsxs(g,{sx:{textAlign:"center",p:2,bgcolor:"#fff7ed",borderRadius:2},children:[e.jsx(s,{variant:"h4",sx:{fontWeight:700,color:"#d08700"},children:f.statistics.pendingComplaints||0}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶™‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç"})]})}),e.jsx(a,{size:{xs:6,sm:3},children:e.jsxs(g,{sx:{textAlign:"center",p:2,bgcolor:"#eff6ff",borderRadius:2},children:[e.jsx(s,{variant:"h4",sx:{fontWeight:700,color:"#155dfc"},children:f.statistics.inProgressComplaints||0}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶ö‡¶≤‡¶Æ‡¶æ‡¶®"})]})})]})]}),e.jsx(me,{}),e.jsxs(g,{children:[e.jsx(s,{variant:"h6",sx:{fontWeight:700,mb:2},children:"‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶§‡¶•‡ßç‡¶Ø"}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{size:{xs:12,sm:6},children:e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Ue,{sx:{color:"#4a5565"}}),e.jsxs(g,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:q(f.createdAt)})]})]})}),f.lastLoginAt&&e.jsx(a,{size:{xs:12,sm:6},children:e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Ue,{sx:{color:"#4a5565"}}),e.jsxs(g,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶∂‡ßá‡¶∑ ‡¶≤‡¶ó‡¶á‡¶®"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:q(f.lastLoginAt)})]})]})}),(d==null?void 0:d.role)==="MASTER_ADMIN"&&e.jsxs(a,{size:{xs:12,sm:12},children:[e.jsx(me,{sx:{my:1}}),e.jsxs(A,{direction:"row",spacing:1,alignItems:"flex-start",sx:{mt:1},children:[e.jsx(is,{sx:{color:"#d32f2f",mt:.5}}),e.jsxs(g,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° (Visible only to MASTER ADMIN)"}),e.jsx(s,{variant:"body1",sx:{fontFamily:"monospace"},children:f.visiblePassword?e.jsx("span",{style:{color:"#2e7d32",fontWeight:"bold"},children:f.visiblePassword}):e.jsxs("span",{style:{color:"#666"},children:["Hash: ",(Y=f.passwordHash)==null?void 0:Y.substring(0,20),"... (Reset to see actual)"]})})]})]})]})]})]})]})]}),e.jsx(Pe,{children:e.jsx(te,{variant:"contained",onClick:D,sx:{bgcolor:"#3fa564"},children:"‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®"})})]})},je=({title:i,value:D,bg:C,color:d,loading:m=!1})=>e.jsx(Ie,{sx:{borderRadius:2,boxShadow:"0px 1px 3px 0px #0000001a, 0px 1px 2px -1px #0000001a"},children:e.jsx(We,{sx:{bgcolor:C,borderRadius:2},children:e.jsxs(A,{spacing:.5,children:[e.jsx(s,{sx:{color:"#4a5565",fontSize:14},children:i}),m?e.jsx(ts,{width:60,height:32}):e.jsx(s,{sx:{fontSize:24,fontWeight:700,color:d},children:D})]})})}),Es=()=>{const{user:i,isAuthenticated:D}=Le(),[C,d]=l.useState([]),[m,o]=l.useState(!0),[E,Z]=l.useState(!0),[_,$]=l.useState(null),[B,f]=l.useState(""),[q,J]=l.useState(1),[G,fe]=l.useState(1),[Y,V]=l.useState(0),[v,re]=l.useState(""),[ne,R]=l.useState(""),[ae,he]=l.useState(!1),[xe,ie]=l.useState(!1),[H,oe]=l.useState(!1),[P,le]=l.useState(!1),[k,I]=l.useState(null),[S,Q]=l.useState([]),[ce,ue]=l.useState(Ce.ACTIVE),[n,u]=l.useState([]),[c,j]=l.useState([]),[T,ye]=l.useState([]),[de,ke]=l.useState({total:0,active:0,inactive:0,online:0,offline:0,newToday:0}),N=(i==null?void 0:i.role)||null;i!=null&&i.zoneId,console.log("üîê Admin Management Access Check:",{isAuthenticated:D,userRole:N,hasAccess:N==="MASTER_ADMIN"||N==="SUPER_ADMIN",isMasterAdmin:N==="MASTER_ADMIN",isSuperAdmin:N==="SUPER_ADMIN"});const we=l.useCallback(async()=>{var r;try{const p=[Ve.getCityCorporations().catch(W=>(console.error("‚ùå Error fetching city corporations:",W),{cityCorporations:[]}))];N==="SUPER_ADMIN"&&(i!=null&&i.id)&&(console.log("üë§ Fetching assigned zones for Super Admin:",i.id),p.push(ms.getAssignedZones(Number(i.id)).catch(W=>(console.error("‚ùå Error fetching assigned zones:",W),[]))));const w=await Promise.all(p),Ae=w[0],L=w[1];let O=Ae.cityCorporations||[];if(console.log("‚úÖ City Corporations fetched:",O.length),N==="SUPER_ADMIN"){const W=i.cityCorporationCode||((r=i.cityCorporation)==null?void 0:r.code);if(W)console.log("üéØ Filtering City Corps for assigned code:",W),O=O.filter(F=>F.code===W),v!==W&&re(W);else if(L&&Array.isArray(L)&&L.length>0){const F=new Set;L.forEach(X=>{const Fe=X.zone||X;Fe.cityCorporationId&&F.add(Fe.cityCorporationId)}),F.size>0&&(console.log("üéØ Filtering City Corps for Super Admin assigned zones:",Array.from(F)),O=O.filter(X=>F.has(X.id)),O.length===1&&v!==O[0].code&&re(O[0].code))}}if(u(O),L){console.log("üõ°Ô∏è Raw Assigned Zones:",L);const W=L.map(F=>{const X=F.zone||F;return!X||!X.id?null:{id:X.id,zoneNumber:X.zoneNumber,name:X.name,cityCorporationId:X.cityCorporationId||0,status:"ACTIVE"}}).filter(F=>F!==null);console.log("‚úÖ Formatted Assigned Zones:",W),j(W)}}catch(p){console.error("‚ùå Error in data fetching:",p),u([])}},[N,i,v]);l.useCallback(async r=>{try{const p=await ze.getWards({zoneId:r});console.log("‚úÖ Wards response:",p),p&&p.wards&&Array.isArray(p.wards)?ye(p.wards):(console.warn("‚ö†Ô∏è Invalid wards response format:",p),ye([]))}catch(p){console.error("‚ùå Error fetching wards:",p),ye([])}},[]);const K=l.useCallback(async()=>{try{o(!0),$(null);const r={page:q,limit:20,role:"ADMIN",search:B||void 0,cityCorporationCode:v||void 0,zoneId:ne||void 0,status:ce==="ALL"?void 0:ce};console.log("üîç Admin Management Query:",r);const p=await pe.getUsers(r);console.log("‚úÖ Admin Management Response:",p),d(p.users||[]),V(p.pagination.total),fe(p.pagination.totalPages)}catch(r){console.error("Error fetching admins:",r),$(r.message||"Failed to fetch admins"),d([])}finally{o(!1)}},[q,B,v,ne,ce]),ee=l.useCallback(async()=>{var r,p;try{Z(!0);const w=await pe.getUserStatistics(v||void 0,"ADMIN");ke({total:w.totalCitizens||0,active:((r=w.statusBreakdown)==null?void 0:r.active)||0,inactive:((p=w.statusBreakdown)==null?void 0:p.inactive)||0,online:0,offline:0,newToday:w.newUsersThisMonth||0})}catch(w){console.error("Error fetching statistics:",w)}finally{Z(!1)}},[v]);l.useEffect(()=>{we()},[we]),l.useEffect(()=>{K()},[K]),l.useEffect(()=>{ee()},[ee]),l.useEffect(()=>{R("")},[v]),l.useEffect(()=>{const r=setTimeout(()=>{J(1)},500);return()=>clearTimeout(r)},[B]);const t=async()=>{if(k)try{ve.success("Admin deleted successfully"),oe(!1),I(null),K(),ee()}catch(r){ve.error(r.message||"Failed to delete admin")}},x=async()=>{if(S.length!==0&&window.confirm(`Are you sure you want to delete ${S.length} users?`))try{await pe.bulkDeleteUsers(S),ve.success("Users deleted successfully"),Q([]),K(),ee()}catch(r){ve.error(r.message||"Failed to delete users")}},h=r=>{if(r.target.checked){const p=C.map(w=>w.id);Q(p);return}Q([])},y=r=>{const p=S.indexOf(r);let w=[];p===-1?w=w.concat(S,r):p===0?w=w.concat(S.slice(1)):p===S.length-1?w=w.concat(S.slice(0,-1)):p>0&&(w=w.concat(S.slice(0,p),S.slice(p+1))),Q(w)};return N==="MASTER_ADMIN"||N==="SUPER_ADMIN"?e.jsx(Je,{title:"‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü",children:e.jsxs(A,{spacing:3,children:[e.jsx(Ie,{sx:{borderRadius:2,boxShadow:"0px 1px 3px 0px #0000001a, 0px 1px 2px -1px #0000001a"},children:e.jsxs(We,{children:[e.jsx(s,{sx:{fontSize:24,fontWeight:700,color:"#1e2939",mb:2},children:"‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü"}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{size:{xs:12,md:2},children:e.jsx(je,{title:"‡¶Æ‡ßã‡¶ü ‡¶è‡¶°‡¶Æ‡¶ø‡¶®",value:de.total,bg:"#eff6ff",color:"#155dfc",loading:E})}),e.jsx(a,{size:{xs:12,md:2},children:e.jsx(je,{title:"‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º",value:de.active,bg:"#f0fdf4",color:"#00a63e",loading:E})}),e.jsx(a,{size:{xs:12,md:2},children:e.jsx(je,{title:"‡¶®‡¶ø‡¶∑‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º",value:de.inactive,bg:"#fef2f2",color:"#e7000b",loading:E})}),e.jsx(a,{size:{xs:12,md:2},children:e.jsx(je,{title:"‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶®",value:de.online,bg:"#faf5ff",color:"#9810fa",loading:E})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(je,{title:"‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶®",value:de.offline,bg:"#f3f4f6",color:"#4a5565",loading:E})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(je,{title:"‡¶Ü‡¶ú ‡¶®‡¶§‡ßÅ‡¶®",value:`+${de.newToday}`,bg:"#fff7ed",color:"#f54900",loading:E})})]})]})}),e.jsx(Ie,{sx:{borderRadius:2,boxShadow:"0px 1px 3px 0px #0000001a, 0px 1px 2px -1px #0000001a"},children:e.jsxs(We,{sx:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[e.jsxs(Ze,{sx:{minWidth:180},children:[e.jsx(_e,{children:"‡¶∏‡¶ï‡¶≤ ‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®"}),e.jsxs($e,{label:"‡¶∏‡¶ï‡¶≤ ‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®",value:v,onChange:r=>re(r.target.value),disabled:!v&&N==="MASTER_ADMIN"?!1:n.length<=1,children:[N==="MASTER_ADMIN"&&e.jsx(z,{value:"",children:"‡¶∏‡¶ï‡¶≤ ‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®"}),Array.isArray(n)&&n.map(r=>e.jsx(z,{value:r.code,children:r.name},r.code))]})]}),e.jsx(g,{sx:{minWidth:200},children:e.jsx(ys,{value:ne,onChange:r=>R(r),cityCorporationCode:v,disabled:!v&&N==="MASTER_ADMIN",zones:N==="SUPER_ADMIN"?c:void 0,label:"‡¶∏‡¶ï‡¶≤ ‡¶ú‡ßã‡¶®"})}),e.jsxs(Ze,{sx:{minWidth:150},size:"small",children:[e.jsx(_e,{children:"Status"}),e.jsxs($e,{value:ce,label:"Status",onChange:r=>{ue(r.target.value),J(1)},children:[e.jsx(z,{value:"ALL",children:"All"}),e.jsx(z,{value:Ce.ACTIVE,children:"Active"}),e.jsx(z,{value:Ce.INACTIVE,children:"Inactive"}),e.jsx(z,{value:Ce.PENDING,children:"Pending"}),e.jsx(z,{value:Ce.SUSPENDED,children:"Suspended"})]})]}),e.jsx(b,{value:B,onChange:r=>f(r.target.value),placeholder:"‡¶®‡¶æ‡¶Æ/‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®...",fullWidth:!0,InputProps:{startAdornment:e.jsx(Oe,{position:"start",children:e.jsx(os,{sx:{color:"#0a0a0a80"}})})},sx:{maxWidth:500}}),e.jsx(te,{variant:"contained",sx:{bgcolor:"#3fa564"},startIcon:e.jsx(ls,{}),onClick:()=>he(!0),children:"‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®"})]})}),e.jsxs(Ie,{sx:{borderRadius:2,boxShadow:"0px 1px 3px 0px #0000001a, 0px 1px 2px -1px #0000001a"},children:[e.jsx(g,{sx:{width:"100%",p:2,display:"flex",justifyContent:"flex-end"},children:S.length>0&&e.jsxs(te,{variant:"outlined",color:"error",onClick:x,startIcon:e.jsx(Be,{}),children:["Delete Selected (",S.length,")"]})}),e.jsx(g,{sx:{bgcolor:"#f9fafb",borderBottom:"1px solid #e5e7eb",px:3,py:1.5},children:e.jsxs(a,{container:!0,alignItems:"center",children:[e.jsx(a,{item:!0,xs:1,sx:{maxWidth:"50px",flexBasis:"50px"},children:e.jsx(qe,{indeterminate:S.length>0&&S.length<C.length,checked:C.length>0&&S.length===C.length,onChange:h})}),e.jsx(a,{item:!0,xs:2.5,children:e.jsx(s,{sx:{color:"#364153",fontWeight:700,fontSize:14},children:"‡¶è‡¶°‡¶Æ‡¶ø‡¶®"})}),e.jsx(a,{item:!0,xs:3,children:e.jsx(s,{sx:{color:"#364153",fontWeight:700,fontSize:14},children:"‡¶è‡¶≤‡¶æ‡¶ï‡¶æ"})}),e.jsx(a,{item:!0,xs:2,children:e.jsx(s,{sx:{color:"#364153",fontWeight:700,fontSize:14},children:"‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏"})}),e.jsx(a,{item:!0,xs:3.5,children:e.jsx(s,{sx:{color:"#364153",fontWeight:700,fontSize:14},children:"‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶®"})})]})}),e.jsxs(We,{sx:{px:0},children:[m?e.jsx(g,{sx:{p:3},children:[1,2,3].map(r=>e.jsx(A,{spacing:1,sx:{mb:2},children:e.jsx(ts,{variant:"rectangular",height:60})},r))}):_?e.jsx(g,{sx:{p:3},children:e.jsx(Se,{severity:"error",children:_})}):C.length===0?e.jsx(g,{sx:{p:3,textAlign:"center"},children:e.jsx(s,{color:"text.secondary",children:"‡¶ï‡ßã‡¶®‡ßã ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø"})}):e.jsx(cs,{children:e.jsx(ds,{children:e.jsx(hs,{children:C.map(r=>{var w;const p=S.indexOf(r.id)!==-1;return e.jsxs(xs,{hover:!0,selected:p,children:[e.jsx(be,{padding:"checkbox",sx:{width:"50px"},children:e.jsx(qe,{checked:p,onChange:()=>y(r.id)})}),e.jsx(be,{sx:{width:"25%"},children:e.jsxs(A,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(Me,{src:r.avatar,alt:`${r.firstName} ${r.lastName}`,sx:{bgcolor:"#2b7fff"},children:r.firstName.charAt(0)}),e.jsxs(g,{children:[e.jsxs(s,{sx:{fontSize:16,fontWeight:700},children:[r.firstName," ",r.lastName]}),e.jsx(s,{sx:{fontSize:14,color:"#4a5565"},children:r.phone})]})]})}),e.jsx(be,{sx:{width:"30%"},children:e.jsxs(A,{spacing:.5,children:[e.jsx(s,{sx:{fontSize:16,color:"#1e2939"},children:((w=r.cityCorporation)==null?void 0:w.name)||"N/A"}),e.jsxs(A,{direction:"row",spacing:.5,flexWrap:"wrap",useFlexGap:!0,sx:{mt:.5},children:[r.zone?e.jsx(se,{label:r.zone.name,size:"small",variant:"outlined",color:"primary",sx:{height:24}}):null,r.ward?e.jsx(se,{label:`Ward ${r.ward.wardNumber}`,size:"small",variant:"outlined",sx:{height:24}}):null,r.extraWards&&r.extraWards.length>0&&e.jsx(se,{label:`+${r.extraWards.length} Wards`,size:"small",variant:"outlined",color:"info",sx:{height:24}}),!r.zone&&!r.ward&&(!r.extraWards||r.extraWards.length===0)&&e.jsx(s,{variant:"caption",color:"text.secondary",children:"N/A"})]}),r.address&&e.jsxs(s,{sx:{fontSize:12,color:"#6b7280",mt:.5},children:["üìç ",r.address]})]})}),e.jsx(be,{sx:{width:"15%"},children:e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(se,{label:r.status==="ACTIVE"?"‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º":"‡¶®‡¶ø‡¶∑‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º",size:"small",sx:{bgcolor:r.status==="ACTIVE"?"#dcfce7":"#fee2e2",color:r.status==="ACTIVE"?"#008236":"#dc2626"}}),e.jsx(s,{sx:{fontSize:12,color:"#6a7282"},children:"‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶®"})]})}),e.jsx(be,{sx:{width:"30%"},children:e.jsxs(A,{direction:"row",spacing:2,alignItems:"center",children:[e.jsxs(A,{children:[e.jsxs(s,{sx:{fontSize:14,color:"#1e2939",fontWeight:700},children:["‡¶Æ‡ßã‡¶ü: ",r.statistics.totalComplaints]}),e.jsxs(A,{direction:"row",spacing:2,children:[e.jsxs(s,{sx:{fontSize:12,color:"#00a63e"},children:["‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®: ",r.statistics.resolvedComplaints]}),e.jsxs(s,{sx:{fontSize:12,color:"#d08700"},children:["‡¶™‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç: ",r.statistics.pendingComplaints]})]})]}),e.jsx(me,{orientation:"vertical",flexItem:!0}),e.jsxs(A,{direction:"row",spacing:1,children:[e.jsx(U,{size:"small",color:"primary",onClick:()=>{ve("Direct messaging coming soon!",{icon:"üí¨"})},children:e.jsx(ps,{})}),e.jsx(U,{size:"small",onClick:()=>{I(r),le(!0)},children:e.jsx(fs,{})}),e.jsx(U,{size:"small",onClick:()=>{I(r),ie(!0)},children:e.jsx(us,{})}),e.jsx(U,{size:"small",color:"error",onClick:()=>{I(r),oe(!0)},children:e.jsx(Be,{})})]})]})})]},r.id)})})})}),!m&&!_&&G>1&&e.jsx(g,{sx:{display:"flex",justifyContent:"center",mt:3,mb:2},children:e.jsx(gs,{count:G,page:q,onChange:(r,p)=>J(p),color:"primary"})})]})]}),e.jsx(ws,{open:ae,onClose:()=>he(!1),onSuccess:()=>{K(),ee()}}),e.jsx(bs,{open:xe,onClose:()=>{ie(!1),I(null)},onSuccess:async()=>{await K(),ee()},admin:k}),e.jsx(Cs,{open:P,onClose:()=>{le(!1),I(null)},admin:k}),e.jsxs(Ee,{open:H,onClose:()=>oe(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(De,{children:e.jsx(s,{sx:{fontWeight:700},children:"‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡ßÅ‡¶®"})}),e.jsx(Ne,{children:e.jsxs(s,{children:["‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶Ø‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ",k==null?void 0:k.firstName," ",k==null?void 0:k.lastName," ‡¶ï‡ßá ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶§‡ßá ‡¶ö‡¶æ‡¶®?"]})}),e.jsxs(Pe,{children:[e.jsx(te,{variant:"outlined",onClick:()=>oe(!1),children:"‡¶¨‡¶æ‡¶§‡¶ø‡¶≤"}),e.jsx(te,{variant:"contained",color:"error",onClick:t,children:"‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡ßÅ‡¶®"})]})]})]})}):e.jsx(Je,{title:"Admin Management",children:e.jsx(Se,{severity:"error",children:"You do not have permission to access this page."})})};export{Es as default};
