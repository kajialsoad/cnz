import{j as e,s as Ne,t as De,T as s,i as q,v as Oe,w as Me,A as ze,az as a,B as g,H as Pe,aX as He,y as Qe,g as C,a1 as A,bf as Ke,p as oe,I as Te,V as Ye,l as es,bg as ss,x as ke,b as ne,C as Re,bh as I,D as be,bi as os,bj as ns,bk as Xe,bl as Ue,bm as as,e as We,f as Ee,_ as Ze,av as _e,$ as $e,Z as is,bn as ls,bo as qe,m as Be,G as rs,ap as cs,aq as ds,au as hs,as as xs,at as Ce,bd as ps,bp as fs,bq as us,aW as ms}from"./mui-vendor-Brc-2iiC.js";import{r as l,a as gs}from"./react-vendor-D7yrL1sD.js";import{d as Ve,k as ts,w as Ae,u as Le,U as ve,e as js,M as Je,Z as ys,n as Se}from"./index-DBuvollO.js";import{userManagementService as ue}from"./userManagementService-BZHXGcnY.js";import"./query-vendor-CZVuOxbJ.js";import"./chart-vendor-CrjdDA16.js";const Ge={zones:[],wards:[],categories:[],features:{canViewComplaints:!0,canApproveComplaints:!1,canRejectComplaints:!1,canMarkComplaintsPending:!1,canEditComplaints:!1,canDeleteComplaints:!1,canViewUsers:!0,canEditUsers:!1,canDeleteUsers:!1,canAddUsers:!1,canViewAdmins:!1,canEditAdmins:!1,canDeleteAdmins:!1,canAddAdmins:!1,canViewMessages:!0,canSendMessagesToUsers:!1,canSendMessagesToAdmins:!1,canViewAnalytics:!1,canExportData:!1,canDownloadReports:!1,viewOnlyMode:!1,canViewComplainantProfile:!1,canViewAreaStats:!1,canViewOwnPerformance:!1,canShowReviews:!1}},ws=({open:o,onClose:P,onSuccess:v})=>{const[d,y]=l.useState({firstName:"",lastName:".",designation:"",email:"",phone:"",whatsapp:"",joiningDate:new Date().toISOString().split("T")[0],address:"",password:"",confirmPassword:"",cityCorporationCode:"",zoneId:"",wardId:"",role:"ADMIN",permissions:JSON.parse(JSON.stringify(Ge))}),[i,D]=l.useState([]),[B,J]=l.useState([]),[G,H]=l.useState([]),[f,Q]=l.useState([]),[K,Y]=l.useState(!1),[me,re]=l.useState(!1),[L,S]=l.useState(!1),[ae,ie]=l.useState(!1),[O,le]=l.useState({}),[fe,ce]=l.useState(!1),[de,F]=l.useState(null);l.useEffect(()=>{o&&(he(),y({firstName:"",lastName:".",designation:"",email:"",phone:"",whatsapp:"",joiningDate:new Date().toISOString().split("T")[0],address:"",password:"",confirmPassword:"",cityCorporationCode:"",zoneId:"",wardId:"",role:"ADMIN",permissions:JSON.parse(JSON.stringify(Ge))}),le({}),F(null))},[o]);const he=async()=>{try{Y(!0);const n=await Ve.getCityCorporations("ACTIVE");D(n.cityCorporations||[])}catch(n){console.error("Error fetching city corporations:",n)}finally{Y(!1)}},T=async n=>{try{re(!0);const u=await ts.getZones({cityCorporationCode:n,status:"ACTIVE"});J(u.zones||[])}catch(u){console.error("Error fetching zones:",u)}finally{re(!1)}},xe=async n=>{try{S(!0);const u=await Ae.getWards({zoneId:n,status:"ACTIVE"});H(u.wards||[])}catch(u){console.error("Error fetching wards:",u)}finally{S(!1)}},R=async n=>{try{const u=await Ae.getWards({cityCorporationCode:n,status:"ACTIVE"});Q(u.wards||[])}catch(u){console.error("Error fetching all wards:",u)}},W=n=>u=>{const c=u.target.value;y(j=>({...j,[n]:c})),n==="cityCorporationCode"?(y(j=>({...j,cityCorporationCode:c,zoneId:"",wardId:"",permissions:{...j.permissions,wards:[]}})),T(c),R(c)):n==="zoneId"&&(y(j=>({...j,zoneId:c,wardId:""})),xe(parseInt(c))),O[n]&&le(j=>({...j,[n]:void 0}))},z=(n,u)=>{const c=u.map(j=>j.id);y(j=>({...j,permissions:{...j.permissions,wards:c}}))},ee=n=>{y(u=>{const c={...u.permissions.features};if(n==="viewOnlyMode"){const j=!c.viewOnlyMode;j&&Object.keys(c).forEach(M=>{M!=="viewOnlyMode"&&(c[M]=!1)}),c.viewOnlyMode=j}else if(n==="actionApproval"){const M=!c.canApproveComplaints;c.canApproveComplaints=M,c.canRejectComplaints=M,c.canMarkComplaintsPending=M,c.canEditComplaints=M,c.canEditUsers=M,c.canDeleteUsers=M,M&&(c.viewOnlyMode=!1)}else if(n==="reportDownload"){const j=!c.canDownloadReports;c.canDownloadReports=j,c.canExportData=j,c.canViewAnalytics=j,j&&(c.viewOnlyMode=!1)}else c[n]=!c[n],c[n]&&(c.viewOnlyMode=!1);return{...u,permissions:{...u.permissions,features:c}}})},pe=()=>{const n={};return d.firstName.trim()||(n.firstName="Name is required"),d.phone.trim()||(n.phone="Phone is required"),d.password||(n.password="Password is required"),d.cityCorporationCode||(n.cityCorporationCode="City Corporation is required"),d.zoneId||(n.zoneId="Zone is required"),d.email.trim()&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email.trim())&&(n.email="Invalid email format"),le(n),Object.keys(n).length===0},ge=async()=>{var n,u,c,j,M,se,X,je,N;if(pe()){ce(!0),F(null);try{const m={firstName:d.firstName.trim(),lastName:d.lastName.trim()||"Admin",email:d.email.trim()||void 0,phone:d.phone.trim(),whatsapp:d.whatsapp.trim()||void 0,joiningDate:d.joiningDate||void 0,address:d.address.trim()||void 0,password:d.password,role:d.role,cityCorporationCode:d.cityCorporationCode||void 0,zoneId:d.zoneId?parseInt(d.zoneId):void 0,wardId:d.wardId?parseInt(d.wardId):void 0,permissions:d.permissions};console.log("üì§ Sending create admin data:",{...m,password:"***"}),console.log("üì§ Data types:",{firstName:typeof m.firstName,lastName:typeof m.lastName,email:typeof m.email,phone:typeof m.phone,whatsapp:typeof m.whatsapp,joiningDate:typeof m.joiningDate,address:typeof m.address,password:typeof m.password,role:typeof m.role,cityCorporationCode:typeof m.cityCorporationCode,zoneId:typeof m.zoneId,wardId:typeof m.wardId,permissions:typeof m.permissions}),console.log("üì§ Permissions structure:",JSON.stringify(m.permissions,null,2)),await ue.createUser(m),v(),P()}catch(m){if(console.error("‚ùå Error creating admin:",m),console.error("‚ùå Error response:",m.response),console.error("‚ùå Error response data:",(n=m.response)==null?void 0:n.data),console.error("‚ùå Error status:",(u=m.response)==null?void 0:u.status),console.error("‚ùå Error config:",m.config),console.error("‚ùå Error request:",m.request),!m.response){console.error("‚ùå NETWORK ERROR: No response received from server"),console.error("‚ùå This could be: CORS, timeout, or server crash"),F("Network error: Could not connect to server. Please check if the server is running."),ce(!1);return}const U=((j=(c=m.response)==null?void 0:c.data)==null?void 0:j.message)||((X=(se=(M=m.response)==null?void 0:M.data)==null?void 0:se.error)==null?void 0:X.message)||m.message||"Failed to create admin";(N=(je=m.response)==null?void 0:je.data)!=null&&N.errors&&console.error("‚ùå Validation errors:",JSON.stringify(m.response.data.errors,null,2)),F(U)}finally{ce(!1)}}};return e.jsxs(Ne,{open:o,onClose:P,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[e.jsxs(De,{component:"div",sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[e.jsx(s,{variant:"h6",fontWeight:"bold",children:"‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®"}),e.jsx(q,{onClick:P,size:"small",children:e.jsx(Oe,{})})]}),e.jsxs(Me,{dividers:!0,sx:{p:3},children:[de&&e.jsx(ze,{severity:"error",sx:{mb:2},children:de}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsxs(a,{size:{xs:12,md:3},display:"flex",flexDirection:"column",alignItems:"center",children:[e.jsxs(g,{sx:{position:"relative",mb:2},children:[e.jsx(Pe,{sx:{width:120,height:120,bgcolor:"#f0f0f0"},children:e.jsx(He,{sx:{fontSize:50,color:"#bdbdbd"}})}),e.jsx(q,{sx:{position:"absolute",bottom:0,right:0,bgcolor:"#4caf50",color:"white","&:hover":{bgcolor:"#45a049"},padding:"4px"},size:"small",children:e.jsx(Qe,{fontSize:"small"})})]}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶õ‡¶¨‡¶ø"})]}),e.jsx(a,{size:{xs:12,md:9},children:e.jsxs(a,{container:!0,spacing:2,children:[e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶®‡¶æ‡¶Æ"}),e.jsx(C,{fullWidth:!0,placeholder:"‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®...",value:d.firstName,onChange:W("firstName"),error:!!O.firstName,size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶™‡¶¶‡¶¨‡ßÄ"}),e.jsx(C,{fullWidth:!0,placeholder:"‡¶™‡¶¶‡¶¨‡ßÄ...",value:d.designation,onChange:W("designation"),size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶´‡ßã‡¶®"}),e.jsx(C,{fullWidth:!0,placeholder:"01XXXXXXXXX",value:d.phone,onChange:W("phone"),error:!!O.phone,size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶π‡ßã‡ßü‡¶æ‡¶ü‡¶∏‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™"}),e.jsx(C,{fullWidth:!0,placeholder:"01XXXXXXXXX",value:d.whatsapp,onChange:W("whatsapp"),size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶á‡¶Æ‡ßá‡¶á‡¶≤"}),e.jsx(C,{fullWidth:!0,placeholder:"example@email.com",value:d.email,onChange:W("email"),error:!!O.email,helperText:O.email,size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶ú‡ßü‡ßá‡¶®‡¶ø‡¶Ç ‡¶°‡ßá‡¶ü"}),e.jsx(C,{fullWidth:!0,type:"date",value:d.joiningDate,onChange:W("joiningDate"),size:"small",InputLabelProps:{shrink:!0}})]}),e.jsxs(a,{size:12,children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ"}),e.jsx(C,{fullWidth:!0,placeholder:"‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ...",value:d.address,onChange:W("address"),size:"small",multiline:!0,rows:2})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®"}),e.jsxs(C,{select:!0,fullWidth:!0,value:d.cityCorporationCode,onChange:W("cityCorporationCode"),error:!!O.cityCorporationCode,size:"small",SelectProps:{displayEmpty:!0},children:[e.jsx(A,{value:"",disabled:!0,children:"‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶® ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."}),i.map(n=>e.jsx(A,{value:n.code,children:n.name},n.code))]})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶ú‡ßã‡¶®"}),e.jsxs(C,{select:!0,fullWidth:!0,value:d.zoneId,onChange:W("zoneId"),error:!!O.zoneId,disabled:!d.cityCorporationCode,size:"small",SelectProps:{displayEmpty:!0},children:[e.jsx(A,{value:"",disabled:!0,children:"‡¶ú‡ßã‡¶® ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."}),B.map(n=>e.jsx(A,{value:n.id.toString(),children:n.name||`Zone ${n.zoneNumber}`},n.id))]})]}),e.jsxs(a,{size:12,children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶è‡¶∞‡¶ø‡ßü‡¶æ (‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°)"}),e.jsx(Ke,{multiple:!0,options:f,getOptionLabel:n=>`Ward ${n.wardNumber}${n.zone?` (Zone ${n.zone.zoneNumber})`:""}`,value:f.filter(n=>d.permissions.wards.includes(n.id)),onChange:z,disabled:!d.cityCorporationCode,size:"small",renderTags:(n,u)=>n.map((c,j)=>{const{key:M,...se}=u({index:j});return e.jsx(oe,{label:`Ward ${c.wardNumber}`,size:"small",...se},M)}),renderInput:n=>e.jsx(C,{...n,placeholder:d.permissions.wards.length>0?"":"‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."})}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶®‡ßã‡¶ü: ‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞‡¶ø ‡¶ú‡ßã‡¶®‡ßá‡¶∞ ‡¶¨‡¶æ‡¶á‡¶∞‡ßá‡¶∞ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¨‡¶æ ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§"})]}),e.jsxs(a,{size:12,children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°"}),e.jsx(C,{fullWidth:!0,type:ae?"text":"password",value:d.password,onChange:W("password"),error:!!O.password,size:"small",InputProps:{endAdornment:e.jsx(Te,{position:"end",children:e.jsx(q,{onClick:()=>ie(!ae),edge:"end",size:"small",children:ae?e.jsx(Ye,{}):e.jsx(es,{})})})}})]})]})}),e.jsx(a,{size:12,children:e.jsxs(g,{sx:{bgcolor:"#f5f5f5",p:2,borderRadius:2,mt:2},children:[e.jsx(s,{variant:"subtitle2",fontWeight:"bold",mb:2,children:"‡¶™‡¶æ‡¶∞‡¶Æ‡¶ø‡¶∂‡¶® ‡¶ì ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤"}),e.jsx(a,{container:!0,spacing:2,children:[{label:"‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶ü‡ßÅ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞",key:"canSendMessagesToUsers"},{label:"‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶ü‡ßÅ ‡¶∏‡ßÅ‡¶™‡¶æ‡¶∞ ‡¶è‡¶°‡¶Æ‡¶ø‡¶®",key:"canSendMessagesToAdmins"},{label:"‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤",key:"canViewComplainantProfile"},{label:"‡¶è‡¶∞‡¶ø‡ßü‡¶æ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏",key:"canViewAreaStats"},{label:"‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶™‡¶æ‡¶∞‡¶´‡¶∞‡¶Æ‡ßá‡¶®‡ßç‡¶∏",key:"canViewOwnPerformance"},{label:"‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â",key:"canShowReviews"},{label:"‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°",key:"reportDownload"},{label:"‡¶è‡¶ï‡¶∂‡¶® ‡¶è‡¶™‡ßç‡¶∞‡ßÅ‡¶≠‡¶æ‡¶≤",key:"actionApproval"},{label:"‡¶≠‡¶ø‡¶â ‡¶Ö‡¶®‡¶≤‡¶ø",key:"viewOnlyMode"}].map(n=>{let u=!1;n.key==="actionApproval"?u=d.permissions.features.canApproveComplaints:n.key==="reportDownload"?u=d.permissions.features.canDownloadReports:u=!!d.permissions.features[n.key];const c=d.permissions.features.viewOnlyMode&&n.key!=="viewOnlyMode";return e.jsx(a,{size:{xs:12,sm:6,md:4},children:e.jsxs(g,{display:"flex",justifyContent:"space-between",alignItems:"center",p:1,bgcolor:"white",borderRadius:1,border:"1px solid #eee",children:[e.jsx(s,{variant:"body2",color:c?"text.disabled":"text.primary",children:n.label}),e.jsx(ss,{checked:u,onChange:()=>ee(n.key),color:"success",size:"small",disabled:c})]})},n.key)})})]})})]})]}),e.jsxs(ke,{sx:{p:2,display:"flex",gap:1},children:[e.jsx(ne,{onClick:P,variant:"outlined",color:"inherit",fullWidth:!0,sx:{borderColor:"#ddd",color:"#666"},children:"‡¶¨‡¶æ‡¶§‡¶ø‡¶≤"}),e.jsx(ne,{onClick:ge,variant:"contained",color:"success",fullWidth:!0,disabled:fe,sx:{bgcolor:"#4caf50","&:hover":{bgcolor:"#45a049"}},children:fe?e.jsx(Re,{size:24,color:"inherit"}):"‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®"})]})]})},ye={zones:[],wards:[],categories:[],features:{canViewComplaints:!0,canApproveComplaints:!1,canRejectComplaints:!1,canMarkComplaintsPending:!1,canEditComplaints:!1,canDeleteComplaints:!1,canViewUsers:!0,canEditUsers:!1,canDeleteUsers:!1,canAddUsers:!1,canViewAdmins:!1,canEditAdmins:!1,canDeleteAdmins:!1,canAddAdmins:!1,canViewMessages:!0,canSendMessagesToUsers:!1,canSendMessagesToAdmins:!1,canViewAnalytics:!1,canExportData:!1,canDownloadReports:!1,viewOnlyMode:!1,canViewComplainantProfile:!1,canViewAreaStats:!1,canViewOwnPerformance:!1,canShowReviews:!1}},bs=({admin:o,open:P,onClose:v,onSuccess:d})=>{var m,U,te;const{user:y}=Le(),[i,D]=l.useState({firstName:"",lastName:"",designation:"",email:"",phone:"",whatsapp:"",joiningDate:"",address:"",cityCorporationCode:"",zoneId:"",wardId:"",role:"ADMIN",status:"ACTIVE",newPassword:"",confirmPassword:"",permissions:JSON.parse(JSON.stringify(ye))}),[B,J]=l.useState([]),[G,H]=l.useState([]),[f,Q]=l.useState([]),[K,Y]=l.useState([]),[me,re]=l.useState(!1),[L,S]=l.useState(!1),[ae,ie]=l.useState(!1),[O,le]=l.useState(null),[fe,ce]=l.useState(null),de=gs.useRef(null),[F,he]=l.useState(!1),[T,xe]=l.useState({}),[R,W]=l.useState(!1),[z,ee]=l.useState(null);l.useEffect(()=>{var r,x,h,w,k,t,p,b,Ie;if(P&&o){let Z=JSON.parse(JSON.stringify(ye));if(o.permissions)if(typeof o.permissions=="string")try{const E=JSON.parse(o.permissions);Z={...ye,...E,features:{...ye.features,...E.features}}}catch(E){console.error("Failed to parse permissions string",E)}else Z={...ye,...o.permissions,features:{...ye.features,...o.permissions.features}};D({firstName:o.firstName||"",lastName:o.lastName||"",designation:o.designation||"",email:o.email||"",phone:o.phone||"",whatsapp:o.whatsapp||"",joiningDate:o.joiningDate?new Date(o.joiningDate).toISOString().split("T")[0]:"",address:o.address||"",cityCorporationCode:((r=o.cityCorporation)==null?void 0:r.code)||o.cityCorporationCode||"",zoneId:((h=(x=o.zone)==null?void 0:x.id)==null?void 0:h.toString())||((w=o.zoneId)==null?void 0:w.toString())||"",wardId:((t=(k=o.ward)==null?void 0:k.id)==null?void 0:t.toString())||((p=o.wardId)==null?void 0:p.toString())||"",role:o.role,status:o.status,newPassword:"",confirmPassword:"",permissions:Z}),pe();const V=((b=o.cityCorporation)==null?void 0:b.code)||o.cityCorporationCode;if(V){ge(V),u(V);const E=((Ie=o.zone)==null?void 0:Ie.id)||o.zoneId;E&&n(E)}xe({}),ee(null),le(null),ce(o.avatar||null)}},[P,o]);const pe=async()=>{try{re(!0);const r=await Ve.getCityCorporations("ACTIVE");J(r.cityCorporations||[])}catch(r){console.error("Error fetching city corporations:",r)}finally{re(!1)}},ge=async r=>{try{S(!0);const x=await ts.getZones({cityCorporationCode:r,status:"ACTIVE"});H(x.zones||[])}catch(x){console.error("Error fetching zones:",x)}finally{S(!1)}},n=async r=>{try{ie(!0);const x=await Ae.getWards({zoneId:r,status:"ACTIVE"});Q(x.wards||[])}catch(x){console.error("Error fetching wards:",x)}finally{ie(!1)}},u=async r=>{try{const x=await Ae.getWards({cityCorporationCode:r,status:"ACTIVE"});Y(x.wards||[])}catch(x){console.error("Error fetching all wards:",x)}},c=r=>x=>{const h=x.target.value;D(w=>({...w,[r]:h})),r==="cityCorporationCode"?(D(w=>({...w,cityCorporationCode:h,zoneId:"",wardId:"",permissions:{...w.permissions,wards:[]}})),ge(h),u(h)):r==="zoneId"&&(D(w=>({...w,zoneId:h,wardId:""})),n(parseInt(h))),T[r]&&xe(w=>({...w,[r]:void 0}))},j=(r,x)=>{const h=x.map(w=>w.id);D(w=>({...w,permissions:{...w.permissions,wards:h}}))},M=r=>{var h;const x=(h=r.target.files)==null?void 0:h[0];x&&(le(x),ce(URL.createObjectURL(x)))},se=()=>{var r;(r=de.current)==null||r.click()},X=r=>{D(x=>{const h={...x.permissions.features};if(r==="viewOnlyMode"){const w=!h.viewOnlyMode;w&&Object.keys(h).forEach(k=>{k!=="viewOnlyMode"&&(h[k]=!1)}),h.viewOnlyMode=w}else if(r==="actionApproval"){const k=!h.canApproveComplaints;h.canApproveComplaints=k,h.canRejectComplaints=k,h.canMarkComplaintsPending=k,h.canEditComplaints=k,h.canEditUsers=k,h.canDeleteUsers=k,k&&(h.viewOnlyMode=!1)}else if(r==="reportDownload"){const w=!h.canDownloadReports;h.canDownloadReports=w,h.canExportData=w,h.canViewAnalytics=w,w&&(h.viewOnlyMode=!1)}else h[r]=!h[r],h[r]&&(h.viewOnlyMode=!1);return{...x,permissions:{...x.permissions,features:h}}})},je=()=>{const r={};return i.firstName.trim()||(r.firstName="First Name is required"),i.lastName.trim()||(r.lastName="Last Name is required"),i.phone.trim()||(r.phone="Phone is required"),i.cityCorporationCode||(r.cityCorporationCode="City Corporation is required"),i.zoneId||(r.zoneId="Zone is required"),i.email.trim()&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.email.trim())&&(r.email="Invalid email format"),i.newPassword&&i.newPassword.length<8&&(r.newPassword="Password must be at least 8 characters"),i.newPassword!==i.confirmPassword&&(r.confirmPassword="Passwords do not match"),xe(r),Object.keys(r).length===0},N=async()=>{if(!(!je()||!o)){W(!0),ee(null);try{let r=o.avatar;if(O)try{r=await ue.uploadAvatar(O)}catch(h){throw console.error("Error uploading avatar:",h),new Error("Failed to upload profile picture")}const x={firstName:i.firstName,lastName:i.lastName,designation:i.designation,email:i.email,phone:i.phone,whatsapp:i.whatsapp,joiningDate:i.joiningDate,address:i.address,role:i.role,status:i.status,cityCorporationCode:i.cityCorporationCode,zoneId:parseInt(i.zoneId),wardId:i.wardId?parseInt(i.wardId):void 0,permissions:i.permissions,avatar:r||void 0};i.newPassword&&(x.password=i.newPassword),await ue.updateUser(o.id,x),d(),v()}catch(r){console.error("Error updating admin:",r),ee(r.message||"Failed to update admin")}finally{W(!1)}}};return e.jsxs(Ne,{open:P,onClose:v,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[e.jsxs(De,{component:"div",sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[e.jsx(s,{variant:"h6",fontWeight:"bold",children:"‡¶è‡¶°‡¶ø‡¶ü ‡¶è‡¶°‡¶Æ‡¶ø‡¶®"}),e.jsx(q,{onClick:v,size:"small",children:e.jsx(Oe,{})})]}),e.jsxs(Me,{dividers:!0,sx:{p:3},children:[z&&e.jsx(ze,{severity:"error",sx:{mb:2},children:z}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsxs(a,{size:{xs:12,md:3},display:"flex",flexDirection:"column",alignItems:"center",children:[e.jsxs(g,{sx:{position:"relative",mb:2},children:[e.jsx("input",{type:"file",ref:de,style:{display:"none"},accept:"image/*",onChange:M}),e.jsx(Pe,{src:fe||void 0,sx:{width:120,height:120,bgcolor:"#f0f0f0"},children:e.jsx(He,{sx:{fontSize:50,color:"#bdbdbd"}})}),e.jsx(q,{onClick:se,sx:{position:"absolute",bottom:0,right:0,bgcolor:"#4caf50",color:"white","&:hover":{bgcolor:"#45a049"},padding:"4px"},size:"small",children:e.jsx(Qe,{fontSize:"small"})})]}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶õ‡¶¨‡¶ø"})]}),e.jsx(a,{size:{xs:12,md:9},children:e.jsxs(a,{container:!0,spacing:2,children:[e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶Ö‡¶Ç‡¶∂"}),e.jsx(C,{fullWidth:!0,placeholder:"‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶Ö‡¶Ç‡¶∂...",value:i.firstName,onChange:c("firstName"),error:!!T.firstName,size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶∂‡ßá‡¶∑ ‡¶Ö‡¶Ç‡¶∂"}),e.jsx(C,{fullWidth:!0,placeholder:"‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶∂‡ßá‡¶∑ ‡¶Ö‡¶Ç‡¶∂...",value:i.lastName,onChange:c("lastName"),error:!!T.lastName,size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶™‡¶¶‡¶¨‡ßÄ"}),e.jsx(C,{fullWidth:!0,placeholder:"‡¶™‡¶¶‡¶¨‡ßÄ...",value:i.designation,onChange:c("designation"),size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶´‡ßã‡¶®"}),e.jsx(C,{fullWidth:!0,placeholder:"01XXXXXXXXX",value:i.phone,onChange:c("phone"),error:!!T.phone,size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶π‡ßã‡ßü‡¶æ‡¶ü‡¶∏‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™"}),e.jsx(C,{fullWidth:!0,placeholder:"01XXXXXXXXX",value:i.whatsapp,onChange:c("whatsapp"),size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶á‡¶Æ‡ßá‡¶á‡¶≤"}),e.jsx(C,{fullWidth:!0,placeholder:"example@email.com",value:i.email,onChange:c("email"),size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶ú‡ßü‡ßá‡¶®‡¶ø‡¶Ç ‡¶°‡ßá‡¶ü"}),e.jsx(C,{fullWidth:!0,type:"date",value:i.joiningDate,onChange:c("joiningDate"),size:"small",InputLabelProps:{shrink:!0}})]}),e.jsxs(a,{size:12,children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ"}),e.jsx(C,{fullWidth:!0,placeholder:"‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ...",value:i.address,onChange:c("address"),size:"small",multiline:!0,rows:2})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®"}),e.jsxs(C,{select:!0,fullWidth:!0,value:i.cityCorporationCode,onChange:c("cityCorporationCode"),error:!!T.cityCorporationCode,disabled:(y==null?void 0:y.role)!=="MASTER_ADMIN",size:"small",SelectProps:{displayEmpty:!0},children:[e.jsx(A,{value:"",disabled:!0,children:"‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶® ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."}),i.cityCorporationCode&&!B.find(r=>r.code===i.cityCorporationCode)&&e.jsx(A,{value:i.cityCorporationCode,sx:{display:"none"},children:((m=o==null?void 0:o.cityCorporation)==null?void 0:m.name)||i.cityCorporationCode}),B.map(r=>e.jsx(A,{value:r.code,children:r.name},r.code))]})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶ú‡ßã‡¶®"}),e.jsxs(C,{select:!0,fullWidth:!0,value:i.zoneId,onChange:c("zoneId"),error:!!T.zoneId,disabled:(y==null?void 0:y.role)!=="MASTER_ADMIN"||!i.cityCorporationCode,size:"small",SelectProps:{displayEmpty:!0},children:[e.jsx(A,{value:"",disabled:!0,children:"‡¶ú‡ßã‡¶® ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."}),i.zoneId&&!G.find(r=>r.id.toString()===i.zoneId)&&e.jsx(A,{value:i.zoneId,sx:{display:"none"},children:((U=o==null?void 0:o.zone)==null?void 0:U.name)||`Zone ${(te=o==null?void 0:o.zone)==null?void 0:te.zoneNumber}`||i.zoneId}),G.map(r=>e.jsx(A,{value:r.id.toString(),children:r.name||`Zone ${r.zoneNumber}`},r.id))]})]}),e.jsxs(a,{size:12,children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶è‡¶∞‡¶ø‡ßü‡¶æ (‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°)"}),e.jsx(Ke,{multiple:!0,options:K,getOptionLabel:r=>`Ward ${r.wardNumber}${r.zone?` (Zone ${r.zone.zoneNumber})`:""}`,value:K.filter(r=>i.permissions.wards.includes(r.id)),onChange:j,disabled:(y==null?void 0:y.role)!=="MASTER_ADMIN"||!i.cityCorporationCode,size:"small",renderTags:(r,x)=>r.map((h,w)=>{const{key:k,...t}=x({index:w});return e.jsx(oe,{label:`Ward ${h.wardNumber}`,size:"small",...t,disabled:(y==null?void 0:y.role)!=="MASTER_ADMIN"},k)}),renderInput:r=>e.jsx(C,{...r,placeholder:i.permissions.wards.length>0?"":"‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."})}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶®‡ßã‡¶ü: ‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞‡¶ø ‡¶ú‡ßã‡¶®‡ßá‡¶∞ ‡¶¨‡¶æ‡¶á‡¶∞‡ßá‡¶∞ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¨‡¶æ ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏"}),e.jsxs(C,{select:!0,fullWidth:!0,value:i.status,onChange:c("status"),size:"small",children:[e.jsx(A,{value:"ACTIVE",children:"Active"}),e.jsx(A,{value:"INACTIVE",children:"Inactive"}),e.jsx(A,{value:"SUSPENDED",children:"Suspended"}),e.jsx(A,{value:"PENDING",children:"Pending"})]})]}),e.jsx(a,{size:12,children:(y==null?void 0:y.role)==="MASTER_ADMIN"&&e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° (‡¶Ö‡¶™‡¶∂‡¶®‡¶æ‡¶≤)"}),e.jsx(C,{fullWidth:!0,type:F?"text":"password",value:i.newPassword,onChange:c("newPassword"),error:!!T.newPassword,helperText:T.newPassword,size:"small",InputProps:{endAdornment:e.jsx(Te,{position:"end",children:e.jsx(q,{onClick:()=>he(!F),edge:"end",size:"small",children:F?e.jsx(Ye,{}):e.jsx(es,{})})})}}),e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,mt:2,children:"‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®"}),e.jsx(C,{fullWidth:!0,type:F?"text":"password",value:i.confirmPassword,onChange:c("confirmPassword"),error:!!T.confirmPassword,helperText:T.confirmPassword,size:"small",placeholder:"‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶Ø‡¶º ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®"})]})})]})}),e.jsx(a,{size:12,children:e.jsxs(g,{sx:{bgcolor:"#f5f5f5",p:2,borderRadius:2,mt:2},children:[e.jsx(s,{variant:"subtitle2",fontWeight:"bold",mb:2,children:"‡¶™‡¶æ‡¶∞‡¶Æ‡¶ø‡¶∂‡¶® ‡¶ì ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤"}),e.jsx(a,{container:!0,spacing:2,children:[{label:"‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶ü‡ßÅ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞",key:"canSendMessagesToUsers"},{label:"‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶ü‡ßÅ ‡¶∏‡ßÅ‡¶™‡¶æ‡¶∞ ‡¶è‡¶°‡¶Æ‡¶ø‡¶®",key:"canSendMessagesToAdmins"},{label:"‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤",key:"canViewComplainantProfile"},{label:"‡¶è‡¶∞‡¶ø‡ßü‡¶æ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏",key:"canViewAreaStats"},{label:"‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶™‡¶æ‡¶∞‡¶´‡¶∞‡¶Æ‡ßá‡¶®‡ßç‡¶∏",key:"canViewOwnPerformance"},{label:"‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â",key:"canShowReviews"},{label:"‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°",key:"reportDownload"},{label:"‡¶è‡¶ï‡¶∂‡¶® ‡¶è‡¶™‡ßç‡¶∞‡ßÅ‡¶≠‡¶æ‡¶≤",key:"actionApproval"},{label:"‡¶≠‡¶ø‡¶â ‡¶Ö‡¶®‡¶≤‡¶ø",key:"viewOnlyMode"}].map(r=>{let x=!1;r.key==="actionApproval"?x=i.permissions.features.canApproveComplaints:r.key==="reportDownload"?x=i.permissions.features.canDownloadReports:x=!!i.permissions.features[r.key];const h=i.permissions.features.viewOnlyMode&&r.key!=="viewOnlyMode";return e.jsx(a,{size:{xs:12,sm:6,md:4},children:e.jsxs(g,{display:"flex",justifyContent:"space-between",alignItems:"center",p:1,bgcolor:"white",borderRadius:1,border:"1px solid #eee",children:[e.jsx(s,{variant:"body2",color:h?"text.disabled":"text.primary",children:r.label}),e.jsx(ss,{checked:x,onChange:()=>X(r.key),color:"success",size:"small",disabled:h})]})},r.key)})})]})})]})]}),e.jsxs(ke,{sx:{p:2,display:"flex",gap:1},children:[e.jsx(ne,{onClick:v,variant:"outlined",color:"inherit",fullWidth:!0,sx:{borderColor:"#ddd",color:"#666"},children:"‡¶¨‡¶æ‡¶§‡¶ø‡¶≤"}),e.jsx(ne,{onClick:N,variant:"contained",color:"success",fullWidth:!0,disabled:R,sx:{bgcolor:"#4caf50","&:hover":{bgcolor:"#45a049"}},children:R?e.jsx(Re,{size:24,color:"inherit"}):"‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®"})]})]})},Cs=({open:o,onClose:P,admin:v})=>{var K,Y,me,re;const{user:d}=Le(),[y,i]=l.useState(null),[D,B]=l.useState(!1),[J,G]=l.useState(null);l.useEffect(()=>{o&&(v!=null&&v.id)?H(v.id):(i(null),G(null))},[o,v]);const H=async L=>{try{B(!0),G(null);const S=await ue.getUserById(L);i(S.user)}catch(S){console.error("Error fetching admin details:",S),G("Failed to load latest details")}finally{B(!1)}};if(!v)return null;const f=y||v,Q=L=>L?new Date(L).toLocaleDateString("bn-BD",{year:"numeric",month:"long",day:"numeric"}):"N/A";return e.jsxs(Ne,{open:o,onClose:P,maxWidth:"md",fullWidth:!0,children:[e.jsxs(De,{component:"div",sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(s,{sx:{fontWeight:700},children:"‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§"}),e.jsx(q,{onClick:P,children:e.jsx(Oe,{})})]}),e.jsxs(Me,{dividers:!0,children:[D&&e.jsx(g,{sx:{display:"flex",justifyContent:"center",p:2},children:e.jsx(Re,{size:24})}),J&&e.jsxs(ze,{severity:"warning",sx:{mb:2},children:[J," - Showing cached data"]}),e.jsxs(I,{spacing:3,sx:{opacity:D?.6:1,transition:"opacity 0.2s"},children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(Pe,{sx:{width:80,height:80,bgcolor:"#2b7fff",fontSize:32,fontWeight:700},children:(K=f.firstName)==null?void 0:K.charAt(0)}),e.jsxs(g,{sx:{flex:1},children:[e.jsxs(s,{variant:"h5",sx:{fontWeight:700,mb:.5},children:[f.firstName," ",f.lastName]}),e.jsxs(I,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(oe,{label:f.role,size:"small",sx:{bgcolor:"#eff6ff",color:"#155dfc"}}),e.jsx(oe,{label:f.status==="ACTIVE"?"‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º":"‡¶®‡¶ø‡¶∑‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º",size:"small",sx:{bgcolor:f.status==="ACTIVE"?"#dcfce7":"#fee2e2",color:f.status==="ACTIVE"?"#008236":"#dc2626"}})]})]})]}),e.jsx(be,{}),e.jsxs(g,{children:[e.jsx(s,{variant:"h6",sx:{fontWeight:700,mb:2},children:"‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø"}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{size:{xs:12,sm:6},children:e.jsxs(I,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(os,{sx:{color:"#4a5565"}}),e.jsxs(g,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:f.phone})]})]})}),f.email&&e.jsx(a,{size:{xs:12,sm:6},children:e.jsxs(I,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(ns,{sx:{color:"#4a5565"}}),e.jsxs(g,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶á‡¶Æ‡ßá‡¶á‡¶≤"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:f.email})]})]})}),f.address&&e.jsx(a,{size:{xs:12},children:e.jsxs(I,{direction:"row",spacing:1,alignItems:"flex-start",children:[e.jsx(Xe,{sx:{color:"#4a5565",mt:.5}}),e.jsxs(g,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:f.address})]})]})})]})]}),e.jsx(be,{}),e.jsxs(g,{children:[e.jsx(s,{variant:"h6",sx:{fontWeight:700,mb:2},children:"‡¶è‡¶≤‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø"}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{size:{xs:12,sm:4},children:e.jsxs(I,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Xe,{sx:{color:"#4a5565"}}),e.jsxs(g,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:((Y=f.cityCorporation)==null?void 0:Y.name)||"N/A"})]})]})}),e.jsx(a,{size:{xs:12,sm:4},children:e.jsxs(g,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶ú‡ßã‡¶®"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:((me=f.zone)==null?void 0:me.name)||"‡¶™‡ßç‡¶∞‡¶Ø‡ßã‡¶ú‡ßç‡¶Ø ‡¶®‡ßü"})]})}),f.ward&&e.jsx(a,{size:{xs:12,sm:4},children:e.jsxs(g,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:`‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ${f.ward.wardNumber}`})]})})]}),f.extraWards&&f.extraWards.length>0&&e.jsxs(g,{sx:{mt:2},children:[e.jsx(s,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:.5},children:f.ward?"‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°":"‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶ø‡¶§ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡¶Æ‡ßÇ‡¶π"}),e.jsx(I,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:f.extraWards.map(L=>e.jsx(oe,{label:`‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ${L.wardNumber}`,size:"small",variant:"outlined",sx:{mb:.5}},L.id))})]})]}),e.jsx(be,{}),f.statistics&&e.jsxs(g,{children:[e.jsx(s,{variant:"h6",sx:{fontWeight:700,mb:2},children:"‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶®"}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{size:{xs:6,sm:3},children:e.jsxs(g,{sx:{textAlign:"center",p:2,bgcolor:"#f9fafb",borderRadius:2},children:[e.jsx(s,{variant:"h4",sx:{fontWeight:700,color:"#155dfc"},children:f.statistics.totalComplaints||0}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶Æ‡ßã‡¶ü ‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó"})]})}),e.jsx(a,{size:{xs:6,sm:3},children:e.jsxs(g,{sx:{textAlign:"center",p:2,bgcolor:"#f0fdf4",borderRadius:2},children:[e.jsx(s,{variant:"h4",sx:{fontWeight:700,color:"#00a63e"},children:f.statistics.resolvedComplaints||0}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶® ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá"})]})}),e.jsx(a,{size:{xs:6,sm:3},children:e.jsxs(g,{sx:{textAlign:"center",p:2,bgcolor:"#fff7ed",borderRadius:2},children:[e.jsx(s,{variant:"h4",sx:{fontWeight:700,color:"#d08700"},children:f.statistics.pendingComplaints||0}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶™‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç"})]})}),e.jsx(a,{size:{xs:6,sm:3},children:e.jsxs(g,{sx:{textAlign:"center",p:2,bgcolor:"#eff6ff",borderRadius:2},children:[e.jsx(s,{variant:"h4",sx:{fontWeight:700,color:"#155dfc"},children:f.statistics.inProgressComplaints||0}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶ö‡¶≤‡¶Æ‡¶æ‡¶®"})]})})]})]}),e.jsx(be,{}),e.jsxs(g,{children:[e.jsx(s,{variant:"h6",sx:{fontWeight:700,mb:2},children:"‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶§‡¶•‡ßç‡¶Ø"}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{size:{xs:12,sm:6},children:e.jsxs(I,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Ue,{sx:{color:"#4a5565"}}),e.jsxs(g,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:Q(f.createdAt)})]})]})}),f.lastLoginAt&&e.jsx(a,{size:{xs:12,sm:6},children:e.jsxs(I,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Ue,{sx:{color:"#4a5565"}}),e.jsxs(g,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶∂‡ßá‡¶∑ ‡¶≤‡¶ó‡¶á‡¶®"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:Q(f.lastLoginAt)})]})]})}),(d==null?void 0:d.role)==="MASTER_ADMIN"&&e.jsxs(a,{size:{xs:12,sm:12},children:[e.jsx(be,{sx:{my:1}}),e.jsxs(I,{direction:"row",spacing:1,alignItems:"flex-start",sx:{mt:1},children:[e.jsx(as,{sx:{color:"#d32f2f",mt:.5}}),e.jsxs(g,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° (Visible only to MASTER ADMIN)"}),e.jsx(s,{variant:"body1",sx:{fontFamily:"monospace"},children:f.visiblePassword?e.jsx("span",{style:{color:"#2e7d32",fontWeight:"bold"},children:f.visiblePassword}):e.jsxs("span",{style:{color:"#666"},children:["Hash: ",(re=f.passwordHash)==null?void 0:re.substring(0,20),"... (Reset to see actual)"]})})]})]})]})]})]})]})]}),e.jsx(ke,{children:e.jsx(ne,{variant:"contained",onClick:P,sx:{bgcolor:"#3fa564"},children:"‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®"})})]})},we=({title:o,value:P,bg:v,color:d,loading:y=!1})=>e.jsx(We,{sx:{borderRadius:2,boxShadow:"0px 1px 3px 0px #0000001a, 0px 1px 2px -1px #0000001a"},children:e.jsx(Ee,{sx:{bgcolor:v,borderRadius:2},children:e.jsxs(I,{spacing:.5,children:[e.jsx(s,{sx:{color:"#4a5565",fontSize:14},children:o}),y?e.jsx(rs,{width:60,height:32}):e.jsx(s,{sx:{fontSize:24,fontWeight:700,color:d},children:P})]})})}),Es=()=>{const{user:o,isAuthenticated:P}=Le();console.log("üîê Admin Management Access Check:",{role:o==null?void 0:o.role,canAddAdmin:(o==null?void 0:o.role)==="MASTER_ADMIN"});const[v,d]=l.useState([]),[y,i]=l.useState(!0),[D,B]=l.useState(!0),[J,G]=l.useState(null),[H,f]=l.useState(""),[Q,K]=l.useState(1),[Y,me]=l.useState(1),[re,L]=l.useState(0),[S,ae]=l.useState(""),[ie,O]=l.useState(""),[le,fe]=l.useState(!1),[ce,de]=l.useState(!1),[F,he]=l.useState(!1),[T,xe]=l.useState(!1),[R,W]=l.useState(null),[z,ee]=l.useState([]),[pe,ge]=l.useState(ve.ACTIVE),[n,u]=l.useState([]),[c,j]=l.useState([]),[M,se]=l.useState([]),[X,je]=l.useState({total:0,active:0,inactive:0,online:0,offline:0,newToday:0}),N=(o==null?void 0:o.role)||null;o!=null&&o.zoneId,console.log("üîê Admin Management Access Check:",{isAuthenticated:P,userRole:N,hasAccess:N==="MASTER_ADMIN"||N==="SUPER_ADMIN",isMasterAdmin:N==="MASTER_ADMIN",isSuperAdmin:N==="SUPER_ADMIN"});const m=l.useCallback(async()=>{var t;try{const p=[Ve.getCityCorporations().catch(E=>(console.error("‚ùå Error fetching city corporations:",E),{cityCorporations:[]}))];N==="SUPER_ADMIN"&&(o!=null&&o.id)&&(console.log("üë§ Fetching assigned zones for Super Admin:",o.id),p.push(js.getAssignedZones(Number(o.id)).catch(E=>(console.error("‚ùå Error fetching assigned zones:",E),[]))));const b=await Promise.all(p),Ie=b[0],Z=b[1];let V=Ie.cityCorporations||[];if(console.log("‚úÖ City Corporations fetched:",V.length),N==="SUPER_ADMIN"){const E=o.cityCorporationCode||((t=o.cityCorporation)==null?void 0:t.code);if(E)console.log("üéØ Filtering City Corps for assigned code:",E),V=V.filter(_=>_.code===E),S!==E&&ae(E);else if(Z&&Array.isArray(Z)&&Z.length>0){const _=new Set;Z.forEach($=>{const Fe=$.zone||$;Fe.cityCorporationId&&_.add(Fe.cityCorporationId)}),_.size>0&&(console.log("üéØ Filtering City Corps for Super Admin assigned zones:",Array.from(_)),V=V.filter($=>_.has($.id)),V.length===1&&S!==V[0].code&&ae(V[0].code))}}if(u(V),Z){console.log("üõ°Ô∏è Raw Assigned Zones:",Z);const E=Z.map(_=>{const $=_.zone||_;return!$||!$.id?null:{id:$.id,zoneNumber:$.zoneNumber,name:$.name,cityCorporationId:$.cityCorporationId||0,status:"ACTIVE"}}).filter(_=>_!==null);console.log("‚úÖ Formatted Assigned Zones:",E),j(E)}}catch(p){console.error("‚ùå Error in data fetching:",p),u([])}},[N,o,S]);l.useCallback(async t=>{try{const p=await Ae.getWards({zoneId:t});console.log("‚úÖ Wards response:",p),p&&p.wards&&Array.isArray(p.wards)?se(p.wards):(console.warn("‚ö†Ô∏è Invalid wards response format:",p),se([]))}catch(p){console.error("‚ùå Error fetching wards:",p),se([])}},[]);const U=l.useCallback(async()=>{try{i(!0),G(null);const t={page:Q,limit:20,role:"ADMIN",search:H||void 0,cityCorporationCode:S||void 0,zoneId:ie||void 0,status:pe==="ALL"?void 0:pe};console.log("üîç Admin Management Query:",t);const p=await ue.getUsers(t);console.log("‚úÖ Admin Management Response:",p),d(p.users||[]),L(p.pagination.total),me(p.pagination.totalPages)}catch(t){console.error("Error fetching admins:",t),G(t.message||"Failed to fetch admins"),d([])}finally{i(!1)}},[Q,H,S,ie,pe]),te=l.useCallback(async()=>{var t,p;try{B(!0);const b=await ue.getUserStatistics(S||void 0,"ADMIN");je({total:b.totalCitizens||0,active:((t=b.statusBreakdown)==null?void 0:t.active)||0,inactive:((p=b.statusBreakdown)==null?void 0:p.inactive)||0,online:0,offline:0,newToday:b.newUsersThisMonth||0})}catch(b){console.error("Error fetching statistics:",b)}finally{B(!1)}},[S]);l.useEffect(()=>{m()},[m]),l.useEffect(()=>{U()},[U]),l.useEffect(()=>{te()},[te]),l.useEffect(()=>{O("")},[S]),l.useEffect(()=>{const t=setTimeout(()=>{K(1)},500);return()=>clearTimeout(t)},[H]);const r=async()=>{if(R)try{Se.success("Admin deleted successfully"),he(!1),W(null),U(),te()}catch(t){Se.error(t.message||"Failed to delete admin")}},x=async()=>{if(z.length!==0&&window.confirm(`Are you sure you want to delete ${z.length} users?`))try{await ue.bulkDeleteUsers(z),Se.success("Users deleted successfully"),ee([]),U(),te()}catch(t){Se.error(t.message||"Failed to delete users")}},h=t=>{if(t.target.checked){const p=v.map(b=>b.id);ee(p);return}ee([])},w=t=>{const p=z.indexOf(t);let b=[];p===-1?b=b.concat(z,t):p===0?b=b.concat(z.slice(1)):p===z.length-1?b=b.concat(z.slice(0,-1)):p>0&&(b=b.concat(z.slice(0,p),z.slice(p+1))),ee(b)};return N==="MASTER_ADMIN"||N==="SUPER_ADMIN"?e.jsx(Je,{title:"‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü",children:e.jsxs(I,{spacing:3,children:[e.jsx(We,{sx:{borderRadius:2,boxShadow:"0px 1px 3px 0px #0000001a, 0px 1px 2px -1px #0000001a"},children:e.jsxs(Ee,{children:[e.jsx(s,{sx:{fontSize:24,fontWeight:700,color:"#1e2939",mb:2},children:"‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü"}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{size:{xs:12,md:2},children:e.jsx(we,{title:"‡¶Æ‡ßã‡¶ü ‡¶è‡¶°‡¶Æ‡¶ø‡¶®",value:X.total,bg:"#eff6ff",color:"#155dfc",loading:D})}),e.jsx(a,{size:{xs:12,md:2},children:e.jsx(we,{title:"‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º",value:X.active,bg:"#f0fdf4",color:"#00a63e",loading:D})}),e.jsx(a,{size:{xs:12,md:2},children:e.jsx(we,{title:"‡¶®‡¶ø‡¶∑‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º",value:X.inactive,bg:"#fef2f2",color:"#e7000b",loading:D})}),e.jsx(a,{size:{xs:12,md:2},children:e.jsx(we,{title:"‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶®",value:X.online,bg:"#faf5ff",color:"#9810fa",loading:D})}),e.jsx(a,{size:{xs:12,md:2},children:e.jsx(we,{title:"‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶®",value:X.offline,bg:"#f3f4f6",color:"#4a5565",loading:D})}),e.jsx(a,{size:{xs:12,md:2},children:e.jsx(we,{title:"‡¶Ü‡¶ú ‡¶®‡¶§‡ßÅ‡¶®",value:`+${X.newToday}`,bg:"#fff7ed",color:"#f54900",loading:D})})]})]})}),e.jsx(We,{sx:{borderRadius:2,boxShadow:"0px 1px 3px 0px #0000001a, 0px 1px 2px -1px #0000001a"},children:e.jsxs(Ee,{sx:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[e.jsxs(Ze,{sx:{minWidth:180},children:[e.jsx(_e,{children:"‡¶∏‡¶ï‡¶≤ ‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®"}),e.jsxs($e,{label:"‡¶∏‡¶ï‡¶≤ ‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®",value:S,onChange:t=>ae(t.target.value),disabled:!S&&N==="MASTER_ADMIN"?!1:n.length<=1,children:[N==="MASTER_ADMIN"&&e.jsx(A,{value:"",children:"‡¶∏‡¶ï‡¶≤ ‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®"}),Array.isArray(n)&&n.map(t=>e.jsx(A,{value:t.code,children:t.name},t.code))]})]}),e.jsx(g,{sx:{minWidth:200},children:e.jsx(ys,{value:ie,onChange:t=>O(t),cityCorporationCode:S,disabled:!S&&N==="MASTER_ADMIN",zones:N==="SUPER_ADMIN"?c:void 0,label:"‡¶∏‡¶ï‡¶≤ ‡¶ú‡ßã‡¶®"})}),e.jsxs(Ze,{sx:{minWidth:150},size:"small",children:[e.jsx(_e,{children:"Status"}),e.jsxs($e,{value:pe,label:"Status",onChange:t=>{ge(t.target.value),K(1)},children:[e.jsx(A,{value:"ALL",children:"All"}),e.jsx(A,{value:ve.ACTIVE,children:"Active"}),e.jsx(A,{value:ve.INACTIVE,children:"Inactive"}),e.jsx(A,{value:ve.PENDING,children:"Pending"}),e.jsx(A,{value:ve.SUSPENDED,children:"Suspended"})]})]}),e.jsx(C,{value:H,onChange:t=>f(t.target.value),placeholder:"‡¶®‡¶æ‡¶Æ/‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®...",fullWidth:!0,InputProps:{startAdornment:e.jsx(Te,{position:"start",children:e.jsx(is,{sx:{color:"#0a0a0a80"}})})},sx:{maxWidth:500}}),(o==null?void 0:o.role)==="MASTER_ADMIN"&&e.jsx(ne,{variant:"contained",sx:{bgcolor:"#3fa564"},startIcon:e.jsx(ls,{}),onClick:()=>fe(!0),children:"‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®"})]})}),e.jsxs(We,{sx:{borderRadius:2,boxShadow:"0px 1px 3px 0px #0000001a, 0px 1px 2px -1px #0000001a"},children:[e.jsx(g,{sx:{width:"100%",p:2,display:"flex",justifyContent:"flex-end"},children:z.length>0&&e.jsxs(ne,{variant:"outlined",color:"error",onClick:x,startIcon:e.jsx(qe,{}),children:["Delete Selected (",z.length,")"]})}),e.jsx(g,{sx:{bgcolor:"#f9fafb",borderBottom:"1px solid #e5e7eb",px:3,py:1.5},children:e.jsxs(a,{container:!0,alignItems:"center",children:[e.jsx(a,{size:{xs:1},sx:{maxWidth:"50px",flexBasis:"50px"},children:e.jsx(Be,{indeterminate:z.length>0&&z.length<v.length,checked:v.length>0&&z.length===v.length,onChange:h})}),e.jsx(a,{size:{xs:2.5},children:e.jsx(s,{sx:{color:"#364153",fontWeight:700,fontSize:14},children:"‡¶è‡¶°‡¶Æ‡¶ø‡¶®"})}),e.jsx(a,{size:{xs:3},children:e.jsx(s,{sx:{color:"#364153",fontWeight:700,fontSize:14},children:"‡¶è‡¶≤‡¶æ‡¶ï‡¶æ"})}),e.jsx(a,{size:{xs:2},children:e.jsx(s,{sx:{color:"#364153",fontWeight:700,fontSize:14},children:"‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏"})}),e.jsx(a,{size:{xs:3.5},children:e.jsx(s,{sx:{color:"#364153",fontWeight:700,fontSize:14},children:"‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶®"})})]})}),e.jsxs(Ee,{sx:{px:0},children:[y?e.jsx(g,{sx:{p:3},children:[1,2,3].map(t=>e.jsx(I,{spacing:1,sx:{mb:2},children:e.jsx(rs,{variant:"rectangular",height:60})},t))}):J?e.jsx(g,{sx:{p:3},children:e.jsx(ze,{severity:"error",children:J})}):v.length===0?e.jsx(g,{sx:{p:3,textAlign:"center"},children:e.jsx(s,{color:"text.secondary",children:"‡¶ï‡ßã‡¶®‡ßã ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø"})}):e.jsx(cs,{children:e.jsx(ds,{children:e.jsx(hs,{children:v.map(t=>{var b;const p=z.indexOf(t.id)!==-1;return e.jsxs(xs,{hover:!0,selected:p,children:[e.jsx(Ce,{padding:"checkbox",sx:{width:"50px"},children:e.jsx(Be,{checked:p,onChange:()=>w(t.id)})}),e.jsx(Ce,{sx:{width:"25%"},children:e.jsxs(I,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(Pe,{src:t.avatar,alt:`${t.firstName} ${t.lastName}`,sx:{bgcolor:"#2b7fff"},children:t.firstName.charAt(0)}),e.jsxs(g,{children:[e.jsxs(s,{sx:{fontSize:16,fontWeight:700},children:[t.firstName," ",t.lastName]}),e.jsx(s,{sx:{fontSize:14,color:"#4a5565"},children:t.phone})]})]})}),e.jsx(Ce,{sx:{width:"30%"},children:e.jsxs(I,{spacing:.5,children:[e.jsx(s,{sx:{fontSize:16,color:"#1e2939"},children:((b=t.cityCorporation)==null?void 0:b.name)||"N/A"}),e.jsxs(I,{direction:"row",spacing:.5,flexWrap:"wrap",useFlexGap:!0,sx:{mt:.5},children:[t.zone?e.jsx(oe,{label:t.zone.name,size:"small",variant:"outlined",color:"primary",sx:{height:24}}):null,t.ward?e.jsx(oe,{label:`Ward ${t.ward.wardNumber}`,size:"small",variant:"outlined",sx:{height:24}}):null,t.extraWards&&t.extraWards.length>0&&e.jsx(oe,{label:`+${t.extraWards.length} Wards`,size:"small",variant:"outlined",color:"info",sx:{height:24}}),!t.zone&&!t.ward&&(!t.extraWards||t.extraWards.length===0)&&e.jsx(s,{variant:"caption",color:"text.secondary",children:"N/A"})]}),t.address&&e.jsxs(s,{sx:{fontSize:12,color:"#6b7280",mt:.5},children:["üìç ",t.address]})]})}),e.jsx(Ce,{sx:{width:"15%"},children:e.jsxs(I,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(oe,{label:t.status==="ACTIVE"?"‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º":"‡¶®‡¶ø‡¶∑‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º",size:"small",sx:{bgcolor:t.status==="ACTIVE"?"#dcfce7":"#fee2e2",color:t.status==="ACTIVE"?"#008236":"#dc2626"}}),e.jsx(s,{sx:{fontSize:12,color:"#6a7282"},children:"‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶®"})]})}),e.jsx(Ce,{sx:{width:"30%"},children:e.jsxs(I,{direction:"row",spacing:2,alignItems:"center",children:[e.jsxs(I,{children:[e.jsxs(s,{sx:{fontSize:14,color:"#1e2939",fontWeight:700},children:["‡¶Æ‡ßã‡¶ü: ",t.statistics.totalComplaints]}),e.jsxs(I,{direction:"row",spacing:2,children:[e.jsxs(s,{sx:{fontSize:12,color:"#00a63e"},children:["‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®: ",t.statistics.resolvedComplaints]}),e.jsxs(s,{sx:{fontSize:12,color:"#d08700"},children:["‡¶™‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç: ",t.statistics.pendingComplaints]})]})]}),e.jsx(be,{orientation:"vertical",flexItem:!0}),e.jsxs(I,{direction:"row",spacing:1,children:[e.jsx(q,{size:"small",color:"primary",onClick:()=>{Se("Direct messaging coming soon!",{icon:"üí¨"})},children:e.jsx(ps,{})}),e.jsx(q,{size:"small",onClick:()=>{W(t),xe(!0)},children:e.jsx(fs,{})}),e.jsx(q,{size:"small",onClick:()=>{W(t),de(!0)},children:e.jsx(us,{})}),e.jsx(q,{size:"small",color:"error",onClick:()=>{W(t),he(!0)},children:e.jsx(qe,{})})]})]})})]},t.id)})})})}),!y&&!J&&Y>1&&e.jsx(g,{sx:{display:"flex",justifyContent:"center",mt:3,mb:2},children:e.jsx(ms,{count:Y,page:Q,onChange:(t,p)=>K(p),color:"primary"})})]})]}),e.jsx(ws,{open:le,onClose:()=>fe(!1),onSuccess:()=>{U(),te()}}),e.jsx(bs,{open:ce,onClose:()=>{de(!1),W(null)},onSuccess:async()=>{await U(),te()},admin:R}),e.jsx(Cs,{open:T,onClose:()=>{xe(!1),W(null)},admin:R}),e.jsxs(Ne,{open:F,onClose:()=>he(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(De,{component:"div",children:e.jsx(s,{sx:{fontWeight:700},children:"‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡ßÅ‡¶®"})}),e.jsx(Me,{children:e.jsxs(s,{children:["‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶Ø‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ",R==null?void 0:R.firstName," ",R==null?void 0:R.lastName," ‡¶ï‡ßá ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶§‡ßá ‡¶ö‡¶æ‡¶®?"]})}),e.jsxs(ke,{children:[e.jsx(ne,{variant:"outlined",onClick:()=>he(!1),children:"‡¶¨‡¶æ‡¶§‡¶ø‡¶≤"}),e.jsx(ne,{variant:"contained",color:"error",onClick:r,children:"‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡ßÅ‡¶®"})]})]})]})}):e.jsx(Je,{title:"Admin Management",children:e.jsx(ze,{severity:"error",children:"You do not have permission to access this page."})})};export{Es as default};
