import{r as l,an as Oe,j as e,D as Ee,E as De,T as s,I as V,H as Te,J as Ne,L as Se,F as j,G as Pe,ay as Ge,N as C,W as S,aj as Q,O as Re,aI as He,aJ as Qe,am as Me,P as K,K as Ve,aH as Ke,a2 as ze,a1 as Le,aD as rs,X as ge,aK as Ce,ao as as,a5 as Fe,as as Ie,at as We,U as Xe,aa as Ue,V as Ze,ab as ns,ac as is,aM as _e,aq as Ye,ad as os,ae as ls,ai as cs,ag as ds,ah as be,aN as ve}from"./index-CpMFUl0-.js";import{A as xs}from"./Add-epQFUVgE.js";import{A as es,S as ss,E as hs,L as $e,C as qe,a as ps,D as Be,V as fs,b as us}from"./VisibilityOutlined-B6oVdxUu.js";import{C as ms}from"./ChatBubbleOutline-DLcAHmcy.js";import{u as xe}from"./userManagementService-C7pm6TD4.js";import{G as a}from"./Grid-CXliHFNi.js";import{C as ts}from"./CloudUpload-D1bX8LzE.js";import{P as js}from"./PhoneOutlined-CL_VVvGz.js";import{S as z}from"./Stack-BZNUxVwe.js";import{P as gs}from"./Pagination-Cw5CmmXv.js";import"./styled-C0WY_1v_.js";import"./useThemeProps-DQBRHprK.js";const Je={zones:[],wards:[],categories:[],features:{canViewComplaints:!0,canApproveComplaints:!1,canRejectComplaints:!1,canMarkComplaintsPending:!1,canEditComplaints:!1,canDeleteComplaints:!1,canViewUsers:!0,canEditUsers:!1,canDeleteUsers:!1,canAddUsers:!1,canViewAdmins:!1,canEditAdmins:!1,canDeleteAdmins:!1,canAddAdmins:!1,canViewMessages:!0,canSendMessagesToUsers:!1,canSendMessagesToAdmins:!1,canViewAnalytics:!1,canExportData:!1,canDownloadReports:!1,viewOnlyMode:!1,canViewComplainantProfile:!1,canViewAreaStats:!1,canViewOwnPerformance:!1,canShowReviews:!1}},ys=({open:i,onClose:N,onSuccess:b})=>{const[d,y]=l.useState({firstName:"",lastName:".",designation:"",email:"",phone:"",whatsapp:"",joiningDate:new Date().toISOString().split("T")[0],address:"",password:"",confirmPassword:"",cityCorporationCode:"",zoneId:"",wardId:"",role:"ADMIN",permissions:JSON.parse(JSON.stringify(Je))}),[o,D]=l.useState([]),[L,F]=l.useState([]),[X,U]=l.useState([]),[f,Z]=l.useState([]),[_,$]=l.useState(!1),[he,J]=l.useState(!1),[R,A]=l.useState(!1),[oe,Y]=l.useState(!1),[T,ee]=l.useState({}),[le,ce]=l.useState(!1),[se,q]=l.useState(null);l.useEffect(()=>{i&&(te(),y({firstName:"",lastName:".",designation:"",email:"",phone:"",whatsapp:"",joiningDate:new Date().toISOString().split("T")[0],address:"",password:"",confirmPassword:"",cityCorporationCode:"",zoneId:"",wardId:"",role:"ADMIN",permissions:JSON.parse(JSON.stringify(Je))}),ee({}),q(null))},[i]);const te=async()=>{try{$(!0);const n=await Oe.getCityCorporations("ACTIVE");D(n.cityCorporations||[])}catch(n){console.error("Error fetching city corporations:",n)}finally{$(!1)}},M=async n=>{try{J(!0);const u=await Ke.getZones({cityCorporationCode:n,status:"ACTIVE"});F(u.zones||[])}catch(u){console.error("Error fetching zones:",u)}finally{J(!1)}},re=async n=>{try{A(!0);const u=await ze.getWards({zoneId:n,status:"ACTIVE"});U(u.wards||[])}catch(u){console.error("Error fetching wards:",u)}finally{A(!1)}},k=async n=>{try{const u=await ze.getWards({cityCorporationCode:n,status:"ACTIVE"});Z(u.wards||[])}catch(u){console.error("Error fetching all wards:",u)}},I=n=>u=>{const c=u.target.value;y(g=>({...g,[n]:c})),n==="cityCorporationCode"?(y(g=>({...g,cityCorporationCode:c,zoneId:"",wardId:"",permissions:{...g.permissions,wards:[]}})),M(c),k(c)):n==="zoneId"&&(y(g=>({...g,zoneId:c,wardId:""})),re(parseInt(c))),T[n]&&ee(g=>({...g,[n]:void 0}))},v=(n,u)=>{const c=u.map(g=>g.id);y(g=>({...g,permissions:{...g.permissions,wards:c}}))},B=n=>{y(u=>{const c={...u.permissions.features};if(n==="viewOnlyMode"){const g=!c.viewOnlyMode;g&&Object.keys(c).forEach(O=>{O!=="viewOnlyMode"&&(c[O]=!1)}),c.viewOnlyMode=g}else if(n==="actionApproval"){const O=!c.canApproveComplaints;c.canApproveComplaints=O,c.canRejectComplaints=O,c.canMarkComplaintsPending=O,c.canEditComplaints=O,c.canEditUsers=O,c.canDeleteUsers=O,O&&(c.viewOnlyMode=!1)}else if(n==="reportDownload"){const g=!c.canDownloadReports;c.canDownloadReports=g,c.canExportData=g,c.canViewAnalytics=g,g&&(c.viewOnlyMode=!1)}else c[n]=!c[n],c[n]&&(c.viewOnlyMode=!1);return{...u,permissions:{...u.permissions,features:c}}})},ae=()=>{const n={};return d.firstName.trim()||(n.firstName="Name is required"),d.phone.trim()||(n.phone="Phone is required"),d.password||(n.password="Password is required"),d.cityCorporationCode||(n.cityCorporationCode="City Corporation is required"),d.zoneId||(n.zoneId="Zone is required"),ee(n),Object.keys(n).length===0},pe=async()=>{var n,u,c;if(ae()){ce(!0),q(null);try{const g={firstName:d.firstName,lastName:d.lastName,designation:d.designation,email:d.email,phone:d.phone,whatsapp:d.whatsapp,joiningDate:d.joiningDate,address:d.address,password:d.password,role:d.role,cityCorporationCode:d.cityCorporationCode,zoneId:parseInt(d.zoneId),wardId:d.wardId?parseInt(d.wardId):void 0,permissions:d.permissions};await xe.createUser(g),b(),N()}catch(g){console.error("Error creating admin:",g),q(((c=(u=(n=g.response)==null?void 0:n.data)==null?void 0:u.error)==null?void 0:c.message)||"Failed to create admin")}finally{ce(!1)}}};return e.jsxs(Ee,{open:i,onClose:N,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[e.jsxs(De,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[e.jsx(s,{variant:"h6",fontWeight:"bold",children:"‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®"}),e.jsx(V,{onClick:N,size:"small",children:e.jsx(Te,{})})]}),e.jsxs(Ne,{dividers:!0,sx:{p:3},children:[se&&e.jsx(Se,{severity:"error",sx:{mb:2},children:se}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsxs(a,{size:{xs:12,md:3},display:"flex",flexDirection:"column",alignItems:"center",children:[e.jsxs(j,{sx:{position:"relative",mb:2},children:[e.jsx(Pe,{sx:{width:120,height:120,bgcolor:"#f0f0f0"},children:e.jsx(ts,{sx:{fontSize:50,color:"#bdbdbd"}})}),e.jsx(V,{sx:{position:"absolute",bottom:0,right:0,bgcolor:"#4caf50",color:"white","&:hover":{bgcolor:"#45a049"},padding:"4px"},size:"small",children:e.jsx(Ge,{fontSize:"small"})})]}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶õ‡¶¨‡¶ø"})]}),e.jsx(a,{size:{xs:12,md:9},children:e.jsxs(a,{container:!0,spacing:2,children:[e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶®‡¶æ‡¶Æ"}),e.jsx(C,{fullWidth:!0,placeholder:"‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®...",value:d.firstName,onChange:I("firstName"),error:!!T.firstName,size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶™‡¶¶‡¶¨‡ßÄ"}),e.jsx(C,{fullWidth:!0,placeholder:"‡¶™‡¶¶‡¶¨‡ßÄ...",value:d.designation,onChange:I("designation"),size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶´‡ßã‡¶®"}),e.jsx(C,{fullWidth:!0,placeholder:"01XXXXXXXXX",value:d.phone,onChange:I("phone"),error:!!T.phone,size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶π‡ßã‡ßü‡¶æ‡¶ü‡¶∏‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™"}),e.jsx(C,{fullWidth:!0,placeholder:"01XXXXXXXXX",value:d.whatsapp,onChange:I("whatsapp"),size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶á‡¶Æ‡ßá‡¶á‡¶≤"}),e.jsx(C,{fullWidth:!0,placeholder:"example@email.com",value:d.email,onChange:I("email"),size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶ú‡ßü‡ßá‡¶®‡¶ø‡¶Ç ‡¶°‡ßá‡¶ü"}),e.jsx(C,{fullWidth:!0,type:"date",value:d.joiningDate,onChange:I("joiningDate"),size:"small",InputLabelProps:{shrink:!0}})]}),e.jsxs(a,{size:12,children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ"}),e.jsx(C,{fullWidth:!0,placeholder:"‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ...",value:d.address,onChange:I("address"),size:"small",multiline:!0,rows:2})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®"}),e.jsxs(C,{select:!0,fullWidth:!0,value:d.cityCorporationCode,onChange:I("cityCorporationCode"),error:!!T.cityCorporationCode,size:"small",SelectProps:{displayEmpty:!0},children:[e.jsx(S,{value:"",disabled:!0,children:"‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶® ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."}),o.map(n=>e.jsx(S,{value:n.code,children:n.name},n.code))]})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶ú‡ßã‡¶®"}),e.jsxs(C,{select:!0,fullWidth:!0,value:d.zoneId,onChange:I("zoneId"),error:!!T.zoneId,disabled:!d.cityCorporationCode,size:"small",SelectProps:{displayEmpty:!0},children:[e.jsx(S,{value:"",disabled:!0,children:"‡¶ú‡ßã‡¶® ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."}),L.map(n=>e.jsx(S,{value:n.id.toString(),children:n.name||`Zone ${n.zoneNumber}`},n.id))]})]}),e.jsxs(a,{size:12,children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶è‡¶∞‡¶ø‡ßü‡¶æ (‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°)"}),e.jsx(es,{multiple:!0,options:f,getOptionLabel:n=>`Ward ${n.wardNumber}${n.zone?` (Zone ${n.zone.zoneNumber})`:""}`,value:f.filter(n=>d.permissions.wards.includes(n.id)),onChange:v,disabled:!d.cityCorporationCode,size:"small",renderTags:(n,u)=>n.map((c,g)=>e.jsx(Q,{label:`Ward ${c.wardNumber}`,size:"small",...u({index:g})})),renderInput:n=>e.jsx(C,{...n,placeholder:d.permissions.wards.length>0?"":"‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."})}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶®‡ßã‡¶ü: ‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞‡¶ø ‡¶ú‡ßã‡¶®‡ßá‡¶∞ ‡¶¨‡¶æ‡¶á‡¶∞‡ßá‡¶∞ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¨‡¶æ ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§"})]}),e.jsxs(a,{size:12,children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°"}),e.jsx(C,{fullWidth:!0,type:oe?"text":"password",value:d.password,onChange:I("password"),error:!!T.password,size:"small",InputProps:{endAdornment:e.jsx(Re,{position:"end",children:e.jsx(V,{onClick:()=>Y(!oe),edge:"end",size:"small",children:oe?e.jsx(He,{}):e.jsx(Qe,{})})})}})]})]})}),e.jsx(a,{size:12,children:e.jsxs(j,{sx:{bgcolor:"#f5f5f5",p:2,borderRadius:2,mt:2},children:[e.jsx(s,{variant:"subtitle2",fontWeight:"bold",mb:2,children:"‡¶™‡¶æ‡¶∞‡¶Æ‡¶ø‡¶∂‡¶® ‡¶ì ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤"}),e.jsx(a,{container:!0,spacing:2,children:[{label:"‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶ü‡ßÅ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞",key:"canSendMessagesToUsers"},{label:"‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶ü‡ßÅ ‡¶∏‡ßÅ‡¶™‡¶æ‡¶∞ ‡¶è‡¶°‡¶Æ‡¶ø‡¶®",key:"canSendMessagesToAdmins"},{label:"‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤",key:"canViewComplainantProfile"},{label:"‡¶è‡¶∞‡¶ø‡ßü‡¶æ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏",key:"canViewAreaStats"},{label:"‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶™‡¶æ‡¶∞‡¶´‡¶∞‡¶Æ‡ßá‡¶®‡ßç‡¶∏",key:"canViewOwnPerformance"},{label:"‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â",key:"canShowReviews"},{label:"‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°",key:"reportDownload"},{label:"‡¶è‡¶ï‡¶∂‡¶® ‡¶è‡¶™‡ßç‡¶∞‡ßÅ‡¶≠‡¶æ‡¶≤",key:"actionApproval"},{label:"‡¶≠‡¶ø‡¶â ‡¶Ö‡¶®‡¶≤‡¶ø",key:"viewOnlyMode"}].map(n=>{let u=!1;n.key==="actionApproval"?u=d.permissions.features.canApproveComplaints:n.key==="reportDownload"?u=d.permissions.features.canDownloadReports:u=!!d.permissions.features[n.key];const c=d.permissions.features.viewOnlyMode&&n.key!=="viewOnlyMode";return e.jsx(a,{size:{xs:12,sm:6,md:4},children:e.jsxs(j,{display:"flex",justifyContent:"space-between",alignItems:"center",p:1,bgcolor:"white",borderRadius:1,border:"1px solid #eee",children:[e.jsx(s,{variant:"body2",color:c?"text.disabled":"text.primary",children:n.label}),e.jsx(ss,{checked:u,onChange:()=>B(n.key),color:"success",size:"small",disabled:c})]})},n.key)})})]})})]})]}),e.jsxs(Me,{sx:{p:2,display:"flex",gap:1},children:[e.jsx(K,{onClick:N,variant:"outlined",color:"inherit",fullWidth:!0,sx:{borderColor:"#ddd",color:"#666"},children:"‡¶¨‡¶æ‡¶§‡¶ø‡¶≤"}),e.jsx(K,{onClick:pe,variant:"contained",color:"success",fullWidth:!0,disabled:le,sx:{bgcolor:"#4caf50","&:hover":{bgcolor:"#45a049"}},children:le?e.jsx(Ve,{size:24,color:"inherit"}):"‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®"})]})]})},me={zones:[],wards:[],categories:[],features:{canViewComplaints:!0,canApproveComplaints:!1,canRejectComplaints:!1,canMarkComplaintsPending:!1,canEditComplaints:!1,canDeleteComplaints:!1,canViewUsers:!0,canEditUsers:!1,canDeleteUsers:!1,canAddUsers:!1,canViewAdmins:!1,canEditAdmins:!1,canDeleteAdmins:!1,canAddAdmins:!1,canViewMessages:!0,canSendMessagesToUsers:!1,canSendMessagesToAdmins:!1,canViewAnalytics:!1,canExportData:!1,canDownloadReports:!1,viewOnlyMode:!1,canViewComplainantProfile:!1,canViewAreaStats:!1,canViewOwnPerformance:!1,canShowReviews:!1}},ws=({admin:i,open:N,onClose:b,onSuccess:d})=>{var we,G,H;const{user:y}=Le(),[o,D]=l.useState({firstName:"",lastName:"",designation:"",email:"",phone:"",whatsapp:"",joiningDate:"",address:"",cityCorporationCode:"",zoneId:"",wardId:"",role:"ADMIN",status:"ACTIVE",newPassword:"",confirmPassword:"",permissions:JSON.parse(JSON.stringify(me))}),[L,F]=l.useState([]),[X,U]=l.useState([]),[f,Z]=l.useState([]),[_,$]=l.useState([]),[he,J]=l.useState(!1),[R,A]=l.useState(!1),[oe,Y]=l.useState(!1),[T,ee]=l.useState(null),[le,ce]=l.useState(null),se=rs.useRef(null),[q,te]=l.useState(!1),[M,re]=l.useState({}),[k,I]=l.useState(!1),[v,B]=l.useState(null);l.useEffect(()=>{var r,h,x,m,E,t,p,w,Ae;if(N&&i){let de=JSON.parse(JSON.stringify(me));if(i.permissions)if(typeof i.permissions=="string")try{const W=JSON.parse(i.permissions);de={...me,...W,features:{...me.features,...W.features}}}catch(W){console.error("Failed to parse permissions string",W)}else de={...me,...i.permissions,features:{...me.features,...i.permissions.features}};D({firstName:i.firstName||"",lastName:i.lastName||"",designation:i.designation||"",email:i.email||"",phone:i.phone||"",whatsapp:i.whatsapp||"",joiningDate:i.joiningDate?new Date(i.joiningDate).toISOString().split("T")[0]:"",address:i.address||"",cityCorporationCode:((r=i.cityCorporation)==null?void 0:r.code)||i.cityCorporationCode||"",zoneId:((x=(h=i.zone)==null?void 0:h.id)==null?void 0:x.toString())||((m=i.zoneId)==null?void 0:m.toString())||"",wardId:((t=(E=i.ward)==null?void 0:E.id)==null?void 0:t.toString())||((p=i.wardId)==null?void 0:p.toString())||"",role:i.role,status:i.status,newPassword:"",confirmPassword:"",permissions:de}),ae();const ie=((w=i.cityCorporation)==null?void 0:w.code)||i.cityCorporationCode;if(ie){pe(ie),u(ie);const W=((Ae=i.zone)==null?void 0:Ae.id)||i.zoneId;W&&n(W)}re({}),B(null),ee(null),ce(i.avatar||null)}},[N,i]);const ae=async()=>{try{J(!0);const r=await Oe.getCityCorporations("ACTIVE");F(r.cityCorporations||[])}catch(r){console.error("Error fetching city corporations:",r)}finally{J(!1)}},pe=async r=>{try{A(!0);const h=await Ke.getZones({cityCorporationCode:r,status:"ACTIVE"});U(h.zones||[])}catch(h){console.error("Error fetching zones:",h)}finally{A(!1)}},n=async r=>{try{Y(!0);const h=await ze.getWards({zoneId:r,status:"ACTIVE"});Z(h.wards||[])}catch(h){console.error("Error fetching wards:",h)}finally{Y(!1)}},u=async r=>{try{const h=await ze.getWards({cityCorporationCode:r,status:"ACTIVE"});$(h.wards||[])}catch(h){console.error("Error fetching all wards:",h)}},c=r=>h=>{const x=h.target.value;D(m=>({...m,[r]:x})),r==="cityCorporationCode"?(D(m=>({...m,cityCorporationCode:x,zoneId:"",wardId:"",permissions:{...m.permissions,wards:[]}})),pe(x),u(x)):r==="zoneId"&&(D(m=>({...m,zoneId:x,wardId:""})),n(parseInt(x))),M[r]&&re(m=>({...m,[r]:void 0}))},g=(r,h)=>{const x=h.map(m=>m.id);D(m=>({...m,permissions:{...m.permissions,wards:x}}))},O=r=>{var x;const h=(x=r.target.files)==null?void 0:x[0];h&&(ee(h),ce(URL.createObjectURL(h)))},ye=()=>{var r;(r=se.current)==null||r.click()},ne=r=>{D(h=>{const x={...h.permissions.features};if(r==="viewOnlyMode"){const m=!x.viewOnlyMode;m&&Object.keys(x).forEach(E=>{E!=="viewOnlyMode"&&(x[E]=!1)}),x.viewOnlyMode=m}else if(r==="actionApproval"){const E=!x.canApproveComplaints;x.canApproveComplaints=E,x.canRejectComplaints=E,x.canMarkComplaintsPending=E,x.canEditComplaints=E,x.canEditUsers=E,x.canDeleteUsers=E,E&&(x.viewOnlyMode=!1)}else if(r==="reportDownload"){const m=!x.canDownloadReports;x.canDownloadReports=m,x.canExportData=m,x.canViewAnalytics=m,m&&(x.viewOnlyMode=!1)}else x[r]=!x[r],x[r]&&(x.viewOnlyMode=!1);return{...h,permissions:{...h.permissions,features:x}}})},ke=()=>{const r={};return o.firstName.trim()||(r.firstName="First Name is required"),o.lastName.trim()||(r.lastName="Last Name is required"),o.phone.trim()||(r.phone="Phone is required"),o.cityCorporationCode||(r.cityCorporationCode="City Corporation is required"),o.zoneId||(r.zoneId="Zone is required"),o.newPassword&&o.newPassword.length<8&&(r.newPassword="Password must be at least 8 characters"),o.newPassword!==o.confirmPassword&&(r.confirmPassword="Passwords do not match"),re(r),Object.keys(r).length===0},P=async()=>{var r,h,x;if(!(!ke()||!i)){I(!0),B(null);try{let m=i.avatar;if(T)try{m=await xe.uploadAvatar(T)}catch(t){throw console.error("Error uploading avatar:",t),new Error("Failed to upload profile picture")}const E={firstName:o.firstName,lastName:o.lastName,designation:o.designation,email:o.email,phone:o.phone,whatsapp:o.whatsapp,joiningDate:o.joiningDate,address:o.address,role:o.role,status:o.status,cityCorporationCode:o.cityCorporationCode,zoneId:parseInt(o.zoneId),wardId:o.wardId?parseInt(o.wardId):void 0,permissions:o.permissions,avatar:m||void 0};o.newPassword&&(E.password=o.newPassword),await xe.updateUser(i.id,E),d(),b()}catch(m){console.error("Error updating admin:",m),B(((x=(h=(r=m.response)==null?void 0:r.data)==null?void 0:h.error)==null?void 0:x.message)||"Failed to update admin")}finally{I(!1)}}};return e.jsxs(Ee,{open:N,onClose:b,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[e.jsxs(De,{component:"div",sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[e.jsx(s,{variant:"h6",fontWeight:"bold",children:"‡¶è‡¶°‡¶ø‡¶ü ‡¶è‡¶°‡¶Æ‡¶ø‡¶®"}),e.jsx(V,{onClick:b,size:"small",children:e.jsx(Te,{})})]}),e.jsxs(Ne,{dividers:!0,sx:{p:3},children:[v&&e.jsx(Se,{severity:"error",sx:{mb:2},children:v}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsxs(a,{size:{xs:12,md:3},display:"flex",flexDirection:"column",alignItems:"center",children:[e.jsxs(j,{sx:{position:"relative",mb:2},children:[e.jsx("input",{type:"file",ref:se,style:{display:"none"},accept:"image/*",onChange:O}),e.jsx(Pe,{src:le||void 0,sx:{width:120,height:120,bgcolor:"#f0f0f0"},children:e.jsx(ts,{sx:{fontSize:50,color:"#bdbdbd"}})}),e.jsx(V,{onClick:ye,sx:{position:"absolute",bottom:0,right:0,bgcolor:"#4caf50",color:"white","&:hover":{bgcolor:"#45a049"},padding:"4px"},size:"small",children:e.jsx(Ge,{fontSize:"small"})})]}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶õ‡¶¨‡¶ø"})]}),e.jsx(a,{size:{xs:12,md:9},children:e.jsxs(a,{container:!0,spacing:2,children:[e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶Ö‡¶Ç‡¶∂"}),e.jsx(C,{fullWidth:!0,placeholder:"‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶Ö‡¶Ç‡¶∂...",value:o.firstName,onChange:c("firstName"),error:!!M.firstName,size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶∂‡ßá‡¶∑ ‡¶Ö‡¶Ç‡¶∂"}),e.jsx(C,{fullWidth:!0,placeholder:"‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶∂‡ßá‡¶∑ ‡¶Ö‡¶Ç‡¶∂...",value:o.lastName,onChange:c("lastName"),error:!!M.lastName,size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶™‡¶¶‡¶¨‡ßÄ"}),e.jsx(C,{fullWidth:!0,placeholder:"‡¶™‡¶¶‡¶¨‡ßÄ...",value:o.designation,onChange:c("designation"),size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶´‡ßã‡¶®"}),e.jsx(C,{fullWidth:!0,placeholder:"01XXXXXXXXX",value:o.phone,onChange:c("phone"),error:!!M.phone,size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶π‡ßã‡ßü‡¶æ‡¶ü‡¶∏‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™"}),e.jsx(C,{fullWidth:!0,placeholder:"01XXXXXXXXX",value:o.whatsapp,onChange:c("whatsapp"),size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶á‡¶Æ‡ßá‡¶á‡¶≤"}),e.jsx(C,{fullWidth:!0,placeholder:"example@email.com",value:o.email,onChange:c("email"),size:"small"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶ú‡ßü‡ßá‡¶®‡¶ø‡¶Ç ‡¶°‡ßá‡¶ü"}),e.jsx(C,{fullWidth:!0,type:"date",value:o.joiningDate,onChange:c("joiningDate"),size:"small",InputLabelProps:{shrink:!0}})]}),e.jsxs(a,{size:12,children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ"}),e.jsx(C,{fullWidth:!0,placeholder:"‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ...",value:o.address,onChange:c("address"),size:"small",multiline:!0,rows:2})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®"}),e.jsxs(C,{select:!0,fullWidth:!0,value:o.cityCorporationCode,onChange:c("cityCorporationCode"),error:!!M.cityCorporationCode,disabled:(y==null?void 0:y.role)!=="MASTER_ADMIN",size:"small",SelectProps:{displayEmpty:!0},children:[e.jsx(S,{value:"",disabled:!0,children:"‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶® ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."}),o.cityCorporationCode&&!L.find(r=>r.code===o.cityCorporationCode)&&e.jsx(S,{value:o.cityCorporationCode,sx:{display:"none"},children:((we=i==null?void 0:i.cityCorporation)==null?void 0:we.name)||o.cityCorporationCode}),L.map(r=>e.jsx(S,{value:r.code,children:r.name},r.code))]})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶ú‡ßã‡¶®"}),e.jsxs(C,{select:!0,fullWidth:!0,value:o.zoneId,onChange:c("zoneId"),error:!!M.zoneId,disabled:(y==null?void 0:y.role)!=="MASTER_ADMIN"||!o.cityCorporationCode,size:"small",SelectProps:{displayEmpty:!0},children:[e.jsx(S,{value:"",disabled:!0,children:"‡¶ú‡ßã‡¶® ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."}),o.zoneId&&!X.find(r=>r.id.toString()===o.zoneId)&&e.jsx(S,{value:o.zoneId,sx:{display:"none"},children:((G=i==null?void 0:i.zone)==null?void 0:G.name)||`Zone ${(H=i==null?void 0:i.zone)==null?void 0:H.zoneNumber}`||o.zoneId}),X.map(r=>e.jsx(S,{value:r.id.toString(),children:r.name||`Zone ${r.zoneNumber}`},r.id))]})]}),e.jsxs(a,{size:12,children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶è‡¶∞‡¶ø‡ßü‡¶æ (‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°)"}),e.jsx(es,{multiple:!0,options:_,getOptionLabel:r=>`Ward ${r.wardNumber}${r.zone?` (Zone ${r.zone.zoneNumber})`:""}`,value:_.filter(r=>o.permissions.wards.includes(r.id)),onChange:g,disabled:(y==null?void 0:y.role)!=="MASTER_ADMIN"||!o.cityCorporationCode,size:"small",renderTags:(r,h)=>r.map((x,m)=>{const{key:E,...t}=h({index:m});return e.jsx(Q,{label:`Ward ${x.wardNumber}`,size:"small",...t,disabled:(y==null?void 0:y.role)!=="MASTER_ADMIN"},E)}),renderInput:r=>e.jsx(C,{...r,placeholder:o.permissions.wards.length>0?"":"‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."})}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶®‡ßã‡¶ü: ‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞‡¶ø ‡¶ú‡ßã‡¶®‡ßá‡¶∞ ‡¶¨‡¶æ‡¶á‡¶∞‡ßá‡¶∞ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¨‡¶æ ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§"})]}),e.jsxs(a,{size:{xs:12,md:6},children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏"}),e.jsxs(C,{select:!0,fullWidth:!0,value:o.status,onChange:c("status"),size:"small",children:[e.jsx(S,{value:"ACTIVE",children:"Active"}),e.jsx(S,{value:"INACTIVE",children:"Inactive"}),e.jsx(S,{value:"SUSPENDED",children:"Suspended"}),e.jsx(S,{value:"PENDING",children:"Pending"})]})]}),e.jsx(a,{size:12,children:(y==null?void 0:y.role)==="MASTER_ADMIN"&&e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,children:"‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° (‡¶Ö‡¶™‡¶∂‡¶®‡¶æ‡¶≤)"}),e.jsx(C,{fullWidth:!0,type:q?"text":"password",value:o.newPassword,onChange:c("newPassword"),error:!!M.newPassword,helperText:M.newPassword,size:"small",InputProps:{endAdornment:e.jsx(Re,{position:"end",children:e.jsx(V,{onClick:()=>te(!q),edge:"end",size:"small",children:q?e.jsx(He,{}):e.jsx(Qe,{})})})}}),e.jsx(s,{variant:"body2",fontWeight:"500",mb:.5,mt:2,children:"‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®"}),e.jsx(C,{fullWidth:!0,type:q?"text":"password",value:o.confirmPassword,onChange:c("confirmPassword"),error:!!M.confirmPassword,helperText:M.confirmPassword,size:"small",placeholder:"‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶Ø‡¶º ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®"})]})})]})}),e.jsx(a,{size:12,children:e.jsxs(j,{sx:{bgcolor:"#f5f5f5",p:2,borderRadius:2,mt:2},children:[e.jsx(s,{variant:"subtitle2",fontWeight:"bold",mb:2,children:"‡¶™‡¶æ‡¶∞‡¶Æ‡¶ø‡¶∂‡¶® ‡¶ì ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤"}),e.jsx(a,{container:!0,spacing:2,children:[{label:"‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶ü‡ßÅ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞",key:"canSendMessagesToUsers"},{label:"‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶ü‡ßÅ ‡¶∏‡ßÅ‡¶™‡¶æ‡¶∞ ‡¶è‡¶°‡¶Æ‡¶ø‡¶®",key:"canSendMessagesToAdmins"},{label:"‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤",key:"canViewComplainantProfile"},{label:"‡¶è‡¶∞‡¶ø‡ßü‡¶æ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏",key:"canViewAreaStats"},{label:"‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶™‡¶æ‡¶∞‡¶´‡¶∞‡¶Æ‡ßá‡¶®‡ßç‡¶∏",key:"canViewOwnPerformance"},{label:"‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â",key:"canShowReviews"},{label:"‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°",key:"reportDownload"},{label:"‡¶è‡¶ï‡¶∂‡¶® ‡¶è‡¶™‡ßç‡¶∞‡ßÅ‡¶≠‡¶æ‡¶≤",key:"actionApproval"},{label:"‡¶≠‡¶ø‡¶â ‡¶Ö‡¶®‡¶≤‡¶ø",key:"viewOnlyMode"}].map(r=>{let h=!1;r.key==="actionApproval"?h=o.permissions.features.canApproveComplaints:r.key==="reportDownload"?h=o.permissions.features.canDownloadReports:h=!!o.permissions.features[r.key];const x=o.permissions.features.viewOnlyMode&&r.key!=="viewOnlyMode";return e.jsx(a,{size:{xs:12,sm:6,md:4},children:e.jsxs(j,{display:"flex",justifyContent:"space-between",alignItems:"center",p:1,bgcolor:"white",borderRadius:1,border:"1px solid #eee",children:[e.jsx(s,{variant:"body2",color:x?"text.disabled":"text.primary",children:r.label}),e.jsx(ss,{checked:h,onChange:()=>ne(r.key),color:"success",size:"small",disabled:x})]})},r.key)})})]})})]})]}),e.jsxs(Me,{sx:{p:2,display:"flex",gap:1},children:[e.jsx(K,{onClick:b,variant:"outlined",color:"inherit",fullWidth:!0,sx:{borderColor:"#ddd",color:"#666"},children:"‡¶¨‡¶æ‡¶§‡¶ø‡¶≤"}),e.jsx(K,{onClick:P,variant:"contained",color:"success",fullWidth:!0,disabled:k,sx:{bgcolor:"#4caf50","&:hover":{bgcolor:"#45a049"}},children:k?e.jsx(Ve,{size:24,color:"inherit"}):"‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®"})]})]})},Cs=({open:i,onClose:N,admin:b})=>{var _,$,he,J;const{user:d}=Le(),[y,o]=l.useState(null),[D,L]=l.useState(!1),[F,X]=l.useState(null);l.useEffect(()=>{i&&(b!=null&&b.id)?U(b.id):(o(null),X(null))},[i,b]);const U=async R=>{try{L(!0),X(null);const A=await xe.getUserById(R);o(A.user)}catch(A){console.error("Error fetching admin details:",A),X("Failed to load latest details")}finally{L(!1)}};if(!b)return null;const f=y||b,Z=R=>R?new Date(R).toLocaleDateString("bn-BD",{year:"numeric",month:"long",day:"numeric"}):"N/A";return e.jsxs(Ee,{open:i,onClose:N,maxWidth:"md",fullWidth:!0,children:[e.jsxs(De,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(s,{sx:{fontWeight:700},children:"‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§"}),e.jsx(V,{onClick:N,children:e.jsx(Te,{})})]}),e.jsxs(Ne,{dividers:!0,children:[D&&e.jsx(j,{sx:{display:"flex",justifyContent:"center",p:2},children:e.jsx(Ve,{size:24})}),F&&e.jsxs(Se,{severity:"warning",sx:{mb:2},children:[F," - Showing cached data"]}),e.jsxs(z,{spacing:3,sx:{opacity:D?.6:1,transition:"opacity 0.2s"},children:[e.jsxs(j,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(Pe,{sx:{width:80,height:80,bgcolor:"#2b7fff",fontSize:32,fontWeight:700},children:(_=f.firstName)==null?void 0:_.charAt(0)}),e.jsxs(j,{sx:{flex:1},children:[e.jsxs(s,{variant:"h5",sx:{fontWeight:700,mb:.5},children:[f.firstName," ",f.lastName]}),e.jsxs(z,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Q,{label:f.role,size:"small",sx:{bgcolor:"#eff6ff",color:"#155dfc"}}),e.jsx(Q,{label:f.status==="ACTIVE"?"‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º":"‡¶®‡¶ø‡¶∑‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º",size:"small",sx:{bgcolor:f.status==="ACTIVE"?"#dcfce7":"#fee2e2",color:f.status==="ACTIVE"?"#008236":"#dc2626"}})]})]})]}),e.jsx(ge,{}),e.jsxs(j,{children:[e.jsx(s,{variant:"h6",sx:{fontWeight:700,mb:2},children:"‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø"}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{size:{xs:12,sm:6},children:e.jsxs(z,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(js,{sx:{color:"#4a5565"}}),e.jsxs(j,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:f.phone})]})]})}),f.email&&e.jsx(a,{size:{xs:12,sm:6},children:e.jsxs(z,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(hs,{sx:{color:"#4a5565"}}),e.jsxs(j,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶á‡¶Æ‡ßá‡¶á‡¶≤"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:f.email})]})]})}),f.address&&e.jsx(a,{size:{xs:12},children:e.jsxs(z,{direction:"row",spacing:1,alignItems:"flex-start",children:[e.jsx($e,{sx:{color:"#4a5565",mt:.5}}),e.jsxs(j,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:f.address})]})]})})]})]}),e.jsx(ge,{}),e.jsxs(j,{children:[e.jsx(s,{variant:"h6",sx:{fontWeight:700,mb:2},children:"‡¶è‡¶≤‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø"}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{size:{xs:12,sm:4},children:e.jsxs(z,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx($e,{sx:{color:"#4a5565"}}),e.jsxs(j,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:(($=f.cityCorporation)==null?void 0:$.name)||"N/A"})]})]})}),e.jsx(a,{size:{xs:12,sm:4},children:e.jsxs(j,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶ú‡ßã‡¶®"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:((he=f.zone)==null?void 0:he.name)||"‡¶™‡ßç‡¶∞‡¶Ø‡ßã‡¶ú‡ßç‡¶Ø ‡¶®‡ßü"})]})}),f.ward&&e.jsx(a,{size:{xs:12,sm:4},children:e.jsxs(j,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:`‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ${f.ward.wardNumber}`})]})})]}),f.extraWards&&f.extraWards.length>0&&e.jsxs(j,{sx:{mt:2},children:[e.jsx(s,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:.5},children:f.ward?"‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°":"‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶ø‡¶§ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡¶Æ‡ßÇ‡¶π"}),e.jsx(z,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:f.extraWards.map(R=>e.jsx(Q,{label:`‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ${R.wardNumber}`,size:"small",variant:"outlined",sx:{mb:.5}},R.id))})]})]}),e.jsx(ge,{}),f.statistics&&e.jsxs(j,{children:[e.jsx(s,{variant:"h6",sx:{fontWeight:700,mb:2},children:"‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶®"}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{size:{xs:6,sm:3},children:e.jsxs(j,{sx:{textAlign:"center",p:2,bgcolor:"#f9fafb",borderRadius:2},children:[e.jsx(s,{variant:"h4",sx:{fontWeight:700,color:"#155dfc"},children:f.statistics.totalComplaints||0}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶Æ‡ßã‡¶ü ‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó"})]})}),e.jsx(a,{size:{xs:6,sm:3},children:e.jsxs(j,{sx:{textAlign:"center",p:2,bgcolor:"#f0fdf4",borderRadius:2},children:[e.jsx(s,{variant:"h4",sx:{fontWeight:700,color:"#00a63e"},children:f.statistics.resolvedComplaints||0}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶® ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá"})]})}),e.jsx(a,{size:{xs:6,sm:3},children:e.jsxs(j,{sx:{textAlign:"center",p:2,bgcolor:"#fff7ed",borderRadius:2},children:[e.jsx(s,{variant:"h4",sx:{fontWeight:700,color:"#d08700"},children:f.statistics.pendingComplaints||0}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶™‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç"})]})}),e.jsx(a,{size:{xs:6,sm:3},children:e.jsxs(j,{sx:{textAlign:"center",p:2,bgcolor:"#eff6ff",borderRadius:2},children:[e.jsx(s,{variant:"h4",sx:{fontWeight:700,color:"#155dfc"},children:f.statistics.inProgressComplaints||0}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶ö‡¶≤‡¶Æ‡¶æ‡¶®"})]})})]})]}),e.jsx(ge,{}),e.jsxs(j,{children:[e.jsx(s,{variant:"h6",sx:{fontWeight:700,mb:2},children:"‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶§‡¶•‡ßç‡¶Ø"}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{size:{xs:12,sm:6},children:e.jsxs(z,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(qe,{sx:{color:"#4a5565"}}),e.jsxs(j,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:Z(f.createdAt)})]})]})}),f.lastLoginAt&&e.jsx(a,{size:{xs:12,sm:6},children:e.jsxs(z,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(qe,{sx:{color:"#4a5565"}}),e.jsxs(j,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶∂‡ßá‡¶∑ ‡¶≤‡¶ó‡¶á‡¶®"}),e.jsx(s,{variant:"body1",sx:{fontWeight:600},children:Z(f.lastLoginAt)})]})]})}),(d==null?void 0:d.role)==="MASTER_ADMIN"&&e.jsxs(a,{size:{xs:12,sm:12},children:[e.jsx(ge,{sx:{my:1}}),e.jsxs(z,{direction:"row",spacing:1,alignItems:"flex-start",sx:{mt:1},children:[e.jsx(ps,{sx:{color:"#d32f2f",mt:.5}}),e.jsxs(j,{children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° (Visible only to MASTER ADMIN)"}),e.jsx(s,{variant:"body1",sx:{fontFamily:"monospace"},children:f.visiblePassword?e.jsx("span",{style:{color:"#2e7d32",fontWeight:"bold"},children:f.visiblePassword}):e.jsxs("span",{style:{color:"#666"},children:["Hash: ",(J=f.passwordHash)==null?void 0:J.substring(0,20),"... (Reset to see actual)"]})})]})]})]})]})]})]})]}),e.jsx(Me,{children:e.jsx(K,{variant:"contained",onClick:N,sx:{bgcolor:"#3fa564"},children:"‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®"})})]})},je=({title:i,value:N,bg:b,color:d,loading:y=!1})=>e.jsx(Ie,{sx:{borderRadius:2,boxShadow:"0px 1px 3px 0px #0000001a, 0px 1px 2px -1px #0000001a"},children:e.jsx(We,{sx:{bgcolor:b,borderRadius:2},children:e.jsxs(z,{spacing:.5,children:[e.jsx(s,{sx:{color:"#4a5565",fontSize:14},children:i}),y?e.jsx(Ye,{width:60,height:32}):e.jsx(s,{sx:{fontSize:24,fontWeight:700,color:d},children:N})]})})}),ks=()=>{const{user:i,isAuthenticated:N}=Le(),[b,d]=l.useState([]),[y,o]=l.useState(!0),[D,L]=l.useState(!0),[F,X]=l.useState(null),[U,f]=l.useState(""),[Z,_]=l.useState(1),[$,he]=l.useState(1),[J,R]=l.useState(0),[A,oe]=l.useState(""),[Y,T]=l.useState(""),[ee,le]=l.useState(!1),[ce,se]=l.useState(!1),[q,te]=l.useState(!1),[M,re]=l.useState(!1),[k,I]=l.useState(null),[v,B]=l.useState([]),[ae,pe]=l.useState(Ce.ACTIVE),[n,u]=l.useState([]),[c,g]=l.useState([]),[O,ye]=l.useState([]),[ne,ke]=l.useState({total:0,active:0,inactive:0,online:0,offline:0,newToday:0}),P=(i==null?void 0:i.role)||null;i!=null&&i.zoneId,console.log("üîê Admin Management Access Check:",{isAuthenticated:N,userRole:P,hasAccess:P==="MASTER_ADMIN"||P==="SUPER_ADMIN",isMasterAdmin:P==="MASTER_ADMIN",isSuperAdmin:P==="SUPER_ADMIN"});const we=l.useCallback(async()=>{var t;try{const p=[Oe.getCityCorporations().catch(W=>(console.error("‚ùå Error fetching city corporations:",W),{cityCorporations:[]}))];P==="SUPER_ADMIN"&&(i!=null&&i.id)&&(console.log("üë§ Fetching assigned zones for Super Admin:",i.id),p.push(as.getAssignedZones(Number(i.id)).catch(W=>(console.error("‚ùå Error fetching assigned zones:",W),[]))));const w=await Promise.all(p),Ae=w[0],de=w[1];let ie=Ae.cityCorporations||[];if(console.log("‚úÖ City Corporations fetched:",ie.length),P==="SUPER_ADMIN"){const W=i.cityCorporationCode||((t=i.cityCorporation)==null?void 0:t.code);W&&(console.log("üéØ Filtering City Corps for assigned code:",W),ie=ie.filter(fe=>fe.code===W),A!==W&&oe(W))}if(u(ie),de){console.log("üõ°Ô∏è Raw Assigned Zones:",de);const W=de.map(fe=>{const ue=fe.zone||fe;return!ue||!ue.id?null:{id:ue.id,zoneNumber:ue.zoneNumber,name:ue.name,cityCorporationId:ue.cityCorporationId||0,status:"ACTIVE"}}).filter(fe=>fe!==null);console.log("‚úÖ Formatted Assigned Zones:",W),g(W)}}catch(p){console.error("‚ùå Error in data fetching:",p),u([])}},[P,i,A]);l.useCallback(async t=>{try{const p=await ze.getWards({zoneId:t});console.log("‚úÖ Wards response:",p),p&&p.wards&&Array.isArray(p.wards)?ye(p.wards):(console.warn("‚ö†Ô∏è Invalid wards response format:",p),ye([]))}catch(p){console.error("‚ùå Error fetching wards:",p),ye([])}},[]);const G=l.useCallback(async()=>{try{o(!0),X(null);const t={page:Z,limit:20,role:"ADMIN",search:U||void 0,cityCorporationCode:A||void 0,zoneId:Y||void 0,status:ae==="ALL"?void 0:ae};console.log("üîç Admin Management Query:",t);const p=await xe.getUsers(t);console.log("‚úÖ Admin Management Response:",p),d(p.users||[]),R(p.pagination.total),he(p.pagination.totalPages)}catch(t){console.error("Error fetching admins:",t),X(t.message||"Failed to fetch admins"),d([])}finally{o(!1)}},[Z,U,A,Y,ae]),H=l.useCallback(async()=>{var t,p;try{L(!0);const w=await xe.getUserStatistics(A||void 0,"ADMIN");ke({total:w.totalCitizens||0,active:((t=w.statusBreakdown)==null?void 0:t.active)||0,inactive:((p=w.statusBreakdown)==null?void 0:p.inactive)||0,online:0,offline:0,newToday:w.newUsersThisMonth||0})}catch(w){console.error("Error fetching statistics:",w)}finally{L(!1)}},[A]);l.useEffect(()=>{we()},[we]),l.useEffect(()=>{G()},[G]),l.useEffect(()=>{H()},[H]),l.useEffect(()=>{T("")},[A]),l.useEffect(()=>{const t=setTimeout(()=>{_(1)},500);return()=>clearTimeout(t)},[U]);const r=async()=>{if(k)try{ve.success("Admin deleted successfully"),te(!1),I(null),G(),H()}catch(t){ve.error(t.message||"Failed to delete admin")}},h=async()=>{if(v.length!==0&&window.confirm(`Are you sure you want to delete ${v.length} users?`))try{await xe.bulkDeleteUsers(v),ve.success("Users deleted successfully"),B([]),G(),H()}catch(t){ve.error(t.message||"Failed to delete users")}},x=t=>{if(t.target.checked){const p=b.map(w=>w.id);B(p);return}B([])},m=t=>{const p=v.indexOf(t);let w=[];p===-1?w=w.concat(v,t):p===0?w=w.concat(v.slice(1)):p===v.length-1?w=w.concat(v.slice(0,-1)):p>0&&(w=w.concat(v.slice(0,p),v.slice(p+1))),B(w)};return P==="MASTER_ADMIN"||P==="SUPER_ADMIN"?e.jsx(Fe,{title:"‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü",children:e.jsxs(z,{spacing:3,children:[e.jsx(Ie,{sx:{borderRadius:2,boxShadow:"0px 1px 3px 0px #0000001a, 0px 1px 2px -1px #0000001a"},children:e.jsxs(We,{children:[e.jsx(s,{sx:{fontSize:24,fontWeight:700,color:"#1e2939",mb:2},children:"‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü"}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{size:{xs:12,md:2},children:e.jsx(je,{title:"‡¶Æ‡ßã‡¶ü ‡¶è‡¶°‡¶Æ‡¶ø‡¶®",value:ne.total,bg:"#eff6ff",color:"#155dfc",loading:D})}),e.jsx(a,{size:{xs:12,md:2},children:e.jsx(je,{title:"‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º",value:ne.active,bg:"#f0fdf4",color:"#00a63e",loading:D})}),e.jsx(a,{size:{xs:12,md:2},children:e.jsx(je,{title:"‡¶®‡¶ø‡¶∑‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º",value:ne.inactive,bg:"#fef2f2",color:"#e7000b",loading:D})}),e.jsx(a,{size:{xs:12,md:2},children:e.jsx(je,{title:"‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶®",value:ne.online,bg:"#faf5ff",color:"#9810fa",loading:D})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(je,{title:"‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶®",value:ne.offline,bg:"#f3f4f6",color:"#4a5565",loading:D})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(je,{title:"‡¶Ü‡¶ú ‡¶®‡¶§‡ßÅ‡¶®",value:`+${ne.newToday}`,bg:"#fff7ed",color:"#f54900",loading:D})})]})]})}),e.jsx(Ie,{sx:{borderRadius:2,boxShadow:"0px 1px 3px 0px #0000001a, 0px 1px 2px -1px #0000001a"},children:e.jsxs(We,{sx:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[e.jsxs(Xe,{sx:{minWidth:180},children:[e.jsx(Ue,{children:"‡¶∏‡¶ï‡¶≤ ‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®"}),e.jsxs(Ze,{label:"‡¶∏‡¶ï‡¶≤ ‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®",value:A,onChange:t=>oe(t.target.value),disabled:P==="SUPER_ADMIN",children:[e.jsx(S,{value:"",children:"‡¶∏‡¶ï‡¶≤ ‡¶∏‡¶ø‡¶ü‡¶ø ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®"}),Array.isArray(n)&&n.map(t=>e.jsx(S,{value:t.code,children:t.name},t.code))]})]}),e.jsx(j,{sx:{minWidth:200},children:e.jsx(ns,{value:Y,onChange:t=>T(t),cityCorporationCode:A,disabled:!A&&P==="MASTER_ADMIN",zones:P==="SUPER_ADMIN"?c:void 0,label:"‡¶∏‡¶ï‡¶≤ ‡¶ú‡ßã‡¶®"})}),e.jsxs(Xe,{sx:{minWidth:150},size:"small",children:[e.jsx(Ue,{children:"Status"}),e.jsxs(Ze,{value:ae,label:"Status",onChange:t=>{pe(t.target.value),_(1)},children:[e.jsx(S,{value:"ALL",children:"All"}),e.jsx(S,{value:Ce.ACTIVE,children:"Active"}),e.jsx(S,{value:Ce.INACTIVE,children:"Inactive"}),e.jsx(S,{value:Ce.PENDING,children:"Pending"}),e.jsx(S,{value:Ce.SUSPENDED,children:"Suspended"})]})]}),e.jsx(C,{value:U,onChange:t=>f(t.target.value),placeholder:"‡¶®‡¶æ‡¶Æ/‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®...",fullWidth:!0,InputProps:{startAdornment:e.jsx(Re,{position:"start",children:e.jsx(is,{sx:{color:"#0a0a0a80"}})})},sx:{maxWidth:500}}),e.jsx(K,{variant:"contained",sx:{bgcolor:"#3fa564"},startIcon:e.jsx(xs,{}),onClick:()=>le(!0),children:"‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®"})]})}),e.jsxs(Ie,{sx:{borderRadius:2,boxShadow:"0px 1px 3px 0px #0000001a, 0px 1px 2px -1px #0000001a"},children:[e.jsx(j,{sx:{width:"100%",p:2,display:"flex",justifyContent:"flex-end"},children:v.length>0&&e.jsxs(K,{variant:"outlined",color:"error",onClick:h,startIcon:e.jsx(Be,{}),children:["Delete Selected (",v.length,")"]})}),e.jsx(j,{sx:{bgcolor:"#f9fafb",borderBottom:"1px solid #e5e7eb",px:3,py:1.5},children:e.jsxs(a,{container:!0,alignItems:"center",children:[e.jsx(a,{item:!0,xs:1,sx:{maxWidth:"50px",flexBasis:"50px"},children:e.jsx(_e,{indeterminate:v.length>0&&v.length<b.length,checked:b.length>0&&v.length===b.length,onChange:x})}),e.jsx(a,{item:!0,xs:2.5,children:e.jsx(s,{sx:{color:"#364153",fontWeight:700,fontSize:14},children:"‡¶è‡¶°‡¶Æ‡¶ø‡¶®"})}),e.jsx(a,{item:!0,xs:3,children:e.jsx(s,{sx:{color:"#364153",fontWeight:700,fontSize:14},children:"‡¶è‡¶≤‡¶æ‡¶ï‡¶æ"})}),e.jsx(a,{item:!0,xs:2,children:e.jsx(s,{sx:{color:"#364153",fontWeight:700,fontSize:14},children:"‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏"})}),e.jsx(a,{item:!0,xs:3.5,children:e.jsx(s,{sx:{color:"#364153",fontWeight:700,fontSize:14},children:"‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶®"})})]})}),e.jsxs(We,{sx:{px:0},children:[y?e.jsx(j,{sx:{p:3},children:[1,2,3].map(t=>e.jsx(z,{spacing:1,sx:{mb:2},children:e.jsx(Ye,{variant:"rectangular",height:60})},t))}):F?e.jsx(j,{sx:{p:3},children:e.jsx(Se,{severity:"error",children:F})}):b.length===0?e.jsx(j,{sx:{p:3,textAlign:"center"},children:e.jsx(s,{color:"text.secondary",children:"‡¶ï‡ßã‡¶®‡ßã ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø"})}):e.jsx(os,{children:e.jsx(ls,{children:e.jsx(cs,{children:b.map(t=>{var w;const p=v.indexOf(t.id)!==-1;return e.jsxs(ds,{hover:!0,selected:p,children:[e.jsx(be,{padding:"checkbox",sx:{width:"50px"},children:e.jsx(_e,{checked:p,onChange:()=>m(t.id)})}),e.jsx(be,{sx:{width:"25%"},children:e.jsxs(z,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(Pe,{src:t.avatar,alt:`${t.firstName} ${t.lastName}`,sx:{bgcolor:"#2b7fff"},children:t.firstName.charAt(0)}),e.jsxs(j,{children:[e.jsxs(s,{sx:{fontSize:16,fontWeight:700},children:[t.firstName," ",t.lastName]}),e.jsx(s,{sx:{fontSize:14,color:"#4a5565"},children:t.phone})]})]})}),e.jsx(be,{sx:{width:"30%"},children:e.jsxs(z,{spacing:.5,children:[e.jsx(s,{sx:{fontSize:16,color:"#1e2939"},children:((w=t.cityCorporation)==null?void 0:w.name)||"N/A"}),e.jsxs(z,{direction:"row",spacing:.5,flexWrap:"wrap",useFlexGap:!0,sx:{mt:.5},children:[t.zone?e.jsx(Q,{label:t.zone.name,size:"small",variant:"outlined",color:"primary",sx:{height:24}}):null,t.ward?e.jsx(Q,{label:`Ward ${t.ward.wardNumber}`,size:"small",variant:"outlined",sx:{height:24}}):null,t.extraWards&&t.extraWards.length>0&&e.jsx(Q,{label:`+${t.extraWards.length} Wards`,size:"small",variant:"outlined",color:"info",sx:{height:24}}),!t.zone&&!t.ward&&(!t.extraWards||t.extraWards.length===0)&&e.jsx(s,{variant:"caption",color:"text.secondary",children:"N/A"})]}),t.address&&e.jsxs(s,{sx:{fontSize:12,color:"#6b7280",mt:.5},children:["üìç ",t.address]})]})}),e.jsx(be,{sx:{width:"15%"},children:e.jsxs(z,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Q,{label:t.status==="ACTIVE"?"‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º":"‡¶®‡¶ø‡¶∑‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º",size:"small",sx:{bgcolor:t.status==="ACTIVE"?"#dcfce7":"#fee2e2",color:t.status==="ACTIVE"?"#008236":"#dc2626"}}),e.jsx(s,{sx:{fontSize:12,color:"#6a7282"},children:"‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶®"})]})}),e.jsx(be,{sx:{width:"30%"},children:e.jsxs(z,{direction:"row",spacing:2,alignItems:"center",children:[e.jsxs(z,{children:[e.jsxs(s,{sx:{fontSize:14,color:"#1e2939",fontWeight:700},children:["‡¶Æ‡ßã‡¶ü: ",t.statistics.totalComplaints]}),e.jsxs(z,{direction:"row",spacing:2,children:[e.jsxs(s,{sx:{fontSize:12,color:"#00a63e"},children:["‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®: ",t.statistics.resolvedComplaints]}),e.jsxs(s,{sx:{fontSize:12,color:"#d08700"},children:["‡¶™‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç: ",t.statistics.pendingComplaints]})]})]}),e.jsx(ge,{orientation:"vertical",flexItem:!0}),e.jsxs(z,{direction:"row",spacing:1,children:[e.jsx(V,{size:"small",color:"primary",onClick:()=>{ve("Direct messaging coming soon!",{icon:"üí¨"})},children:e.jsx(ms,{})}),e.jsx(V,{size:"small",onClick:()=>{I(t),re(!0)},children:e.jsx(fs,{})}),e.jsx(V,{size:"small",onClick:()=>{I(t),se(!0)},children:e.jsx(us,{})}),e.jsx(V,{size:"small",color:"error",onClick:()=>{I(t),te(!0)},children:e.jsx(Be,{})})]})]})})]},t.id)})})})}),!y&&!F&&$>1&&e.jsx(j,{sx:{display:"flex",justifyContent:"center",mt:3,mb:2},children:e.jsx(gs,{count:$,page:Z,onChange:(t,p)=>_(p),color:"primary"})})]})]}),e.jsx(ys,{open:ee,onClose:()=>le(!1),onSuccess:()=>{G(),H()}}),e.jsx(ws,{open:ce,onClose:()=>{se(!1),I(null)},onSuccess:async()=>{await G(),H()},admin:k}),e.jsx(Cs,{open:M,onClose:()=>{re(!1),I(null)},admin:k}),e.jsxs(Ee,{open:q,onClose:()=>te(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(De,{children:e.jsx(s,{sx:{fontWeight:700},children:"‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡ßÅ‡¶®"})}),e.jsx(Ne,{children:e.jsxs(s,{children:["‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶Ø‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ",k==null?void 0:k.firstName," ",k==null?void 0:k.lastName," ‡¶ï‡ßá ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶§‡ßá ‡¶ö‡¶æ‡¶®?"]})}),e.jsxs(Me,{children:[e.jsx(K,{variant:"outlined",onClick:()=>te(!1),children:"‡¶¨‡¶æ‡¶§‡¶ø‡¶≤"}),e.jsx(K,{variant:"contained",color:"error",onClick:r,children:"‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡ßÅ‡¶®"})]})]})]})}):e.jsx(Fe,{title:"Admin Management",children:e.jsx(Se,{severity:"error",children:"You do not have permission to access this page."})})};export{ks as default};
