var We=Object.defineProperty;var Ce=(d,u,m)=>u in d?We(d,u,{enumerable:!0,configurable:!0,writable:!0,value:m}):d[u]=m;var ge=(d,u,m)=>Ce(d,typeof u!="symbol"?u+"":u,m);import{j as e,s as ie,t as le,w as de,B as g,A as U,g as z,x as ce,b as $,C as Q,_ as xe,av as he,$ as ue,a1 as G,ap as ee,P as re,aq as se,ar as te,as as B,at as r,au as ae,G as T,T as v,p as L,q as _,i as J,y as fe,a$ as ve,e as ne,f as oe,bn as me,ct as ye,cu as je,m as Se,a9 as Ne,M as be,Q as we,O as Ze,be as Ae}from"./mui-vendor-Brc-2iiC.js";import{r as o}from"./react-vendor-D7yrL1sD.js";import{A as pe,k as Y,w as H,d as K,m as ke,M as Ee}from"./index-DBuvollO.js";import{a as X}from"./query-vendor-CZVuOxbJ.js";import"./chart-vendor-CrjdDA16.js";const Te=({open:d,onClose:u,onSave:m,cityCorporation:s,mode:i})=>{const[a,n]=o.useState({code:"",name:"",minWard:"",maxWard:"",minZone:"",maxZone:""}),[c,Z]=o.useState({}),[b,S]=o.useState(!1),[A,I]=o.useState(null);o.useEffect(()=>{var l,h,x,p;n(i==="edit"&&s?{code:s.code,name:s.name,minWard:((l=s.minWard)==null?void 0:l.toString())||"1",maxWard:((h=s.maxWard)==null?void 0:h.toString())||"100",minZone:((x=s.minZone)==null?void 0:x.toString())||"1",maxZone:((p=s.maxZone)==null?void 0:p.toString())||"20"}:{code:"",name:"",minWard:"1",maxWard:"100",minZone:"1",maxZone:"20"}),Z({}),I(null)},[s,i,d]);const y=()=>{const l={};if(i==="create"&&(a.code.trim()?/^[A-Z]{2,10}$/.test(a.code.trim())||(l.code="Code must be 2-10 uppercase letters (e.g., DSCC, DNCC)"):l.code="Code is required"),a.name.trim()?a.name.trim().length<3&&(l.name="Name must be at least 3 characters"):l.name="Name is required",!a.minWard.trim())l.minWard="Minimum ward is required";else{const h=parseInt(a.minWard);(isNaN(h)||h<1)&&(l.minWard="Minimum ward must be a positive number")}if(!a.maxWard.trim())l.maxWard="Maximum ward is required";else{const h=parseInt(a.maxWard);(isNaN(h)||h<1)&&(l.maxWard="Maximum ward must be a positive number")}if(a.minWard&&a.maxWard){const h=parseInt(a.minWard),x=parseInt(a.maxWard);!isNaN(h)&&!isNaN(x)&&h>=x&&(l.maxWard="Maximum ward must be greater than minimum ward")}if(!a.minZone.trim())l.minZone="Minimum zone is required";else{const h=parseInt(a.minZone);(isNaN(h)||h<1)&&(l.minZone="Minimum zone must be a positive number")}if(!a.maxZone.trim())l.maxZone="Maximum zone is required";else{const h=parseInt(a.maxZone);(isNaN(h)||h<1)&&(l.maxZone="Maximum zone must be a positive number")}if(a.minZone&&a.maxZone){const h=parseInt(a.minZone),x=parseInt(a.maxZone);!isNaN(h)&&!isNaN(x)&&h>=x&&(l.maxZone="Maximum zone must be greater than minimum zone")}return Z(l),Object.keys(l).length===0},k=(l,h)=>{n(x=>({...x,[l]:h})),c[l]&&Z(x=>{const p={...x};return delete p[l],p})},P=async()=>{if(y()){S(!0),I(null);try{const l={name:a.name.trim(),minWard:parseInt(a.minWard),maxWard:parseInt(a.maxWard),minZone:parseInt(a.minZone),maxZone:parseInt(a.maxZone)};i==="create"&&(l.code=a.code.trim().toUpperCase()),await m(l),j()}catch(l){console.error("Error saving city corporation:",l),I(l.message||"Failed to save city corporation")}finally{S(!1)}}},j=()=>{b||(n({code:"",name:"",minWard:"1",maxWard:"100",minZone:"1",maxZone:"20"}),Z({}),I(null),u())};return e.jsxs(ie,{open:d,onClose:j,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[e.jsx(le,{sx:{fontWeight:600,pb:1},children:i==="create"?"Add New City Corporation":"Edit City Corporation"}),e.jsx(de,{children:e.jsxs(g,{sx:{display:"flex",flexDirection:"column",gap:2.5,pt:2},children:[A&&e.jsx(U,{severity:"error",onClose:()=>I(null),children:A}),i==="create"&&e.jsx(z,{label:"City Corporation Code",value:a.code,onChange:l=>k("code",l.target.value.toUpperCase()),error:!!c.code,helperText:c.code||"e.g., DSCC, DNCC, CTGCC",fullWidth:!0,required:!0,disabled:b,inputProps:{maxLength:10,style:{textTransform:"uppercase"}}}),e.jsx(z,{label:"City Corporation Name",value:a.name,onChange:l=>k("name",l.target.value),error:!!c.name,helperText:c.name||"e.g., Dhaka South City Corporation",fullWidth:!0,required:!0,disabled:b}),e.jsxs(g,{children:[e.jsx(g,{sx:{fontWeight:600,color:"text.secondary",mb:1.5},children:"Ward Range"}),e.jsxs(g,{sx:{display:"flex",gap:2},children:[e.jsx(z,{label:"Minimum Ward *",type:"number",value:a.minWard,onChange:l=>k("minWard",l.target.value),error:!!c.minWard,helperText:c.minWard||"Starting ward number",fullWidth:!0,required:!0,disabled:b,inputProps:{min:1}}),e.jsx(z,{label:"Maximum Ward *",type:"number",value:a.maxWard,onChange:l=>k("maxWard",l.target.value),error:!!c.maxWard,helperText:c.maxWard||(s!=null&&s.actualMaxWard&&s.actualMaxWard>parseInt(a.maxWard||"0")?`âš ï¸ Ward ${s.actualMaxWard} exists! Set at least ${s.actualMaxWard}`:s!=null&&s.actualMaxWard?`Current highest: Ward ${s.actualMaxWard}`:"Use 9999 for unlimited"),fullWidth:!0,required:!0,disabled:b,inputProps:{min:1,max:9999}})]})]}),e.jsxs(g,{children:[e.jsx(g,{sx:{fontWeight:600,color:"text.secondary",mb:1.5},children:"Zone Range"}),e.jsxs(g,{sx:{display:"flex",gap:2},children:[e.jsx(z,{label:"Minimum Zone *",type:"number",value:a.minZone,onChange:l=>k("minZone",l.target.value),error:!!c.minZone,helperText:c.minZone||"Starting zone number",fullWidth:!0,required:!0,disabled:b,inputProps:{min:1}}),e.jsx(z,{label:"Maximum Zone *",type:"number",value:a.maxZone,onChange:l=>k("maxZone",l.target.value),error:!!c.maxZone,helperText:c.maxZone||(s!=null&&s.actualMaxZone&&s.actualMaxZone>parseInt(a.maxZone||"0")?`âš ï¸ Zone ${s.actualMaxZone} exists! Set at least ${s.actualMaxZone}`:s!=null&&s.actualMaxZone?`Current highest: Zone ${s.actualMaxZone}`:"Use 9999 for unlimited"),fullWidth:!0,required:!0,disabled:b,inputProps:{min:1,max:9999}})]})]})]})}),e.jsxs(ce,{sx:{px:3,pb:2.5},children:[e.jsx($,{onClick:j,disabled:b,sx:{textTransform:"none"},children:"Cancel"}),e.jsx($,{onClick:P,variant:"contained",disabled:b,sx:{textTransform:"none",minWidth:100,backgroundColor:"#4CAF50","&:hover":{backgroundColor:"#45a049"}},children:b?e.jsx(Q,{size:24}):i==="create"?"Create":"Save Changes"})]})]})};class Ie{constructor(){ge(this,"apiClient");this.apiClient=X.create({baseURL:pe.BASE_URL,timeout:pe.TIMEOUT,withCredentials:!0,headers:{"Content-Type":"application/json"}}),this.setupInterceptors()}setupInterceptors(){this.apiClient.interceptors.request.use(u=>{try{const m=localStorage.getItem("accessToken");m&&(u.headers.Authorization=`Bearer ${m}`)}catch(m){console.error("Error getting token:",m)}return u},u=>Promise.reject(u)),this.apiClient.interceptors.response.use(u=>u,u=>{var m;return((m=u.response)==null?void 0:m.status)===401&&window.location.pathname!=="/login"&&window.location.assign("/login"),Promise.reject(u)})}async getThanasByCityCorporation(u,m){var s,i;try{const a={cityCorporationCode:u};return m&&m!=="ALL"&&(a.status=m),(await this.apiClient.get("/api/admin/thanas",{params:a})).data.data}catch(a){throw X.isAxiosError(a)?new Error(((i=(s=a.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to fetch thanas"):a}}async createThana(u){var m,s;try{return(await this.apiClient.post("/api/admin/thanas",u)).data.data}catch(i){throw X.isAxiosError(i)?new Error(((s=(m=i.response)==null?void 0:m.data)==null?void 0:s.message)||"Failed to create thana"):i}}async updateThana(u,m){var s,i;try{return(await this.apiClient.put(`/api/admin/thanas/${u}`,m)).data.data}catch(a){throw X.isAxiosError(a)?new Error(((i=(s=a.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to update thana"):a}}async getThanaStats(u){var m,s;try{return(await this.apiClient.get(`/api/admin/thanas/${u}/statistics`)).data.data}catch(i){throw X.isAxiosError(i)?new Error(((s=(m=i.response)==null?void 0:m.data)==null?void 0:s.message)||"Failed to fetch thana statistics"):i}}}new Ie;const Fe=({open:d,onClose:u,onSave:m,zone:s,cityCorporationId:i,cityCorporationName:a,mode:n})=>{const[c,Z]=o.useState(1),[b,S]=o.useState(""),[A,I]=o.useState(""),[y,k]=o.useState(""),[P,j]=o.useState(""),[l,h]=o.useState(""),[x,p]=o.useState(!1),[W,N]=o.useState(null),[O,R]=o.useState([]),[t,f]=o.useState(!1);o.useEffect(()=>{(async()=>{if(d&&n==="create"&&i){f(!0);try{console.log("ðŸ” Fetching available zones for CC:",i);const w=await Y.getAvailableZoneNumbers(i);console.log("âœ… Available zone numbers:",w),R(w),w.length>0&&Z(w[0])}catch(w){console.error("âŒ Error fetching available zones:",w),N("Failed to load available zones")}finally{f(!1)}}})()},[d,n,i]),o.useEffect(()=>{n==="edit"&&s?(Z(s.zoneNumber),S(s.name||""),I(s.officerName||""),k(s.officerDesignation||""),j(s.officerSerialNumber||""),h(s.officerPhone||"")):(S(""),I(""),k(""),j(""),h("")),N(null)},[n,s,d]);const M=async()=>{var E,w;try{p(!0),N(null);const D=n==="create"?{zoneNumber:c,name:b.trim()||void 0,cityCorporationId:i,officerName:A.trim()||void 0,officerDesignation:y.trim()||void 0,officerSerialNumber:P.trim()||void 0,officerPhone:l.trim()||void 0}:{name:b.trim()||void 0,officerName:A.trim()||void 0,officerDesignation:y.trim()||void 0,officerSerialNumber:P.trim()||void 0,officerPhone:l.trim()||void 0};await m(D),V()}catch(D){console.error("Error saving zone:",D),N(((w=(E=D.response)==null?void 0:E.data)==null?void 0:w.message)||D.message||"Failed to save zone")}finally{p(!1)}},V=()=>{x||(N(null),u())};return e.jsxs(ie,{open:d,onClose:V,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[e.jsx(le,{sx:{fontWeight:600,pb:1},children:n==="create"?"Add New Zone":"Edit Zone"}),e.jsxs(de,{sx:{pt:2},children:[W&&e.jsx(U,{severity:"error",sx:{mb:2},onClose:()=>N(null),children:W}),e.jsxs(g,{sx:{display:"flex",flexDirection:"column",gap:2.5},children:[e.jsx(z,{fullWidth:!0,label:"City Corporation",value:a,disabled:!0,variant:"outlined"}),e.jsxs(xe,{fullWidth:!0,children:[e.jsx(he,{children:"Zone Number *"}),e.jsx(ue,{value:c,onChange:E=>Z(Number(E.target.value)),label:"Zone Number *",disabled:n==="edit"||x||t,children:n==="edit"?e.jsxs(G,{value:c,children:["Zone ",c]}):t?e.jsxs(G,{disabled:!0,children:[e.jsx(Q,{size:20,sx:{mr:1}}),"Loading available zones..."]}):O.length===0?e.jsx(G,{disabled:!0,children:"No available zones (all zones are in use)"}):O.map(E=>e.jsxs(G,{value:E,children:["Zone ",E]},E))}),n==="create"&&!t&&e.jsx(g,{sx:{mt:.5,fontSize:"0.75rem",color:"text.secondary"},children:O.length===0?"All zones are already in use for this city corporation":`${O.length} zone(s) available`})]}),e.jsx(z,{fullWidth:!0,label:"Zone Name (Optional)",value:b,onChange:E=>S(E.target.value),placeholder:`Zone ${c}`,disabled:x,variant:"outlined",helperText:"Leave empty to use default name (e.g., Zone 1)"}),e.jsxs(g,{sx:{mt:1},children:[e.jsx(g,{sx:{borderTop:"1px solid #e0e0e0",pt:2,mb:2},children:e.jsx(g,{sx:{fontWeight:600,color:"text.secondary",mb:2},children:"Zone Officer Information (Optional)"})}),e.jsx(z,{fullWidth:!0,label:"Officer Name",value:A,onChange:E=>I(E.target.value),disabled:x,variant:"outlined",sx:{mb:2.5}}),e.jsx(z,{fullWidth:!0,label:"Officer Designation",value:y,onChange:E=>k(E.target.value),disabled:x,variant:"outlined",sx:{mb:2.5}}),e.jsx(z,{fullWidth:!0,label:"Officer Serial Number",value:P,onChange:E=>j(E.target.value),disabled:x,variant:"outlined",sx:{mb:2.5}}),e.jsx(z,{fullWidth:!0,label:"Officer Phone Number",value:l,onChange:E=>h(E.target.value),disabled:x,variant:"outlined"})]})]})]}),e.jsxs(ce,{sx:{px:3,pb:2.5},children:[e.jsx($,{onClick:V,disabled:x,sx:{textTransform:"none",px:3},children:"Cancel"}),e.jsx($,{onClick:M,variant:"contained",disabled:x||n==="create"&&O.length===0,sx:{textTransform:"none",px:3,backgroundColor:"#4CAF50","&:hover":{backgroundColor:"#45a049"}},children:x?e.jsx(Q,{size:24,sx:{color:"white"}}):n==="create"?"Create Zone":"Update Zone"})]})]})},Me=({zones:d,loading:u,onEdit:m,onDelete:s,onSelectZone:i,selectedZoneId:a})=>u?e.jsx(ee,{component:re,elevation:0,children:e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs(B,{sx:{backgroundColor:"#f8f9fa"},children:[e.jsx(r,{sx:{fontWeight:600},children:"Zone Number"}),e.jsx(r,{sx:{fontWeight:600},children:"Zone Name"}),e.jsx(r,{sx:{fontWeight:600},children:"Officer Name"}),e.jsx(r,{sx:{fontWeight:600},children:"Officer Designation"}),e.jsx(r,{sx:{fontWeight:600},children:"Officer Phone"}),e.jsx(r,{sx:{fontWeight:600},children:"Total Wards"}),e.jsx(r,{sx:{fontWeight:600},children:"Total Users"}),e.jsx(r,{sx:{fontWeight:600},children:"Status"}),e.jsx(r,{sx:{fontWeight:600},children:"Actions"})]})}),e.jsx(ae,{children:Array.from({length:3}).map((n,c)=>e.jsxs(B,{children:[e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})})]},c))})]})}):d.length===0?e.jsx(g,{sx:{textAlign:"center",py:4},children:e.jsx(v,{variant:"body1",color:"text.secondary",children:'No zones added yet. Click "Add Zone" to create the first zone.'})}):e.jsx(ee,{component:re,elevation:0,children:e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs(B,{sx:{backgroundColor:"#f8f9fa"},children:[e.jsx(r,{sx:{fontWeight:600},children:"Zone Number"}),e.jsx(r,{sx:{fontWeight:600},children:"Zone Name"}),e.jsx(r,{sx:{fontWeight:600},children:"Officer Name"}),e.jsx(r,{sx:{fontWeight:600},children:"Officer Designation"}),e.jsx(r,{sx:{fontWeight:600},children:"Officer Phone"}),e.jsx(r,{sx:{fontWeight:600},children:"Total Wards"}),e.jsx(r,{sx:{fontWeight:600},children:"Total Users"}),e.jsx(r,{sx:{fontWeight:600},children:"Status"}),e.jsx(r,{sx:{fontWeight:600},children:"Actions"})]})}),e.jsx(ae,{children:d.map(n=>{var c,Z;return e.jsxs(B,{onClick:()=>i(n),sx:{cursor:"pointer",backgroundColor:a===n.id?"#e3f2fd":"transparent","&:hover":{backgroundColor:a===n.id?"#e3f2fd":"#f8f9fa"}},children:[e.jsx(r,{children:e.jsxs(v,{variant:"body1",sx:{fontWeight:600},children:["Zone ",n.zoneNumber]})}),e.jsx(r,{children:e.jsx(v,{variant:"body1",children:n.name||`Zone ${n.zoneNumber}`})}),e.jsx(r,{children:e.jsx(v,{variant:"body2",color:"text.secondary",children:n.officerName||"-"})}),e.jsx(r,{children:e.jsx(v,{variant:"body2",color:"text.secondary",children:n.officerDesignation||"-"})}),e.jsx(r,{children:e.jsx(v,{variant:"body2",color:"text.secondary",children:n.officerPhone||"-"})}),e.jsx(r,{children:e.jsx(L,{label:((c=n._count)==null?void 0:c.wards)||n.totalWards||0,size:"small",sx:{backgroundColor:"#f3e5f5",color:"#7b1fa2",fontWeight:500}})}),e.jsx(r,{children:e.jsx(L,{label:((Z=n._count)==null?void 0:Z.users)||n.totalUsers||0,size:"small",sx:{backgroundColor:"#e3f2fd",color:"#1976d2",fontWeight:500}})}),e.jsx(r,{children:e.jsx(L,{label:n.status,size:"small",sx:{backgroundColor:n.status==="ACTIVE"?"#e8f5e8":"#ffebee",color:n.status==="ACTIVE"?"#2e7d2e":"#c62828",fontWeight:500}})}),e.jsx(r,{children:e.jsxs(g,{sx:{display:"flex",gap:1},children:[e.jsx(_,{title:"Edit Zone",children:e.jsx(J,{size:"small",onClick:b=>{b.stopPropagation(),m(n)},sx:{color:"#1976d2","&:hover":{backgroundColor:"#e3f2fd"}},children:e.jsx(fe,{fontSize:"small"})})}),e.jsx(_,{title:"Delete Zone",children:e.jsx(J,{size:"small",onClick:b=>{b.stopPropagation(),s(n)},sx:{color:"#c62828","&:hover":{backgroundColor:"#ffebee"}},children:e.jsx(ve,{fontSize:"small"})})})]})})]},n.id)})})]})}),Pe=({cityCorporationId:d,cityCorporationName:u,cityCorporationCode:m,onZoneSelect:s})=>{var M,V,E;const[i,a]=o.useState([]),[n,c]=o.useState(!1),[Z,b]=o.useState(null),[S,A]=o.useState(null),[I,y]=o.useState(!1),[k,P]=o.useState("create"),[j,l]=o.useState(null),[h,x]=o.useState(!1);o.useEffect(()=>{console.log("ðŸ”„ ZoneManagement: cityCorporationId changed:",d),d&&p()},[d]);const p=async()=>{var w,D,C;try{console.log("ðŸ“¡ Fetching zones for city corporation:",d),c(!0),b(null);const F=await Y.getZonesByCityCorporation(d,"ALL");console.log("âœ… Zones fetched:",F.length,"zones"),console.log("   First zone:",F[0]),a(F)}catch(F){console.error("âŒ Error fetching zones:",F),console.error("   Error details:",(w=F.response)==null?void 0:w.data),b(((C=(D=F.response)==null?void 0:D.data)==null?void 0:C.message)||F.message||"Failed to load zones")}finally{c(!1)}},W=()=>{A(null),P("create"),y(!0)},N=w=>{A(w),P("edit"),y(!0)},O=async w=>{try{k==="create"?await Y.createZone(w):S&&await Y.updateZone(S.id,w),await p(),y(!1)}catch(D){throw console.error("Error saving zone:",D),D}},R=w=>{l(w),x(!0)},t=async()=>{var w,D;if(j)try{await Y.deleteZone(j.id),await p(),x(!1),l(null),(S==null?void 0:S.id)===j.id&&(A(null),s==null||s(null))}catch(C){console.error("Error deleting zone:",C),b(((D=(w=C.response)==null?void 0:w.data)==null?void 0:D.message)||C.message||"Failed to delete zone"),x(!1)}},f=w=>{A(w),s==null||s(w)};return e.jsxs(ne,{sx:{borderRadius:2,border:"2px solid #4CAF50",mt:3,boxShadow:"0 4px 12px rgba(76, 175, 80, 0.15)"},children:[e.jsxs(oe,{sx:{p:3,backgroundColor:"#f1f8f4"},children:[e.jsxs(g,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(g,{children:[e.jsxs(v,{variant:"h5",sx:{fontWeight:700,mb:.5,color:"#2e7d32"},children:["ðŸ¢ Zone Management - ",u]}),e.jsxs(v,{variant:"body1",color:"text.secondary",sx:{fontWeight:500},children:["Manage zones for ",m]})]}),e.jsx($,{variant:"contained",startIcon:e.jsx(me,{}),onClick:W,sx:{backgroundColor:"#4CAF50","&:hover":{backgroundColor:"#45a049"},textTransform:"none",px:3,py:1.5,fontSize:"1rem",fontWeight:600},children:"Add Zone"})]}),Z&&e.jsx(U,{severity:"error",sx:{mb:3},onClose:()=>b(null),children:Z}),e.jsx(Me,{zones:i,loading:n,onEdit:N,onDelete:R,onSelectZone:f,selectedZoneId:S==null?void 0:S.id})]}),e.jsx(Fe,{open:I,onClose:()=>{y(!1),A(null)},onSave:O,zone:k==="edit"?S:null,cityCorporationId:d,cityCorporationName:u,mode:k}),e.jsxs(ie,{open:h,onClose:()=>x(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(le,{children:"Delete Zone"}),e.jsxs(de,{children:[e.jsxs(v,{children:["Are you sure you want to delete Zone ",j==null?void 0:j.zoneNumber,"?"]}),j&&(((M=j._count)==null?void 0:M.wards)||0)>0&&e.jsxs(U,{severity:"warning",sx:{mt:2},children:["This zone has ",(V=j._count)==null?void 0:V.wards," ward(s). You must remove all wards before deleting the zone."]})]}),e.jsxs(ce,{children:[e.jsx($,{onClick:()=>x(!1),sx:{textTransform:"none"},children:"Cancel"}),e.jsx($,{onClick:t,color:"error",variant:"contained",sx:{textTransform:"none"},disabled:!!(j&&(((E=j._count)==null?void 0:E.wards)||0)>0),children:"Delete"})]})]})]})},ze=({wards:d,loading:u,onEdit:m,onDelete:s})=>u?e.jsx(ee,{component:re,elevation:0,children:e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs(B,{sx:{backgroundColor:"#f8f9fa"},children:[e.jsx(r,{sx:{fontWeight:600},children:"Ward Number"}),e.jsx(r,{sx:{fontWeight:600},children:"Inspector Name"}),e.jsx(r,{sx:{fontWeight:600},children:"Inspector Serial"}),e.jsx(r,{sx:{fontWeight:600},children:"Inspector Phone"}),e.jsx(r,{sx:{fontWeight:600},children:"Total Users"}),e.jsx(r,{sx:{fontWeight:600},children:"Status"}),e.jsx(r,{sx:{fontWeight:600},children:"Actions"})]})}),e.jsx(ae,{children:Array.from({length:3}).map((i,a)=>e.jsxs(B,{children:[e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})})]},a))})]})}):!d||!Array.isArray(d)?(console.error("Invalid wards data:",d),e.jsx(g,{sx:{textAlign:"center",py:4},children:e.jsx(v,{variant:"body1",color:"text.secondary",children:"Error loading wards. Please try again."})})):d.length===0?e.jsx(g,{sx:{textAlign:"center",py:4},children:e.jsx(v,{variant:"body1",color:"text.secondary",children:'No wards added yet. Click "Add Wards" to create wards for this zone.'})}):e.jsxs(e.Fragment,{children:[e.jsx(g,{sx:{mb:2,p:2,backgroundColor:"#f8f9fa",borderRadius:1},children:e.jsxs(v,{variant:"body2",color:"text.secondary",children:["ðŸ’¡ ",e.jsx("strong",{children:"Tip:"}),' Click the Edit button to assign inspector name and serial number to wards. Wards without assigned inspectors will show "Not Assigned".']})}),e.jsx(ee,{component:re,elevation:0,children:e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs(B,{sx:{backgroundColor:"#f8f9fa"},children:[e.jsx(r,{sx:{fontWeight:600},children:"Ward Number"}),e.jsx(r,{sx:{fontWeight:600},children:"Inspector Name"}),e.jsx(r,{sx:{fontWeight:600},children:"Inspector Serial"}),e.jsx(r,{sx:{fontWeight:600},children:"Inspector Phone"}),e.jsx(r,{sx:{fontWeight:600},children:"Total Users"}),e.jsx(r,{sx:{fontWeight:600},children:"Status"}),e.jsx(r,{sx:{fontWeight:600},children:"Actions"})]})}),e.jsx(ae,{children:d.map(i=>{var a;return e.jsxs(B,{sx:{"&:hover":{backgroundColor:"#f8f9fa"}},children:[e.jsx(r,{children:e.jsxs(v,{variant:"body1",sx:{fontWeight:600},children:["Ward ",i.wardNumber]})}),e.jsx(r,{children:i.inspectorName?e.jsx(v,{variant:"body2",color:"text.secondary",children:i.inspectorName}):e.jsx(_,{title:"Click Edit to assign inspector",children:e.jsx(L,{label:"Not Assigned",size:"small",sx:{backgroundColor:"#fff3e0",color:"#e65100",fontWeight:500,cursor:"pointer"}})})}),e.jsx(r,{children:i.inspectorSerialNumber?e.jsx(v,{variant:"body2",color:"text.secondary",children:i.inspectorSerialNumber}):e.jsx(_,{title:"Click Edit to assign serial number",children:e.jsx(L,{label:"Not Assigned",size:"small",sx:{backgroundColor:"#fff3e0",color:"#e65100",fontWeight:500,cursor:"pointer"}})})}),e.jsx(r,{children:i.inspectorPhone?e.jsx(v,{variant:"body2",color:"text.secondary",children:i.inspectorPhone}):e.jsx(_,{title:"Click Edit to assign phone number",children:e.jsx(L,{label:"No Phone",size:"small",sx:{backgroundColor:"#fff3e0",color:"#e65100",fontWeight:500,cursor:"pointer"}})})}),e.jsx(r,{children:e.jsx(L,{label:((a=i._count)==null?void 0:a.users)||i.totalUsers||0,size:"small",sx:{backgroundColor:"#e3f2fd",color:"#1976d2",fontWeight:500}})}),e.jsx(r,{children:e.jsx(L,{label:i.status,size:"small",sx:{backgroundColor:i.status==="ACTIVE"?"#e8f5e8":"#ffebee",color:i.status==="ACTIVE"?"#2e7d2e":"#c62828",fontWeight:500}})}),e.jsxs(r,{children:[e.jsx(_,{title:"Edit Ward",children:e.jsx(J,{size:"small",onClick:()=>m(i),sx:{color:"#1976d2","&:hover":{backgroundColor:"#e3f2fd"},mr:1},children:e.jsx(fe,{fontSize:"small"})})}),e.jsx(_,{title:"Delete Ward",children:e.jsx(J,{size:"small",onClick:()=>s(i.id),sx:{color:"#d32f2f","&:hover":{backgroundColor:"#ffebee"}},children:e.jsx(ve,{fontSize:"small"})})})]})]},i.id)})})]})})]}),De=({open:d,onClose:u,onSave:m,ward:s})=>{const[i,a]=o.useState(""),[n,c]=o.useState(""),[Z,b]=o.useState([]),[S,A]=o.useState(""),[I,y]=o.useState(""),[k,P]=o.useState(""),[j,l]=o.useState(!1),[h,x]=o.useState(!1),[p,W]=o.useState(null);o.useEffect(()=>{var t,f,M;s&&(a(((t=s.wardNumber)==null?void 0:t.toString())||""),c(s.zoneId||""),A(s.inspectorName||""),y(s.inspectorSerialNumber||""),P(s.inspectorPhone||""),(M=(f=s.zone)==null?void 0:f.cityCorporation)!=null&&M.id&&N(s.zone.cityCorporation.id)),W(null)},[s,d]);const N=async t=>{try{x(!0);const f=await Y.getZonesByCityCorporation(t,"ACTIVE");b(f)}catch(f){console.error("Error fetching zones:",f)}finally{x(!1)}},O=async()=>{var t,f;try{l(!0),W(null);const M={wardNumber:parseInt(i),zoneId:n?Number(n):void 0,inspectorName:S.trim()||void 0,inspectorSerialNumber:I.trim()||void 0,inspectorPhone:k.trim()||void 0};await m(M),R()}catch(M){console.error("Error saving ward:",M),W(((f=(t=M.response)==null?void 0:t.data)==null?void 0:f.message)||M.message||"Failed to save ward")}finally{l(!1)}},R=()=>{j||(W(null),u())};return e.jsxs(ie,{open:d,onClose:R,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[e.jsxs(le,{sx:{fontWeight:600,pb:1},children:["Edit Ward ",s.wardNumber]}),e.jsxs(de,{sx:{pt:2},children:[p&&e.jsx(U,{severity:"error",sx:{mb:2},onClose:()=>W(null),children:p}),e.jsxs(g,{sx:{display:"flex",flexDirection:"column",gap:2.5},children:[e.jsx(z,{fullWidth:!0,label:"Ward Number",value:i,onChange:t=>a(t.target.value),disabled:j,variant:"outlined",type:"number",helperText:"Ensure this Ward Number is unique within the City Corporation"}),e.jsxs(xe,{fullWidth:!0,variant:"outlined",children:[e.jsx(he,{id:"zone-select-label",children:"Zone"}),e.jsx(ue,{labelId:"zone-select-label",value:n,onChange:t=>c(t.target.value),label:"Zone",disabled:j||h,children:Z.map(t=>e.jsx(G,{value:t.id,children:`Zone ${t.zoneNumber}${t.name?` - ${t.name}`:""}`},t.id))})]}),e.jsxs(g,{sx:{mt:1},children:[e.jsx(g,{sx:{borderTop:"1px solid #e0e0e0",pt:2,mb:2},children:e.jsx(g,{sx:{fontWeight:600,color:"text.secondary",mb:2},children:"Ward Inspector Information"})}),e.jsx(z,{fullWidth:!0,label:"Inspector Name",value:S,onChange:t=>A(t.target.value),disabled:j,variant:"outlined",sx:{mb:2.5},helperText:"Enter the name of the cleanliness inspector for this ward"}),e.jsx(z,{fullWidth:!0,label:"Inspector Serial Number",value:I,onChange:t=>y(t.target.value),disabled:j,variant:"outlined",sx:{mb:2.5},helperText:"Enter the serial number of the inspector"}),e.jsx(z,{fullWidth:!0,label:"Inspector Phone Number",value:k,onChange:t=>P(t.target.value),disabled:j,variant:"outlined",helperText:"Enter the contact number of the inspector"})]})]})]}),e.jsxs(ce,{sx:{px:3,pb:2.5},children:[e.jsx($,{onClick:R,disabled:j,sx:{textTransform:"none",px:3},children:"Cancel"}),e.jsx($,{onClick:O,variant:"contained",disabled:j,sx:{textTransform:"none",px:3,backgroundColor:"#4CAF50","&:hover":{backgroundColor:"#45a049"}},children:j?e.jsx(Q,{size:24,sx:{color:"white"}}):"Update Ward"})]})]})},Oe=({open:d,onClose:u,onSave:m,zoneId:s,zoneName:i})=>{const[a,n]=o.useState("single"),[c,Z]=o.useState([]),[b,S]=o.useState(""),[A,I]=o.useState([]),[y,k]=o.useState(!1),[P,j]=o.useState(!1),[l,h]=o.useState(null),[x,p]=o.useState(""),[W,N]=o.useState(""),[O,R]=o.useState("");o.useEffect(()=>{d&&s&&t()},[d,s]),o.useEffect(()=>{d&&(n("single"),Z([]),S(""),p(""),N(""),R(""),h(null))},[d]);const t=async()=>{var C,F;try{j(!0),h(null);const q=await H.getAvailableWardNumbers(s);I(q)}catch(q){console.error("Error fetching available ward numbers:",q),h(((F=(C=q.response)==null?void 0:C.data)==null?void 0:F.message)||q.message||"Failed to load available wards")}finally{j(!1)}},f=(C,F)=>{F!==null&&(n(F),Z([]),S(""),h(null))},M=C=>{const F=C.target.value;Z(typeof F=="string"?F.split(",").map(Number):F)},V=async()=>{var C,F;try{if(k(!0),h(null),a==="single"){if(!b){h("Please select a ward number");return}const q={inspectorName:x.trim()||void 0,inspectorSerialNumber:W.trim()||void 0,inspectorPhone:O.trim()||void 0};await m([b],q)}else{if(c.length===0){h("Please select at least one ward");return}if(c.length>50){h("Maximum 50 wards can be added at once");return}await m(c)}E()}catch(q){console.error("Error saving wards:",q),h(((F=(C=q.response)==null?void 0:C.data)==null?void 0:F.message)||q.message||"Failed to save wards")}finally{k(!1)}},E=()=>{y||(Z([]),S(""),p(""),N(""),R(""),h(null),u())},w=a==="bulk"&&c.length>50,D=a==="single"?b!=="":c.length>0&&!w;return e.jsxs(ie,{open:d,onClose:E,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[e.jsxs(le,{sx:{fontWeight:600,pb:1},children:["Add Wards to ",i]}),e.jsxs(de,{sx:{pt:2},children:[l&&e.jsx(U,{severity:"error",sx:{mb:2},onClose:()=>h(null),children:l}),P?e.jsx(g,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(Q,{})}):A.length===0?e.jsx(U,{severity:"info",children:"No available ward numbers. All wards have been added to this zone."}):e.jsxs(g,{sx:{display:"flex",flexDirection:"column",gap:2.5},children:[e.jsx(g,{sx:{display:"flex",justifyContent:"center",mb:1},children:e.jsxs(ye,{value:a,exclusive:!0,onChange:f,"aria-label":"add mode",sx:{backgroundColor:"#f5f5f5"},children:[e.jsx(je,{value:"single",sx:{px:3,"&.Mui-selected":{backgroundColor:"#4CAF50",color:"white","&:hover":{backgroundColor:"#45a049"}}},children:"Single Ward (with Inspector)"}),e.jsx(je,{value:"bulk",sx:{px:3,"&.Mui-selected":{backgroundColor:"#2196F3",color:"white","&:hover":{backgroundColor:"#1976d2"}}},children:"Multiple Wards (Bulk)"})]})}),a==="single"?e.jsxs(e.Fragment,{children:[e.jsxs(xe,{fullWidth:!0,children:[e.jsx(he,{children:"Ward Number *"}),e.jsx(ue,{value:b,onChange:C=>S(C.target.value),label:"Ward Number *",disabled:y,children:A.map(C=>e.jsxs(G,{value:C,children:["Ward ",C]},C))})]}),e.jsxs(g,{sx:{mt:1},children:[e.jsx(g,{sx:{borderTop:"1px solid #e0e0e0",pt:2,mb:2},children:e.jsx(v,{sx:{fontWeight:600,color:"text.secondary",mb:2},children:"Ward Inspector Information (Optional)"})}),e.jsx(z,{fullWidth:!0,label:"Inspector Name",value:x,onChange:C=>p(C.target.value),disabled:y,variant:"outlined",sx:{mb:2.5},helperText:"Enter the name of the cleanliness inspector for this ward"}),e.jsx(z,{fullWidth:!0,label:"Inspector Serial Number",value:W,onChange:C=>N(C.target.value),disabled:y,variant:"outlined",sx:{mb:2.5},helperText:"Enter the serial number of the inspector"}),e.jsx(z,{fullWidth:!0,label:"Inspector Phone Number",value:O,onChange:C=>R(C.target.value),disabled:y,variant:"outlined",helperText:"Enter the contact number of the inspector"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(xe,{fullWidth:!0,children:[e.jsx(he,{children:"Select Wards"}),e.jsx(ue,{multiple:!0,value:c,onChange:M,label:"Select Wards",disabled:y,renderValue:C=>e.jsx(g,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:C.map(F=>e.jsx(L,{label:`Ward ${F}`,size:"small",sx:{backgroundColor:"#e3f2fd",color:"#1976d2"}},F))}),children:A.map(C=>e.jsxs(G,{value:C,children:[e.jsx(Se,{checked:c.includes(C)}),e.jsx(Ne,{primary:`Ward ${C}`})]},C))})]}),e.jsxs(g,{sx:{p:2,backgroundColor:"#f8f9fa",borderRadius:1,border:"1px solid #e0e0e0"},children:[e.jsx(v,{variant:"body2",sx:{fontWeight:600,mb:1},children:"Selection Summary"}),e.jsxs(v,{variant:"body2",color:"text.secondary",children:["Selected: ",c.length," ward(s)"]}),e.jsxs(v,{variant:"body2",color:"text.secondary",children:["Available: ",A.length," ward(s)"]}),e.jsx(v,{variant:"body2",color:"text.secondary",children:"No limit on wards per zone"})]}),w&&e.jsxs(U,{severity:"warning",children:["Maximum 50 wards can be added at once. Please deselect"," ",c.length-50," ward(s)."]}),c.length>0&&!w&&e.jsxs(U,{severity:"info",children:[c.length," ward(s) will be created. You can add inspector information later by editing each ward."]})]})]})]}),e.jsxs(ce,{sx:{px:3,pb:2.5},children:[e.jsx($,{onClick:E,disabled:y,sx:{textTransform:"none",px:3},children:"Cancel"}),e.jsx($,{onClick:V,variant:"contained",disabled:y||P||!D||A.length===0,sx:{textTransform:"none",px:3,backgroundColor:a==="single"?"#4CAF50":"#2196F3","&:hover":{backgroundColor:a==="single"?"#45a049":"#1976d2"}},children:y?e.jsx(Q,{size:24,sx:{color:"white"}}):a==="single"?"Add Ward":`Add ${c.length} Ward${c.length!==1?"s":""}`})]})]})},Le=({zone:d})=>{const[u,m]=o.useState([]),[s,i]=o.useState(!1),[a,n]=o.useState(null),[c,Z]=o.useState(null),[b,S]=o.useState(!1),[A,I]=o.useState(!1);o.useEffect(()=>{d?y():m([])},[d]);const y=async()=>{var x,p;if(d)try{i(!0),n(null);const W=await H.getWardsByZone(d.id,"ALL");let N=[];Array.isArray(W)?N=W:W&&typeof W=="object"&&(Array.isArray(W.wards)?N=W.wards:Array.isArray(W.data)&&(N=W.data)),m(N)}catch(W){console.error("Error fetching wards:",W),n(((p=(x=W.response)==null?void 0:x.data)==null?void 0:p.message)||W.message||"Failed to load wards"),m([])}finally{i(!1)}},k=()=>{I(!0)},P=x=>{Z(x),S(!0)},j=async(x,p)=>{if(d)try{x.length===1&&p?await H.createWard({wardNumber:x[0],zoneId:d.id,inspectorName:p.inspectorName,inspectorSerialNumber:p.inspectorSerialNumber,inspectorPhone:p.inspectorPhone}):await H.createWardsBulk(d.id,x),await y(),I(!1)}catch(W){throw console.error("Error creating wards:",W),W}},l=async x=>{if(c)try{await H.updateWard(c.id,x),await y(),S(!1),Z(null)}catch(p){throw console.error("Error updating ward:",p),p}},h=async x=>{var p,W;if(window.confirm("Are you sure you want to delete this ward?"))try{await H.deleteWard(x),await y()}catch(N){console.error("Error deleting ward:",N),n(((W=(p=N.response)==null?void 0:p.data)==null?void 0:W.message)||N.message||"Failed to delete ward")}};return d?e.jsxs(ne,{sx:{borderRadius:2,border:"2px solid #2196F3",mt:3,boxShadow:"0 4px 12px rgba(33, 150, 243, 0.15)"},children:[e.jsxs(oe,{sx:{p:3,backgroundColor:"#e3f2fd"},children:[e.jsxs(g,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(g,{children:[e.jsxs(v,{variant:"h5",sx:{fontWeight:700,mb:.5,color:"#1565c0"},children:["ðŸ“ Ward Management - ",d.name||`Zone ${d.zoneNumber}`]}),e.jsxs(v,{variant:"body1",color:"text.secondary",sx:{fontWeight:500},children:["Manage wards for Zone ",d.zoneNumber]})]}),e.jsx($,{variant:"contained",startIcon:e.jsx(me,{}),onClick:k,sx:{backgroundColor:"#2196F3","&:hover":{backgroundColor:"#1976d2"},textTransform:"none",px:3,py:1.5,fontSize:"1rem",fontWeight:600},children:"Add Wards"})]}),a&&e.jsx(U,{severity:"error",sx:{mb:3},onClose:()=>n(null),children:a}),e.jsx(ze,{wards:u,loading:s,onEdit:P,onDelete:h})]}),e.jsx(Oe,{open:A,onClose:()=>I(!1),onSave:j,zoneId:d.id,zoneName:d.name||`Zone ${d.zoneNumber}`}),c&&e.jsx(De,{open:b,onClose:()=>{S(!1),Z(null)},onSave:l,ward:c})]}):e.jsx(ne,{sx:{borderRadius:2,border:"1px solid #e0e0e0",mt:3},children:e.jsx(oe,{sx:{p:3},children:e.jsx(g,{sx:{textAlign:"center",py:4},children:e.jsx(v,{variant:"body1",color:"text.secondary",children:"Select a zone to manage its wards"})})})})},_e=()=>{const[d,u]=o.useState([]),[m,s]=o.useState(!0),[i,a]=o.useState(null),[n,c]=o.useState(null),[Z,b]=o.useState(null),[S,A]=o.useState(!1),[I,y]=o.useState("create"),[k,P]=o.useState({open:!1,message:"",severity:"success"});o.useEffect(()=>{j()},[]);const j=async()=>{var t;try{s(!0),a(null);const f=await K.getCityCorporations("ALL");console.log("ðŸ¢ City Corporations Response:",f),console.log("ðŸ“Š First City Corp Data:",(t=f.cityCorporations)==null?void 0:t[0]),u(f.cityCorporations||[])}catch(f){console.error("Error fetching city corporations:",f),a(f.message||"Failed to load city corporations"),N("Failed to load city corporations","error"),u([])}finally{s(!1)}},l=()=>{c(null),y("create"),A(!0)},h=t=>{c(t),y("edit"),A(!0)},x=async t=>{try{if(I==="create"?(await K.createCityCorporation(t),N("City corporation created successfully","success")):n&&(console.log("ðŸ”„ Updating city corporation:",n.code,t),await K.updateCityCorporation(n.code,t),N("City corporation updated successfully","success")),console.log("ðŸ“¡ Fetching updated city corporations..."),s(!0),await j(),n){const M=(await K.getCityCorporations("ALL")).cityCorporations.find(V=>V.code===n.code);M&&(console.log("âœ… Updated selected city corporation:",M),c(M))}s(!1),console.log("âœ… City corporations refreshed")}catch(f){throw console.error("Error saving city corporation:",f),s(!1),f}},p=async t=>{try{const f=t.status==="ACTIVE"?"INACTIVE":"ACTIVE";await K.updateCityCorporation(t.code,{status:f}),N(`City corporation ${f==="ACTIVE"?"activated":"deactivated"} successfully`,"success"),await j(),(n==null?void 0:n.code)===t.code&&c(M=>M?{...M,status:f}:null)}catch(f){console.error("Error toggling city corporation status:",f),N("Failed to update city corporation status","error")}},W=t=>{console.log("ðŸ¢ Selected City Corporation:",t),c(t),b(null)},N=(t,f)=>{P({open:!0,message:t,severity:f})},O=()=>{P(t=>({...t,open:!1}))},R=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return e.jsx(ke,{children:e.jsxs(Ee,{title:"City Corporation Management",children:[e.jsxs(g,{sx:{width:"100%",maxWidth:"100%",px:1.5,mx:0},children:[e.jsxs(g,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:3},children:[e.jsxs(g,{children:[e.jsx(v,{variant:"h4",sx:{fontWeight:600,mb:.5,color:"text.primary"},children:"City Corporation Management"}),e.jsx(v,{variant:"body1",color:"text.secondary",children:"Manage city corporations and their thanas/areas"})]}),e.jsx($,{variant:"contained",startIcon:e.jsx(me,{}),onClick:l,sx:{backgroundColor:"#4CAF50","&:hover":{backgroundColor:"#45a049"},textTransform:"none",px:3,py:1.5,borderRadius:2},children:"Add City Corporation"})]}),i&&e.jsx(U,{severity:"error",sx:{mb:3},onClose:()=>a(null),children:i}),e.jsx(ne,{sx:{borderRadius:2,border:"1px solid #e0e0e0",mb:3},children:e.jsxs(oe,{sx:{p:3},children:[e.jsx(v,{variant:"h6",sx:{fontWeight:600,mb:3},children:"City Corporations"}),e.jsx(ee,{component:re,elevation:0,children:e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs(B,{sx:{backgroundColor:"#f8f9fa"},children:[e.jsx(r,{sx:{fontWeight:600},children:"Code"}),e.jsx(r,{sx:{fontWeight:600},children:"Name"}),e.jsx(r,{sx:{fontWeight:600},children:"Zone Range"}),e.jsx(r,{sx:{fontWeight:600},children:"Ward Range"}),e.jsx(r,{sx:{fontWeight:600},children:"Status"}),e.jsx(r,{sx:{fontWeight:600},children:"Total Users"}),e.jsx(r,{sx:{fontWeight:600},children:"Total Complaints"}),e.jsx(r,{sx:{fontWeight:600},children:"Total Zones"}),e.jsx(r,{sx:{fontWeight:600},children:"Total Wards"}),e.jsx(r,{sx:{fontWeight:600},children:"Created"}),e.jsx(r,{sx:{fontWeight:600},children:"Actions"})]})}),e.jsx(ae,{children:m?Array.from({length:3}).map((t,f)=>e.jsxs(B,{children:[e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})}),e.jsx(r,{children:e.jsx(T,{variant:"rectangular",height:30})})]},f)):d.length===0?e.jsx(B,{children:e.jsx(r,{colSpan:11,children:e.jsxs(g,{sx:{textAlign:"center",py:4},children:[e.jsx(be,{sx:{fontSize:48,color:"#9e9e9e",mb:2}}),e.jsx(v,{variant:"body1",color:"text.secondary",sx:{mb:2},children:"No city corporations added yet"}),e.jsx($,{variant:"outlined",startIcon:e.jsx(me,{}),onClick:l,sx:{textTransform:"none"},children:"Add First City Corporation"})]})})}):d.map(t=>e.jsxs(B,{onClick:()=>W(t),sx:{cursor:"pointer",backgroundColor:(n==null?void 0:n.id)===t.id?"#e3f2fd":"transparent","&:hover":{backgroundColor:(n==null?void 0:n.id)===t.id?"#e3f2fd":"#f8f9fa"}},children:[e.jsx(r,{children:e.jsx(v,{variant:"body1",sx:{fontWeight:600},children:t.code})}),e.jsx(r,{children:e.jsx(v,{variant:"body1",sx:{fontWeight:500},children:t.name})}),e.jsx(r,{children:e.jsxs(v,{variant:"body2",color:"text.secondary",children:[t.minZone," - ",t.maxZone]})}),e.jsx(r,{children:e.jsxs(v,{variant:"body2",color:"text.secondary",children:[t.minWard," - ",t.maxWard]})}),e.jsx(r,{children:e.jsx(L,{label:t.status,size:"small",sx:{backgroundColor:t.status==="ACTIVE"?"#e8f5e8":"#ffebee",color:t.status==="ACTIVE"?"#2e7d2e":"#c62828",fontWeight:500}})}),e.jsx(r,{children:e.jsx(L,{label:t.totalUsers||0,size:"small",sx:{backgroundColor:"#e3f2fd",color:"#1976d2",fontWeight:500}})}),e.jsx(r,{children:e.jsx(L,{label:t.totalComplaints||0,size:"small",sx:{backgroundColor:"#fff3e0",color:"#e65100",fontWeight:500}})}),e.jsx(r,{children:e.jsx(L,{label:t.totalZones||0,size:"small",sx:{backgroundColor:"#f3e5f5",color:"#7b1fa2",fontWeight:500}})}),e.jsx(r,{children:e.jsx(L,{label:t.totalWards||0,size:"small",sx:{backgroundColor:"#e1f5fe",color:"#0277bd",fontWeight:500}})}),e.jsx(r,{children:e.jsx(v,{variant:"body2",color:"text.secondary",children:R(t.createdAt)})}),e.jsx(r,{children:e.jsxs(g,{sx:{display:"flex",gap:1},children:[e.jsx(_,{title:"Edit",children:e.jsx(J,{size:"small",onClick:f=>{f.stopPropagation(),h(t)},sx:{color:"#1976d2","&:hover":{backgroundColor:"#e3f2fd"}},children:e.jsx(fe,{fontSize:"small"})})}),e.jsx(_,{title:t.status==="ACTIVE"?"Deactivate":"Activate",children:e.jsx(J,{size:"small",onClick:f=>{f.stopPropagation(),p(t)},sx:{color:t.status==="ACTIVE"?"#c62828":"#2e7d2e","&:hover":{backgroundColor:t.status==="ACTIVE"?"#ffebee":"#e8f5e8"}},children:t.status==="ACTIVE"?e.jsx(we,{fontSize:"small"}):e.jsx(Ze,{fontSize:"small"})})})]})})]},t.id))})]})})]})}),n?e.jsx(g,{sx:{mt:3},children:e.jsx(Pe,{cityCorporationId:n.id,cityCorporationName:n.name,cityCorporationCode:n.code,onZoneSelect:b})}):e.jsx(ne,{sx:{borderRadius:2,border:"2px dashed #9e9e9e",mt:3,backgroundColor:"#fafafa"},children:e.jsxs(oe,{sx:{p:4,textAlign:"center"},children:[e.jsx(be,{sx:{fontSize:64,color:"#9e9e9e",mb:2}}),e.jsx(v,{variant:"h6",sx:{fontWeight:600,mb:1,color:"#616161"},children:"Select a City Corporation"}),e.jsx(v,{variant:"body1",color:"text.secondary",children:"Click on any City Corporation from the table above to manage its zones and wards"})]})}),Z&&e.jsx(g,{sx:{mt:3},children:e.jsx(Le,{zone:Z})}),!1]}),e.jsx(Te,{open:S,onClose:()=>{A(!1),c(null)},onSave:x,cityCorporation:I==="edit"?n:void 0,mode:I}),e.jsx(Ae,{open:k.open,autoHideDuration:6e3,onClose:O,anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(U,{onClose:O,severity:k.severity,sx:{width:"100%"},children:k.message})})]})})};export{_e as default};
