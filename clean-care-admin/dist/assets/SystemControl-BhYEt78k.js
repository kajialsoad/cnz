var I=Object.defineProperty;var L=(i,e,a)=>e in i?I(i,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[e]=a;var f=(i,e,a)=>L(i,typeof e!="symbol"?e+"":e,a);import{e as N,j as t,R as P,S as C,$ as k,r as c,a5 as y,F as u,K as v,P as b,T as d,as as _,at as E,N as j,aN as p}from"./index-CxAfVJz0.js";import{A as T}from"./ArrowBack-DNQRjIIE.js";const R=N(t.jsx("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm2 16H5V5h11.17L19 7.83zm-7-7c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3M6 6h9v4H6z"}));class W{constructor(){f(this,"apiClient");this.apiClient=P.create({baseURL:C.BASE_URL,timeout:C.TIMEOUT,withCredentials:!0,headers:{"Content-Type":"application/json"}}),this.setupInterceptors()}setupInterceptors(){this.apiClient.interceptors.request.use(e=>{try{const a=localStorage.getItem("accessToken");a&&(e.headers.Authorization=`Bearer ${a}`)}catch(a){console.error("Error getting token:",a)}return e},e=>Promise.reject(e)),this.apiClient.interceptors.response.use(e=>e,e=>{var a;return((a=e.response)==null?void 0:a.status)===401&&window.location.pathname!=="/login"&&window.location.assign("/login"),Promise.reject(e)})}async getAllConfigs(){return(await this.apiClient.get("/api/admin/config")).data}async getConfig(e){return(await this.apiClient.get(`/api/admin/config/${e}`)).data}async updateConfig(e,a,r){return(await this.apiClient.put(`/api/admin/config/${e}`,{value:a,description:r})).data}}const m=new W,z=()=>{const i=k(),[e,a]=c.useState(!0),[r,g]=c.useState(!1),[n,h]=c.useState("20"),[o,x]=c.useState("10");c.useEffect(()=>{w()},[]);const w=async()=>{try{a(!0);const s=await m.getConfig("daily_complaint_limit");s.success&&s.data&&h(s.data.value);const l=await m.getConfig("ward_image_limit");l.success&&l.data&&x(l.data.value)}catch(s){console.error("Error fetching config:",s)}finally{a(!1)}},S=async()=>{let s=!1;if((!n||isNaN(Number(n))||Number(n)<1)&&(p.error("Daily Limit: Please enter a valid positive number"),s=!0),(!o||isNaN(Number(o))||Number(o)<1)&&(p.error("Image Limit: Please enter a valid positive number"),s=!0),!s)try{g(!0),await m.updateConfig("daily_complaint_limit",n,"Maximum number of complaints allowed per user per day"),await m.updateConfig("ward_image_limit",o,"Maximum number of images allowed per complaint for a ward"),p.success("Configurations updated successfully")}catch(l){console.error("Error updating config:",l),p.error("Failed to update configurations")}finally{g(!1)}};return e?t.jsx(y,{title:"System Control",children:t.jsx(u,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:t.jsx(v,{})})}):t.jsx(y,{title:"System Control",children:t.jsxs(u,{sx:{px:3,py:4,background:"#f8faf9",minHeight:"100vh"},children:[t.jsxs(u,{sx:{mb:3},children:[t.jsx(b,{startIcon:t.jsx(T,{}),onClick:()=>i("/settings"),sx:{mb:2,color:"#4a5565"},children:"Back to Settings"}),t.jsx(d,{variant:"h4",sx:{fontWeight:700,color:"#1e2939"},children:"সিস্টেম কন্ট্রোল (System Control)"}),t.jsx(d,{variant:"body1",sx:{color:"#4a5565",mt:1},children:"সিস্টেমের গুরুত্বপূর্ণ সেটিংস কনফিগার করুন"})]}),t.jsx(_,{sx:{maxWidth:600,borderRadius:"12px",boxShadow:"0px 1px 3px rgba(0,0,0,0.1)"},children:t.jsxs(E,{sx:{p:4},children:[t.jsx(d,{variant:"h6",sx:{mb:3,fontWeight:600},children:"অভিযোগের সীমা (Complaint Limits)"}),t.jsxs(u,{sx:{mb:4},children:[t.jsx(d,{variant:"subtitle2",sx:{mb:1,color:"#4a5565"},children:"দৈনিক অভিযোগের সীমা (Daily Complaint Limit)"}),t.jsx(j,{fullWidth:!0,type:"number",value:n,onChange:s=>h(s.target.value),helperText:"একজন ব্যবহারকারী প্রতিদিন কতগুলো অভিযোগ করতে পারবেন",InputProps:{inputProps:{min:1}}})]}),t.jsxs(u,{sx:{mb:4},children:[t.jsx(d,{variant:"subtitle2",sx:{mb:1,color:"#4a5565"},children:"ওয়ার্ডের ছবির সীমা (Ward Image Limit)"}),t.jsx(j,{fullWidth:!0,type:"number",value:o,onChange:s=>x(s.target.value),helperText:"প্রতি অভিযোগের জন্য ওয়ার্ডে সর্বোচ্চ কতগুলো ছবি আপলোড করা যাবে",InputProps:{inputProps:{min:1}}})]}),t.jsx(b,{variant:"contained",startIcon:r?t.jsx(v,{size:20,color:"inherit"}):t.jsx(R,{}),onClick:S,disabled:r,sx:{background:"#3fa564","&:hover":{background:"#2e804b"},py:1.5,px:4},children:r?"Saving...":"Save Changes"})]})})]})})};export{z as default};
