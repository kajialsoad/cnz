import{r as p,j as e,c as A,b as S,d as N,bY as T,a as w,s as M,u as $,e as G,l as L,$ as z,bZ as U,a4 as D,a7 as F,F as g,T as f,ai as B,P as E,K as O,b_ as Z,aA as K,aC as Q,b$ as Y,G as _,c0 as q,aD as H,aB as J,aj as V,I as X,Z as ee,c1 as b,Q as y}from"./index-wC2ewM-h.js";import{f as ae}from"./dateUtils-DNCsyTl-.js";import{s as se}from"./styled-CkwR9FDq.js";import{u as te}from"./useThemeProps-DydbukuF.js";import{S as P}from"./Stack-BmCjVX_G.js";import{D as re}from"./DoneAll-C7dRsJhE.js";import{P as oe}from"./Pagination-CNZQsadl.js";const ie=T(),ne=se("div",{name:"MuiContainer",slot:"Root",overridesResolver:(o,t)=>{const{ownerState:i}=o;return[t.root,t[`maxWidth${S(String(i.maxWidth))}`],i.fixed&&t.fixed,i.disableGutters&&t.disableGutters]}}),ce=o=>te({props:o,name:"MuiContainer",defaultTheme:ie}),le=(o,t)=>{const i=l=>w(t,l),{classes:x,fixed:m,disableGutters:u,maxWidth:s}=o,r={root:["root",s&&`maxWidth${S(String(s))}`,m&&"fixed",u&&"disableGutters"]};return N(r,i,x)};function de(o={}){const{createStyledComponent:t=ne,useThemeProps:i=ce,componentName:x="MuiContainer"}=o,m=t(({theme:s,ownerState:r})=>({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",...!r.disableGutters&&{paddingLeft:s.spacing(2),paddingRight:s.spacing(2),[s.breakpoints.up("sm")]:{paddingLeft:s.spacing(3),paddingRight:s.spacing(3)}}}),({theme:s,ownerState:r})=>r.fixed&&Object.keys(s.breakpoints.values).reduce((l,h)=>{const n=h,d=s.breakpoints.values[n];return d!==0&&(l[s.breakpoints.up(n)]={maxWidth:`${d}${s.breakpoints.unit}`}),l},{}),({theme:s,ownerState:r})=>({...r.maxWidth==="xs"&&{[s.breakpoints.up("xs")]:{maxWidth:Math.max(s.breakpoints.values.xs,444)}},...r.maxWidth&&r.maxWidth!=="xs"&&{[s.breakpoints.up(r.maxWidth)]:{maxWidth:`${s.breakpoints.values[r.maxWidth]}${s.breakpoints.unit}`}}}));return p.forwardRef(function(r,l){const h=i(r),{className:n,component:d="div",disableGutters:j=!1,fixed:C=!1,maxWidth:k="lg",classes:I,...v}=h,a={...h,component:d,disableGutters:j,fixed:C,maxWidth:k},c=le(a,x);return e.jsx(m,{as:d,ownerState:a,className:A(c.root,n),ref:l,...v})})}const pe=de({createStyledComponent:M("div",{name:"MuiContainer",slot:"Root",overridesResolver:(o,t)=>{const{ownerState:i}=o;return[t.root,t[`maxWidth${S(String(i.maxWidth))}`],i.fixed&&t.fixed,i.disableGutters&&t.disableGutters]}}),useThemeProps:o=>$({props:o,name:"MuiContainer"})}),xe=G(e.jsx("circle",{cx:"12",cy:"12",r:"8"})),je=()=>{L();const o=z(),{refreshUnreadCount:t}=U(),[i,x]=p.useState(!0),[m,u]=p.useState([]),[s,r]=p.useState(1),[l,h]=p.useState(1),[n,d]=p.useState(!1),j=async()=>{try{x(!0);const a=await b.getUserNotifications(s,20,n);u(a.notifications),h(a.pagination.totalPages)}catch(a){console.error("Error fetching notifications:",a),y.error("Failed to load notifications")}finally{x(!1)}};p.useEffect(()=>{j()},[s,n]);const C=(a,c)=>{r(c)},k=async(a,c)=>{c.stopPropagation();try{await b.markAsRead(a),u(W=>W.map(R=>R.id===a?{...R,isRead:!0}:R)),t()}catch{y.error("Failed to mark as read")}},I=async()=>{try{await b.markAllAsRead(),u(a=>a.map(c=>({...c,isRead:!0}))),t(),y.success("All notifications marked as read")}catch{y.error("Failed to mark all as read")}},v=async a=>{if(!a.isRead)try{await b.markAsRead(a.id),t()}catch(c){console.error("Failed to mark as read on click",c)}a.complaintId&&o(`/complaints/${a.complaintId}`)};return e.jsx(D,{title:"Notifications",children:e.jsx(pe,{maxWidth:"lg",sx:{py:4},children:e.jsxs(F,{elevation:0,sx:{p:3,border:"1px solid #e0e0e0",borderRadius:2},children:[e.jsxs(P,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:3,children:[e.jsxs(g,{children:[e.jsx(f,{variant:"h5",fontWeight:600,gutterBottom:!0,children:"Notifications"}),e.jsx(f,{variant:"body2",color:"text.secondary",children:"Stay updated with recent activities and status changes"})]}),e.jsxs(P,{direction:"row",spacing:2,children:[e.jsx(B,{label:n?"Showing Unread":"Showing All",onClick:()=>d(!n),color:n?"primary":"default",variant:n?"filled":"outlined",sx:{cursor:"pointer"}}),e.jsx(E,{variant:"outlined",startIcon:e.jsx(re,{}),onClick:I,size:"small",children:"Mark all read"})]})]}),i?e.jsx(g,{display:"flex",justifyContent:"center",py:8,children:e.jsx(O,{})}):m.length===0?e.jsxs(g,{display:"flex",flexDirection:"column",alignItems:"center",py:8,children:[e.jsx(Z,{sx:{fontSize:60,color:"text.disabled",mb:2}}),e.jsx(f,{color:"text.secondary",children:"No notifications found"})]}):e.jsx(K,{children:m.map(a=>e.jsxs(Q,{alignItems:"flex-start",sx:{mb:1,borderRadius:2,bgcolor:a.isRead?"transparent":"action.hover",cursor:"pointer","&:hover":{bgcolor:"action.selected"},border:"1px solid",borderColor:"divider"},secondaryAction:!a.isRead&&e.jsx(V,{title:"Mark as read",children:e.jsx(X,{edge:"end",onClick:c=>k(a.id,c),size:"small",children:e.jsx(ee,{color:"primary",fontSize:"small"})})}),onClick:()=>v(a),children:[e.jsx(Y,{children:e.jsx(_,{sx:{bgcolor:a.isRead?"grey.300":"primary.main"},children:e.jsx(q,{})})}),e.jsx(H,{primary:e.jsxs(g,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(f,{variant:"subtitle1",fontWeight:a.isRead?400:600,children:a.title}),!a.isRead&&e.jsx(xe,{sx:{fontSize:10,color:"primary.main"}})]}),secondary:e.jsxs(J.Fragment,{children:[e.jsx(f,{component:"span",variant:"body2",color:"text.primary",display:"block",sx:{my:.5},children:a.message}),e.jsx(f,{variant:"caption",color:"text.secondary",children:ae(a.createdAt)})]})})]},a.id))}),l>1&&e.jsx(g,{display:"flex",justifyContent:"center",mt:3,children:e.jsx(oe,{count:l,page:s,onChange:C,color:"primary"})})]})})})};export{je as default};
