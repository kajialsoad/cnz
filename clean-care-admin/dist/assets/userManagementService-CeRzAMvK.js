var m=Object.defineProperty;var f=(c,e,s)=>e in c?m(c,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):c[e]=s;var w=(c,e,s)=>f(c,typeof e!="symbol"?e+"":e,s);import{R as i,S as g}from"./index-DeUEnMZz.js";class y{constructor(){w(this,"apiClient");this.apiClient=i.create({baseURL:g.BASE_URL,timeout:g.TIMEOUT,withCredentials:!0,headers:{"Content-Type":"application/json"}}),this.setupInterceptors()}setupInterceptors(){this.apiClient.interceptors.request.use(e=>{try{const s=localStorage.getItem("accessToken");s&&(e.headers.Authorization=`Bearer ${s}`)}catch(s){console.error("Error getting token:",s)}return e},e=>Promise.reject(e)),this.apiClient.interceptors.response.use(e=>e,e=>{var s;return((s=e.response)==null?void 0:s.status)===401&&window.location.pathname!=="/login"&&window.location.assign("/login"),Promise.reject(e)})}async getUsers(e){var s,t,r,o,p,n,d,u,l,h;try{console.log("ðŸ” Fetching users with query:",e);const a=await this.apiClient.get("/api/admin/users",{params:e});if(console.log("âœ… Full response:",a),console.log("âœ… Response data:",a.data),console.log("âœ… Response data type:",typeof a.data),console.log("âœ… Response data keys:",Object.keys(a.data||{})),(s=a.data)!=null&&s.success&&((t=a.data)!=null&&t.data))return console.log("âœ… Using response.data.data structure"),a.data.data;if((r=a.data)!=null&&r.users&&((o=a.data)!=null&&o.pagination))return console.log("âœ… Using direct structure"),a.data;throw console.error("âŒ Unexpected response structure:",a.data),new Error("Unexpected response structure from server")}catch(a){throw console.error("âŒ Error fetching users:",a),i.isAxiosError(a)?(console.error("Response data:",(p=a.response)==null?void 0:p.data),console.error("Response status:",(n=a.response)==null?void 0:n.status),console.error("Request URL:",(d=a.config)==null?void 0:d.url),console.error("Request params:",(u=a.config)==null?void 0:u.params),new Error(((h=(l=a.response)==null?void 0:l.data)==null?void 0:h.message)||"Failed to fetch users")):a}}async getUserById(e){var s,t;try{return(await this.apiClient.get(`/api/admin/users/${e}`)).data.data}catch(r){throw i.isAxiosError(r)?new Error(((t=(s=r.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to fetch user details"):r}}async getUserStatistics(e,s,t,r){var o,p;try{const n={};return e&&(n.cityCorporationCode=e),s&&(n.role=s),t&&(n.zoneId=t),r&&(n.wardId=r),(await this.apiClient.get("/api/admin/users/statistics",{params:Object.keys(n).length>0?n:void 0})).data.data}catch(n){throw i.isAxiosError(n)?new Error(((p=(o=n.response)==null?void 0:o.data)==null?void 0:p.message)||"Failed to fetch statistics"):n}}async createUser(e){var s,t;try{return(await this.apiClient.post("/api/admin/users",e)).data}catch(r){throw i.isAxiosError(r)?new Error(((t=(s=r.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to create user"):r}}async updateUser(e,s){var t,r;try{return(await this.apiClient.put(`/api/admin/users/${e}`,s)).data}catch(o){throw i.isAxiosError(o)?new Error(((r=(t=o.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to update user"):o}}async updateUserStatus(e,s){var t,r;try{return(await this.apiClient.patch(`/api/admin/users/${e}/status`,s)).data}catch(o){throw i.isAxiosError(o)?new Error(((r=(t=o.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to update user status"):o}}async bulkDeleteUsers(e){var s,t;try{await this.apiClient.post("/api/admin/users/bulk-delete",{userIds:e})}catch(r){throw i.isAxiosError(r)?new Error(((t=(s=r.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to bulk delete users"):r}}}const C=new y;export{C as u};
