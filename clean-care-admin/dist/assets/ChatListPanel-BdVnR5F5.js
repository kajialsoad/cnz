import{j as t,B as i,H as N,T as l,p as x,u as E,o as k,g as W,I as $,Z as T,b as g,bu as A,bv as R}from"./mui-vendor-Brc-2iiC.js";import{r as F,a as O}from"./react-vendor-D7yrL1sD.js";import{u as D}from"./useDebounce-CcxK0pTh.js";import{f as L}from"./dateUtils-Ct3ZkYaO.js";import{f as M,a as f}from"./index-DBuvollO.js";import{a as B}from"./browserNotifications-CE-oeFv1.js";import{a as S}from"./ErrorDisplay-MT5puO9e.js";const G=({chat:e,isSelected:m,onClick:u})=>{var n;const b=()=>`${e.citizen.firstName.charAt(0)}${e.citizen.lastName.charAt(0)}`,d=(r,c=50)=>r.length<=c?r:`${r.substring(0,c)}...`,s=()=>{switch(e.complaintStatus){case"PENDING":return"#FF9800";case"IN_PROGRESS":return"#2196F3";case"RESOLVED":return"#4CAF50";case"REJECTED":return"#f44336";default:return"#9E9E9E"}},o=()=>{switch(e.complaintStatus){case"PENDING":return"Pending";case"IN_PROGRESS":return"In Progress";case"RESOLVED":return"Solved";case"REJECTED":return"Rejected";default:return e.complaintStatus}};return t.jsx(i,{"data-chat-id":e.complaintId,onClick:u,sx:{p:{xs:1.5,sm:2,md:2},borderBottom:"1px solid",borderColor:"divider",cursor:"pointer",backgroundColor:m?"action.selected":"transparent",transition:`all ${f.fast.duration} ${f.fast.timing}`,animation:`${M} ${f.normal.duration} ${f.normal.timing}`,"&:hover":{backgroundColor:m?"action.selected":"action.hover",transform:"translateX(4px)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)"}},children:t.jsxs(i,{sx:{display:"flex",gap:1.5},children:[t.jsx(N,{src:e.citizen.profilePicture,sx:{width:40,height:40,bgcolor:"#4CAF50",color:"white",fontWeight:600,fontSize:"0.875rem",flexShrink:0},children:b()}),t.jsxs(i,{sx:{flex:1,minWidth:0},children:[t.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:.5,gap:1},children:[t.jsxs(l,{variant:"subtitle2",sx:{fontWeight:e.unreadCount>0?600:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1},children:[e.citizen.firstName," ",e.citizen.lastName]}),t.jsx(l,{variant:"caption",color:"text.secondary",sx:{flexShrink:0,fontSize:"0.7rem"},children:e.lastMessage?L(e.lastMessage.timestamp.toString()):"No messages"})]}),t.jsxs(l,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:.5,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:["#",e.trackingNumber||`C${String(e.complaintId).padStart(6,"0")}`," â€¢ ",e.complaintTitle]}),t.jsxs(l,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:.5,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.7rem"},children:["ðŸ“ ",e.citizen.cityCorporationName||((n=e.citizen.cityCorporation)==null?void 0:n.name)||e.citizen.district||"N/A"]}),t.jsxs(i,{sx:{display:"flex",gap:.5,mb:.5,flexWrap:"wrap"},children:[e.citizen.zone&&t.jsx(x,{label:typeof e.citizen.zone=="object"?`Zone ${e.citizen.zone.zoneNumber}`:typeof e.citizen.zone=="string"&&e.citizen.zone.startsWith("Zone")?e.citizen.zone:`Zone ${e.citizen.zone}`,size:"small",variant:"outlined",sx:{height:20,fontSize:"0.7rem",color:"text.secondary",borderColor:"divider",backgroundColor:"action.hover"}}),e.citizen.ward&&t.jsx(x,{label:typeof e.citizen.ward=="object"?`Ward ${e.citizen.ward.wardNumber}`:typeof e.citizen.ward=="string"&&e.citizen.ward.startsWith("Ward")?e.citizen.ward:`Ward ${e.citizen.ward}`,size:"small",variant:"outlined",sx:{height:20,fontSize:"0.7rem",color:"text.secondary",borderColor:"divider",backgroundColor:"action.hover"}})]}),t.jsx(l,{variant:"body2",color:"text.secondary",sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:e.unreadCount>0?500:400,fontSize:"0.875rem",mb:.5},children:e.lastMessage?d(e.lastMessage.text,50):"No messages yet"}),t.jsxs(i,{sx:{display:"flex",gap:.5,flexWrap:"wrap",alignItems:"center"},children:[t.jsx(x,{label:o(),size:"small",sx:{height:20,fontSize:"0.7rem",fontWeight:500,backgroundColor:s(),color:"white"}}),e.isNew&&t.jsx(x,{label:"New",size:"small",sx:{height:20,fontSize:"0.7rem",fontWeight:600,backgroundColor:"#FF5722",color:"white"}}),e.unreadCount>0&&t.jsx(x,{label:e.unreadCount,size:"small",sx:{height:20,minWidth:20,backgroundColor:"#4CAF50",color:"white",fontSize:"0.7rem",fontWeight:600}})]})]})]})})},Q=({chats:e,selectedChatId:m,onChatSelect:u,searchTerm:b,onSearchChange:d,loading:s,currentPage:o=1,totalPages:n=1,onPageChange:r,totalChats:c=0})=>{const j=E(),w=k(j.breakpoints.down("sm")),[p,h]=F.useState(b),z=D(p,500);O.useEffect(()=>{d(z)},[z,d]);const v=a=>{h(a.target.value)},C=()=>{h(""),d("")},y=()=>{r&&o>1&&r(o-1)},I=()=>{r&&o<n&&r(o+1)};return t.jsxs(i,{sx:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[t.jsxs(i,{sx:{p:{xs:1.5,sm:2,md:2},borderBottom:"1px solid",borderColor:"divider"},children:[t.jsx(l,{variant:"h6",sx:{fontWeight:600,mb:1.5,fontSize:{xs:"1.1rem",sm:"1.25rem",md:"1.25rem"}},children:"Inbox"}),t.jsx(W,{fullWidth:!0,placeholder:w?"Search...":"Search conversations...",value:p,onChange:v,size:"small",slotProps:{input:{startAdornment:t.jsx($,{position:"start",children:t.jsx(T,{sx:{color:"text.secondary",fontSize:20}})})}},sx:{"& .MuiOutlinedInput-root":{backgroundColor:"background.default"}}})]}),t.jsxs(i,{sx:{flex:1,overflowY:"auto",overflowX:"hidden"},children:[s&&e.length===0&&t.jsx(B,{count:5}),!s&&e.length===0&&p!==""&&t.jsx(S,{type:"no-results",onAction:C,actionLabel:"Clear Search"}),!s&&e.length===0&&p===""&&t.jsx(S,{type:"no-chats"}),e.length>0&&t.jsx(i,{children:e.map(a=>t.jsx(G,{chat:a,isSelected:m===a.complaintId,onClick:()=>u(a.complaintId)},a.complaintId||`citizen-${a.citizen.id}`))})]}),n>1&&t.jsxs(i,{sx:{p:2,borderTop:"1px solid",borderColor:"divider",display:"flex",justifyContent:"space-between",alignItems:"center",gap:2},children:[t.jsx(g,{variant:"outlined",size:"small",startIcon:t.jsx(A,{}),onClick:y,disabled:o===1||s,sx:{minWidth:100},children:"Previous"}),t.jsxs(l,{variant:"body2",color:"text.secondary",children:["Page ",o," of ",n,c>0&&` (${c} total)`]}),t.jsx(g,{variant:"outlined",size:"small",endIcon:t.jsx(R,{}),onClick:I,disabled:o===n||s,sx:{minWidth:100},children:"Next"})]})]})};export{Q as C};
